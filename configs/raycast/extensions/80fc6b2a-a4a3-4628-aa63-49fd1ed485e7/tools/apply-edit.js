"use strict";var f=Object.defineProperty;var m=Object.getOwnPropertyDescriptor;var P=Object.getOwnPropertyNames;var b=Object.prototype.hasOwnProperty;var E=(t,e)=>{for(var o in e)f(t,o,{get:e[o],enumerable:!0})},v=(t,e,o,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of P(e))!b.call(t,r)&&r!==o&&f(t,r,{get:()=>e[r],enumerable:!(i=m(e,r))||i.enumerable});return t};var R=t=>v(f({},"__esModule",{value:!0}),t);var A={};E(A,{confirmation:()=>$,default:()=>k});module.exports=R(A);var u=require("node:fs/promises");var p=require("@raycast/api"),s=require("node:path"),y=()=>{let t=(0,p.getPreferenceValues)();if(!t.workspaceRoot)throw new Error("Workspace root directory is not configured. Please set it in the extension preferences.");return(0,s.resolve)(t.workspaceRoot)},g=()=>(0,p.getPreferenceValues)().autoEdit===!0,d=t=>{if(!t)throw new Error("Path is required");let e=y(),o=(0,s.resolve)(e,t),i=(0,s.resolve)(e),r=(0,s.resolve)(o),n=(0,s.relative)(i,r);if(n.startsWith("..")||n==="..")throw new Error(`Path "${t}" is outside the configured workspace root "${e}". All file operations must be within the workspace root directory.`);return r};async function $({path:t,oldText:e,newText:o,replaceAll:i=!1}){if(g())return;let r=d(t),n=await(0,u.readFile)(r,"utf8");if(!n.includes(e))throw new Error(`Could not find the specified text in the file: "${e.substring(0,50)}..."`);let c=n.split(e).length-1,a=i?c:1,w=(l,h=100)=>l.length<=h?l:l.substring(0,h)+"...";return{message:`Are you sure you want to replace text in ${t}?`,info:[{name:"File Path",value:t},{name:"Replace Mode",value:i?`Replace All (${c} occurrences)`:"Replace First Only"},{name:"Will Replace",value:`${a} occurrence${a>1?"s":""}`},{name:"Old Text",value:w(e)},{name:"New Text",value:w(o)}]}}async function k({path:t,oldText:e,newText:o,replaceAll:i=!1}){if(!e)throw new Error("oldText is required");let r=d(t),n=await(0,u.readFile)(r,"utf8");if(!n.includes(e))throw new Error(`Could not find the specified text in the file: "${e.substring(0,50)}..."`);let c;if(i)c=n.split(e).join(o);else{let a=n.indexOf(e);c=n.substring(0,a)+o+n.substring(a+e.length)}return await(0,u.writeFile)(r,c,"utf8"),{success:!0,message:`Successfully applied edit to ${t}`,replacedOccurrences:i?n.split(e).length-1:1}}0&&(module.exports={confirmation});
