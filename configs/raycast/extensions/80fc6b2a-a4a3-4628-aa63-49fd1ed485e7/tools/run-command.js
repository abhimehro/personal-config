"use strict";var l=Object.defineProperty;var g=Object.getOwnPropertyDescriptor;var k=Object.getOwnPropertyNames;var E=Object.prototype.hasOwnProperty;var x=(e,r)=>{for(var o in r)l(e,o,{get:r[o],enumerable:!0})},v=(e,r,o,i)=>{if(r&&typeof r=="object"||typeof r=="function")for(let t of k(r))!E.call(e,t)&&t!==o&&l(e,t,{get:()=>r[t],enumerable:!(i=g(r,t))||i.enumerable});return e};var O=e=>v(l({},"__esModule",{value:!0}),e);var C={};x(C,{confirmation:()=>b,default:()=>y});module.exports=O(C);var w=require("node:child_process"),h=require("node:util");var m=require("@raycast/api"),n=require("node:path"),f=()=>{let e=(0,m.getPreferenceValues)();if(!e.workspaceRoot)throw new Error("Workspace root directory is not configured. Please set it in the extension preferences.");return(0,n.resolve)(e.workspaceRoot)};var p=e=>{if(!e)throw new Error("Path is required");let r=f(),o=(0,n.resolve)(r,e),i=(0,n.resolve)(r),t=(0,n.resolve)(o),u=(0,n.relative)(i,t);if(u.startsWith("..")||u==="..")throw new Error(`Path "${e}" is outside the configured workspace root "${r}". All file operations must be within the workspace root directory.`);return t};var P=(0,h.promisify)(w.execFile),c=1e4,R=3e4;async function b({command:e,cwd:r}){return{message:"Execute shell command?",info:[{name:"Command",value:e},{name:"Working Directory",value:r||"(workspace root)"}]}}function a(e,r){return e.length<=r?e:e.slice(0,r)+`
... (truncated, ${e.length-r} more characters)`}async function y({command:e,cwd:r,timeout:o=R}){if(!e||e.trim()==="")throw new Error("Command is required");let i=f(),t=r?p(r):i,u=process.env.SHELL||"/bin/sh";try{let{stdout:d,stderr:s}=await P(u,["-l","-c",e],{cwd:t,timeout:o,maxBuffer:5242880,env:{...process.env,FORCE_COLOR:"0",NO_COLOR:"1"}});return{success:!0,exitCode:0,stdout:a(d,c),stderr:a(s,c)}}catch(d){let s=d;return s.killed?{success:!1,exitCode:-1,stdout:a(s.stdout||"",c),stderr:`Command timed out after ${o}ms`,timedOut:!0}:{success:!1,exitCode:s.code||1,stdout:a(s.stdout||"",c),stderr:a(s.stderr||s.message||"Unknown error",c)}}}0&&(module.exports={confirmation});
