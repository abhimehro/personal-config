"use strict";var I=Object.create;var u=Object.defineProperty;var h=Object.getOwnPropertyDescriptor;var P=Object.getOwnPropertyNames;var _=Object.getPrototypeOf,w=Object.prototype.hasOwnProperty;var R=(e,o)=>{for(var t in o)u(e,t,{get:o[t],enumerable:!0})},x=(e,o,t,n)=>{if(o&&typeof o=="object"||typeof o=="function")for(let r of P(o))!w.call(e,r)&&r!==t&&u(e,r,{get:()=>o[r],enumerable:!(n=h(o,r))||n.enumerable});return e};var N=(e,o,t)=>(t=e!=null?I(_(e)):{},x(o||!e||!e.__esModule?u(t,"default",{value:e,enumerable:!0}):t,e)),$=e=>x(u({},"__esModule",{value:!0}),e);var O={};R(O,{default:()=>L});module.exports=$(O);var a=N(require("@raycast/api"));var T=["\u200B-\u200D","\u200E-\u200F","\u202A-\u202E","\u2066-\u2069","\u180B-\u180D","\uFE00-\uFE0F"],F=["\xAD","\u034F","\uFEFF"],v=["\u3164","\u115F","\u1160","\u17B4","\u17B5"],B=["\u2000-\u200A"],D=["\xA0","\u202F","\u205F","\u3000","\u180E"],M=["\u2018","\u2019","\u201C","\u201D"],K=["\u2013","\u2014"];function b(e){return e.join("")}var i=`[${b(T)}${F.join("")}]`,l=`[${v.join("")}]`,p=`[${b(B)}${D.join("")}]`,y=`[${M.join("")}${K.join("")}\u2026]`,m=/[\n\r\t \x20-\x7E]/;function A(e){return`U+${e.toString(16).toUpperCase()}`}function S(e){let o=[...e].length,t=e.replace(new RegExp(`${i}|${l}`,"gu"),"").trim().split(/\s+/u).filter(Boolean).length,n=e.match(new RegExp(`${i}`,"gu"))??[],r=e.match(new RegExp(`${y}`,"gu"))??[],c=e.match(new RegExp(`${p}`,"gu"))??[];return{totalCharacters:o,totalWords:t,invisible:{label:"Invisible Characters",count:n.length,codePoints:f(n)},nonKeyboard:{label:"Non-Keyboard Unicode",count:r.length,codePoints:f(r)},specialSpaces:{label:"Special Spaces",count:c.length,codePoints:f(c)}}}function f(e){let o=new Set;for(let t of e){let n=t.codePointAt(0);n!==void 0&&o.add(A(n))}return[...o]}var s=require("@raycast/api");function d(e){let o=new RegExp(`${i}|${l}`,"gu");return e.replace(o,"")}function g(e,o){let t=e;o.replaceNBSPWithSpace&&(t=t.replace(new RegExp(`${p}`,"gu")," ")),o.convertSmartQuotes&&(t=t.replace(/[\u2018\u2019]/gu,"'").replace(/[\u201C\u201D]/gu,'"')),o.convertDashes&&(t=t.replace(/[\u2013\u2014]/gu,"-")),o.replaceEllipsis&&(t=t.replace(/\u2026/gu,"..."));let n=Math.max(0,Number.parseInt(String(o.tabWidth||4),10)||4);return t=t.replace(/\t/gu," ".repeat(n)),t=t.replace(new RegExp(`${i}|${l}`,"gu"),""),o.normalizeNFKD&&(t=t.normalize("NFKD").replace(/\p{M}+/gu,"")),t=[...t].filter(r=>m.test(r)).join(""),o.collapseMultipleSpaces&&(t=t.replace(/ {2,}/g," ")),t}function E(){return(0,s.getPreferenceValues)()}async function C(e){if(e.preferSelectedText)try{let t=await(0,s.getSelectedText)();if(t&&t.length>0)return t}catch{}return await s.Clipboard.readText()??void 0}async function L(){let e=E();try{let o=await C(e);if(!o){await a.showToast({style:a.Toast.Style.Failure,title:"No text to process",message:"Select text or copy it to the clipboard"});return}let t=S(o),n=e.defaultCleanMode==="all"?g(o,e):d(o),r=S(n);if(e.actionAfterClean==="paste"?(await a.closeMainWindow(),await a.Clipboard.paste(n)):await a.Clipboard.copy(n),e.showToasts){let c=e.defaultCleanMode==="all"?"All Unicode":"Only Invisible";await a.showToast({style:a.Toast.Style.Success,title:`Cleaned text (${c})`,message:`before: ${t.invisible.count} invisible, ${t.nonKeyboard.count} non-keyboard \u2192 after: ${r.invisible.count} invisible, ${r.nonKeyboard.count} non-keyboard`})}}catch(o){await a.showToast({style:a.Toast.Style.Failure,title:"Failed to clean",message:String(o)})}}
