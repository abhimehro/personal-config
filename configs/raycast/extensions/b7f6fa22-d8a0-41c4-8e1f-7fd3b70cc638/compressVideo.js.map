{
  "version": 3,
  "sources": ["../src/compressVideo.tsx", "../src/utils/checkInstall.ts"],
  "sourcesContent": ["import {\n  showToast,\n  Toast,\n  getSelectedFinderItems,\n  ActionPanel,\n  Action,\n  Form,\n  popToRoot,\n  LocalStorage,\n} from \"@raycast/api\";\nimport { exec } from \"child_process\";\nimport { checkCompressXInstallation } from \"./utils/checkInstall\";\nimport { useState, useEffect } from \"react\";\nimport path from \"path\";\n\nexport default function Command() {\n  const [isInstalled, setIsInstalled] = useState<boolean | null>(false);\n  const [selectedFiles, setSelectedFiles] = useState<string[]>([]);\n  const [fileTypes, setFileTypes] = useState<Set<\"video\" | \"image\">>(new Set());\n  const [quality, setQuality] = useState<string>(\"high\");\n  const [videoFormat, setVideoFormat] = useState<string>(\"same\");\n  const [imageFormat, setImageFormat] = useState<string>(\"same\");\n\n  useEffect(() => {\n    checkCompressXInstallation().then(setIsInstalled);\n    getSelectedFinderItems().then((items) => {\n      if (items.length > 0) {\n        const paths = items.map((item) => item.path);\n        setSelectedFiles(paths);\n\n        // Determine file types\n        const types = new Set<\"video\" | \"image\">();\n        paths.forEach((filePath) => {\n          const ext = path.extname(filePath).toLowerCase();\n          if (ext.match(/\\.(mp4|mov|avi|mkv|webm)$/)) {\n            types.add(\"video\");\n          } else {\n            types.add(\"image\");\n          }\n        });\n        setFileTypes(types);\n      }\n    });\n\n    // Load saved preferences\n    LocalStorage.getItem<string>(\"savedQuality\").then((savedQuality) => {\n      if (savedQuality) setQuality(savedQuality);\n    });\n    LocalStorage.getItem<string>(\"savedVideoFormat\").then((savedFormat) => {\n      if (savedFormat) setVideoFormat(savedFormat);\n    });\n    LocalStorage.getItem<string>(\"savedImageFormat\").then((savedFormat) => {\n      if (savedFormat) setImageFormat(savedFormat);\n    });\n  }, []);\n\n  const qualityOptions = [\n    { title: \"High\", value: \"high\" },\n    { title: \"Good\", value: \"good\" },\n    { title: \"Medium\", value: \"medium\" },\n    { title: \"Acceptable\", value: \"acceptable\" },\n  ];\n\n  const videoFormatOptions = [\n    { title: \"Same as input\", value: \"same\" },\n    { title: \"MP4\", value: \"mp4\" },\n    { title: \"WebM\", value: \"webm\" },\n  ];\n\n  const imageFormatOptions = [\n    { title: \"Same as input\", value: \"same\" },\n    { title: \"PNG\", value: \"png\" },\n    { title: \"JPG\", value: \"jpg\" },\n    { title: \"WebP\", value: \"webp\" },\n  ];\n\n  const compressFiles = async (values: { quality: string; videoFormat?: string; imageFormat?: string }) => {\n    if (selectedFiles.length === 0) return;\n\n    try {\n      const paths = selectedFiles.join(\"|\");\n      let url = `compresto://open?path=${paths}&quality=${values.quality}`;\n\n      // Add format parameters if they exist\n      if (values.videoFormat && fileTypes.has(\"video\")) {\n        url += `&videoFormat=${values.videoFormat}`;\n      }\n      if (values.imageFormat && fileTypes.has(\"image\")) {\n        url += `&imageFormat=${values.imageFormat}`;\n      }\n\n      exec(`open \"${url}\"`);\n\n      // Save user preferences\n      await LocalStorage.setItem(\"savedQuality\", values.quality);\n      if (values.videoFormat) {\n        await LocalStorage.setItem(\"savedVideoFormat\", values.videoFormat);\n      }\n      if (values.imageFormat) {\n        await LocalStorage.setItem(\"savedImageFormat\", values.imageFormat);\n      }\n\n      await showToast({\n        style: Toast.Style.Success,\n        title: \"Sent to Compresto for compressing\",\n        message: `${selectedFiles.length} files selected`,\n      });\n      await popToRoot();\n    } catch (e) {\n      await showToast({\n        style: Toast.Style.Failure,\n        title: \"Error\",\n        message: e instanceof Error ? e.message : \"An error occurred\",\n      });\n    }\n  };\n\n  if (isInstalled === null || selectedFiles.length === 0 || fileTypes.size === 0) {\n    return <Form isLoading={true} />;\n  }\n\n  if (isInstalled === false) {\n    return (\n      <Form\n        actions={\n          <ActionPanel>\n            <Action.OpenInBrowser title=\"Install Compresto\" url=\"https://compresto.app\" />\n          </ActionPanel>\n        }\n      >\n        <Form.Description text=\"Compresto is not installed. Please install it to use this extension.\" />\n      </Form>\n    );\n  }\n\n  return (\n    <Form\n      actions={\n        <ActionPanel>\n          <Action.SubmitForm title=\"Compress Files\" onSubmit={compressFiles} />\n        </ActionPanel>\n      }\n    >\n      <Form.Dropdown id=\"quality\" title=\"Quality\" value={quality} onChange={setQuality}>\n        {qualityOptions.map((option) => (\n          <Form.Dropdown.Item key={option.value} value={option.value} title={option.title} />\n        ))}\n      </Form.Dropdown>\n\n      {fileTypes.has(\"video\") && (\n        <Form.Dropdown id=\"videoFormat\" title=\"Video Format\" value={videoFormat} onChange={setVideoFormat}>\n          {videoFormatOptions.map((option) => (\n            <Form.Dropdown.Item key={option.value} value={option.value} title={option.title} />\n          ))}\n        </Form.Dropdown>\n      )}\n\n      {fileTypes.has(\"image\") && (\n        <Form.Dropdown id=\"imageFormat\" title=\"Image Format\" value={imageFormat} onChange={setImageFormat}>\n          {imageFormatOptions.map((option) => (\n            <Form.Dropdown.Item key={option.value} value={option.value} title={option.title} />\n          ))}\n        </Form.Dropdown>\n      )}\n\n      <Form.Description text={`Selected ${selectedFiles.length} file${selectedFiles.length > 1 ? \"s\" : \"\"}`} />\n    </Form>\n  );\n}\n", "import { getApplications, showToast, Toast, open } from \"@raycast/api\";\n\nasync function isCompressXInstalled() {\n  const applications = await getApplications();\n  return applications.some(({ bundleId }) => bundleId === \"com.hieudinh.CompressX\");\n}\n\nexport async function checkCompressXInstallation(): Promise<boolean> {\n  const isInstalled = await isCompressXInstalled();\n  if (!isInstalled) {\n    const options: Toast.Options = {\n      style: Toast.Style.Failure,\n      title: \"Compresto is not installed.\",\n      message: \"Install it from: https://compresto.app\",\n      primaryAction: {\n        title: \"Go to https://compresto.app\",\n        onAction: (toast) => {\n          open(\"https://compresto.app\");\n          toast.hide();\n        },\n      },\n    };\n\n    await showToast(options);\n  }\n  return isInstalled;\n}\n"],
  "mappings": "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",
  "names": ["compressVideo_exports", "__export", "Command", "__toCommonJS", "import_api", "import_child_process", "import_api", "isCompressXInstalled", "bundleId", "checkCompressXInstallation", "isInstalled", "options", "toast", "import_react", "import_path", "import_jsx_runtime", "Command", "isInstalled", "setIsInstalled", "selectedFiles", "setSelectedFiles", "fileTypes", "setFileTypes", "quality", "setQuality", "videoFormat", "setVideoFormat", "imageFormat", "setImageFormat", "checkCompressXInstallation", "items", "paths", "item", "types", "filePath", "path", "savedQuality", "savedFormat", "qualityOptions", "videoFormatOptions", "imageFormatOptions", "compressFiles", "values", "url", "e", "option"]
}
