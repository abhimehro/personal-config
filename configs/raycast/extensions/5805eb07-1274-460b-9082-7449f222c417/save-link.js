"use strict";var u=Object.defineProperty;var T=Object.getOwnPropertyDescriptor;var C=Object.getOwnPropertyNames;var F=Object.prototype.hasOwnProperty;var x=(t,i)=>{for(var e in i)u(t,e,{get:i[e],enumerable:!0})},L=(t,i,e,r)=>{if(i&&typeof i=="object"||typeof i=="function")for(let o of C(i))!F.call(t,o)&&o!==e&&u(t,o,{get:()=>i[o],enumerable:!(r=T(i,o))||r.enumerable});return t};var U=t=>L(u({},"__esModule",{value:!0}),t);var E={};x(E,{default:()=>h});module.exports=U(E);var c=require("@raycast/api");var s=require("@raycast/api"),n=require("fs"),p=require("os"),a=require("path"),S=20;function k(t){return`<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
	<key>URL</key>
	<string>${t}</string>
</dict>
</plist>`}function v(t){return t.replace(/[^\w\s-]/g,"").replace(/\s+/g," ").trim().slice(0,50)}function D(){let t=(0,a.join)((0,p.homedir)(),"Library","Caches","com.raycast.save-link");try{(0,n.mkdirSync)(t,{recursive:!0})}catch{}return t}function P(t,i=20){try{let e=(0,n.readdirSync)(t).filter(r=>r.endsWith(".webloc")).map(r=>{let o=(0,a.join)(t,r);return{name:r,path:o,mtime:(0,n.statSync)(o).mtime}}).sort((r,o)=>o.mtime.getTime()-r.mtime.getTime());if(e.length>i){let r=e.slice(i);for(let o of r)try{(0,n.unlinkSync)(o.path)}catch(l){console.warn(`Failed to delete cache file ${o.name}:`,l)}}}catch(e){console.warn("Failed to cleanup cache files:",e)}}async function g(t){let{url:i,customTitle:e,fallbackTitle:r="Link",titleSource:o="default"}=t,l=D(),m=v(e||r),w=`${m||"Link"}.webloc`,f=(0,a.join)(l,w),d=k(i);try{(0,n.writeFileSync)(f,d,"utf8")}catch(y){throw new Error(`Failed to create webloc file: ${y}`)}P(l,S);let b={file:f};await s.Clipboard.copy(b),await(0,s.showHUD)(`\u{1F4CB} Copied "${m}.webloc" to clipboard (using ${e?"custom title":o})`)}async function h(t){let{title:i}=t.arguments;try{let r=(await c.BrowserExtension.getTabs()).find(o=>o.active);if(!r||!r.url){await(0,c.showHUD)("\u274C No active browser tab found");return}await g({url:r.url,customTitle:i,fallbackTitle:r.title||"Untitled",titleSource:"page title"})}catch(e){console.error("Error creating webloc file:",e),await(0,c.showHUD)(`\u274C Failed to create webloc file: ${e instanceof Error?e.message:String(e)}`)}}
