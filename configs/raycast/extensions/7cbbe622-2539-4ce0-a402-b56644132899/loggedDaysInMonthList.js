"use strict";var Q=Object.create;var u=Object.defineProperty;var X=Object.getOwnPropertyDescriptor;var Z=Object.getOwnPropertyNames;var tt=Object.getPrototypeOf,et=Object.prototype.hasOwnProperty;var ot=(o,t)=>{for(var e in t)u(o,e,{get:t[e],enumerable:!0})},b=(o,t,e,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of Z(t))!et.call(o,i)&&i!==e&&u(o,i,{get:()=>t[i],enumerable:!(r=X(t,i))||r.enumerable});return o};var n=(o,t,e)=>(e=o!=null?Q(tt(o)):{},b(t||!o||!o.__esModule?u(e,"default",{value:o,enumerable:!0}):e,o)),rt=o=>b(u({},"__esModule",{value:!0}),o);var nt={};ot(nt,{default:()=>q});module.exports=rt(nt);var T=require("@raycast/api"),V=require("react");var L=class{constructor(t){this.repository=t}execute(t){return this.repository.getAllForDate(t).sort((e,r)=>e.date.getTime()-r.date.getTime())}};var J=n(require("crypto")),F=new Uint8Array(256),h=F.length;function N(){return h>F.length-16&&(J.default.randomFillSync(F),h=0),F.slice(h,h+=16)}var a=[];for(let o=0;o<256;++o)a.push((o+256).toString(16).slice(1));function E(o,t=0){return(a[o[t+0]]+a[o[t+1]]+a[o[t+2]]+a[o[t+3]]+"-"+a[o[t+4]]+a[o[t+5]]+"-"+a[o[t+6]]+a[o[t+7]]+"-"+a[o[t+8]]+a[o[t+9]]+"-"+a[o[t+10]]+a[o[t+11]]+a[o[t+12]]+a[o[t+13]]+a[o[t+14]]+a[o[t+15]]).toLowerCase()}var O=n(require("crypto")),$={randomUUID:O.default.randomUUID};function it(o,t,e){if($.randomUUID&&!t&&!o)return $.randomUUID();o=o||{};let r=o.random||(o.rng||N)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,t){e=e||0;for(let i=0;i<16;++i)t[e+i]=r[i];return t}return E(r)}var D=it;var g=class{constructor(t,e,r){this.id=t;this.date=e;this.title=r}};var x=class{constructor(t){this.dataStorage=t}saveLogs(t,e){let r=JSON.stringify(t);this.dataStorage.save(r,e)}update(t){let e=this.getAllForDate(t.date).filter(r=>r.id!==t.id);e.push(t),this.saveLogs(e,t.date)}create(t){let e=this.getAllForDate(t.date),r=new g(D(),t.date,t.title);e.push(r),this.saveLogs(e,t.date)}getAllForDate(t){if(!this.dataStorage.dataForDateExists(t))return[];let e=this.dataStorage.readForDate(t);return JSON.parse(e).map(r=>new g(r.id,new Date(r.date),r.title))}dateContainsLogs(t){return this.getAllForDate(t).length>0}deleteLog(t,e){let i=this.getAllForDate(e).filter(d=>d.id!==t);this.saveLogs(i,e)}deleteAllForDate(t){this.dataStorage.deleteAllDataForDate(t)}};var W=require("@raycast/api");function k(o){return o.toISOString().split("T")[0]}function y(o){let t=k(o);return`${m()}/${t}.md`}function j(o){let t=k(o);return`${m()}/${t}.json`}function m(){let o=process.env.HOME;return(0,W.getPreferenceValues)().logPath.replace("~",o)}var l=n(require("fs"));var S=class{readDailyLogs(t){return l.readFileSync(y(t),"utf8").split(`
`).filter(e=>e.length>0).map(e=>this.dailyLogFromLogLine(e,t))}dailyLogFromLogLine(t,e){let[r,i]=t.split(": "),[d,B,K]=r.split(" ")[1].split(":"),f=new Date(e);return f.setHours(parseInt(d)),f.setMinutes(parseInt(B)),f.setSeconds(parseInt(K)),new g(D(),f,i)}update(t){}getAllForDate(t){return l.existsSync(y(t))?this.readDailyLogs(t):[]}dateContainsLogs(t){return this.getAllForDate(t).length>0}deleteLog(t,e){}deleteAllForDate(t){l.existsSync(y(t))&&l.rmSync(y(t))}create(t){}};var v=class{constructor(t,e){this.legacy=t;this.repository=e}update(t){this.legacy.dateContainsLogs(t.date)&&this.migrateLogsForDate(t.date),this.repository.update(t)}create(t){this.legacy.dateContainsLogs(t.date)&&this.migrateLogsForDate(t.date),this.repository.create(t)}migrateLogsForDate(t){this.legacy.getAllForDate(t).forEach(e=>{this.repository.create(e)}),this.legacy.deleteAllForDate(t)}getAllForDate(t){return this.legacy.dateContainsLogs(t)&&this.migrateLogsForDate(t),this.repository.getAllForDate(t)}dateContainsLogs(t){return this.legacy.dateContainsLogs(t)||this.repository.dateContainsLogs(t)}deleteLog(t,e){this.legacy.dateContainsLogs(e)&&this.migrateLogsForDate(e),this.repository.deleteLog(t,e)}deleteAllForDate(t){this.legacy.dateContainsLogs(t)&&this.legacy.deleteAllForDate(t),this.repository.deleteAllForDate(t)}};var s=n(require("fs")),H=n(require("path")),w=class{constructor(t){this.getFilePath=t}save(t,e){let r=this.getFilePath(e),i=H.dirname(r);s.existsSync(i)||s.mkdirSync(i,{recursive:!0}),s.writeFileSync(r,t)}dataForDateExists(t){return s.existsSync(this.getFilePath(t))}readForDate(t){return s.readFileSync(this.getFilePath(t),"utf8")}deleteAllDataForDate(t){s.existsSync(this.getFilePath(t))&&s.rmSync(this.getFilePath(t))}};function M(){return new v(new S,new x(new w(j)))}function z(){return new L(M())}var R=class{constructor(t){this.repository=t}execute(){return this.repository.getLoggedDays().sort((t,e)=>e.date.getTime()-t.date.getTime())}};var A=n(require("fs"));var p=class{constructor(t){this.date=t}get title(){let t=new Date;return this.date.toDateString()===t.toDateString()?"Today":(t.setDate(t.getDate()-1),this.date.toDateString()===t.toDateString()?"Yesterday":`${this.date.getDate()} of ${this.date.toLocaleDateString("en-US",{month:"long"})} ${this.date.getFullYear()}`)}};var P=class{getLoggedDays(){let t=m();return A.existsSync(t)?A.readdirSync(t).filter(e=>e.endsWith(".json")).map(e=>e.replace(".json","")).map(e=>new Date(e)).sort((e,r)=>r.getTime()-e.getTime()).map(e=>new p(e)):[]}};var U=n(require("fs"));var C=class{getLoggedDays(){let t=m();return U.existsSync(t)?U.readdirSync(t).filter(e=>e.endsWith(".md")).map(e=>e.replace(".md","")).map(e=>new Date(e)).sort((e,r)=>r.getTime()-e.getTime()).map(e=>new p(e)):[]}};var I=class{constructor(t){this.repositories=t}getLoggedDays(){return this.repositories.map(e=>e.getLoggedDays()).flat().filter((e,r,i)=>r===i.findIndex(d=>d.date.getTime()===e.date.getTime()))}};function G(){return new I([new C,new P])}function Y(){return new R(G())}function _(o){return o.length===0?o:o[0].toUpperCase()+o.slice(1)}var c=require("react/jsx-runtime");function q(){let o=Y(),[t]=(0,V.useState)(o.execute());return(0,c.jsx)(T.List,{isShowingDetail:!0,children:t.map(e=>(0,c.jsx)(T.List.Item,{title:e.title,detail:(0,c.jsx)(at,{date:e.date})},e.date.toISOString()))})}function at(o){let t=z().execute(o.date);return(0,c.jsx)(T.List.Item.Detail,{markdown:t.map(e=>`* ${_(e.title)} - _${st(e.date)}_`).join(`
`)})}function st(o){return o.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!1})}
