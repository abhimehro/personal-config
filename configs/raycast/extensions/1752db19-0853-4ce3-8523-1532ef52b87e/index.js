"use strict";var re=Object.create;var R=Object.defineProperty;var ne=Object.getOwnPropertyDescriptor;var ae=Object.getOwnPropertyNames;var se=Object.getPrototypeOf,ie=Object.prototype.hasOwnProperty;var oe=(e,t)=>{for(var r in t)R(e,r,{get:t[r],enumerable:!0})},V=(e,t,r,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of ae(t))!ie.call(e,o)&&o!==r&&R(e,o,{get:()=>t[o],enumerable:!(i=ne(t,o))||i.enumerable});return e};var O=(e,t,r)=>(r=e!=null?re(se(e)):{},V(t||!e||!e.__esModule?R(r,"default",{value:e,enumerable:!0}):r,e)),ce=e=>V(R({},"__esModule",{value:!0}),e);var de={};oe(de,{default:()=>J});module.exports=ce(de);var c=require("@raycast/api");var s=O(require("react")),a=require("@raycast/api");var N=Object.prototype.hasOwnProperty;function _(e,t){var r,i;if(e===t)return!0;if(e&&t&&(r=e.constructor)===t.constructor){if(r===Date)return e.getTime()===t.getTime();if(r===RegExp)return e.toString()===t.toString();if(r===Array){if((i=e.length)===t.length)for(;i--&&_(e[i],t[i]););return i===-1}if(!r||typeof e=="object"){i=0;for(r in e)if(N.call(e,r)&&++i&&!N.call(t,r)||!(r in t)||!_(e[r],t[r]))return!1;return Object.keys(t).length===i}}return e!==e&&t!==t}var y=O(require("node:fs")),T=O(require("node:path"));var j=require("react/jsx-runtime");function le(e){let t=(0,s.useRef)(e),r=(0,s.useRef)(0);return _(e,t.current)||(t.current=e,r.current+=1),(0,s.useMemo)(()=>t.current,[r.current])}function m(e){let t=(0,s.useRef)(e);return t.current=e,t}function L(e,t){let r=e instanceof Error?e.message:String(e);return(0,a.showToast)({style:a.Toast.Style.Failure,title:t?.title??"Something went wrong",message:t?.message??r,primaryAction:t?.primaryAction??F(e),secondaryAction:t?.primaryAction?F(e):void 0})}var F=e=>{let t=!0,r="[Extension Name]...",i="";try{let f=JSON.parse((0,y.readFileSync)((0,T.join)(a.environment.assetsPath,"..","package.json"),"utf8"));r=`[${f.title}]...`,i=`https://raycast.com/${f.owner||f.author}/${f.name}`,(!f.owner||f.access==="public")&&(t=!1)}catch{}let o=a.environment.isDevelopment||t,u=e instanceof Error?e?.stack||e?.message||"":String(e);return{title:o?"Copy Logs":"Report Error",onAction(f){f.hide(),o?a.Clipboard.copy(u):(0,a.open)(`https://github.com/raycast/extensions/issues/new?&labels=extension%2Cbug&template=extension_bug_report.yml&title=${encodeURIComponent(r)}&extension-url=${encodeURI(i)}&description=${encodeURIComponent(`#### Error:
\`\`\`
${u}
\`\`\`
`)}`)}}};function B(e,t,r){let i=(0,s.useRef)(0),[o,u]=(0,s.useState)({isLoading:!0}),f=m(e),S=m(r?.abortable),k=m(t||[]),P=m(r?.onError),E=m(r?.onData),M=m(r?.onWillExecute),D=m(r?.failureToastOptions),W=m(o.data),U=(0,s.useRef)(null),d=(0,s.useRef)({page:0}),C=(0,s.useRef)(!1),I=(0,s.useRef)(!0),z=(0,s.useRef)(50),b=(0,s.useCallback)(()=>(S.current&&(S.current.current?.abort(),S.current.current=new AbortController),++i.current),[S]),g=(0,s.useCallback)((...p)=>{let l=b();M.current?.(p),u(n=>({...n,isLoading:!0}));let x=ue(f.current)(...p);function v(n){return n.name=="AbortError"||l===i.current&&(P.current?P.current(n):a.environment.launchType!==a.LaunchType.Background&&L(n,{title:"Failed to fetch latest data",primaryAction:{title:"Retry",onAction($){$.hide(),U.current?.(...k.current||[])}},...D.current}),u({error:n,isLoading:!1})),n}return typeof x=="function"?(C.current=!0,x(d.current).then(({data:n,hasMore:$,cursor:ee})=>(l===i.current&&(d.current&&(d.current.cursor=ee,d.current.lastItem=n?.[n.length-1]),E.current&&E.current(n,d.current),$&&(z.current=n.length),I.current=$,u(te=>d.current.page===0?{data:n,isLoading:!1}:{data:(te.data||[])?.concat(n),isLoading:!1})),n),n=>(I.current=!1,v(n)))):(C.current=!1,x.then(n=>(l===i.current&&(E.current&&E.current(n),u({data:n,isLoading:!1})),n),v))},[E,P,k,f,u,U,M,d,D,b]);U.current=g;let A=(0,s.useCallback)(()=>{d.current={page:0};let p=k.current||[];return g(...p)},[g,k]),Z=(0,s.useCallback)(async(p,l)=>{let x;try{if(l?.optimisticUpdate){b(),typeof l?.rollbackOnError!="function"&&l?.rollbackOnError!==!1&&(x=structuredClone(W.current?.value));let v=l.optimisticUpdate;u(n=>({...n,data:v(n.data)}))}return await p}catch(v){if(typeof l?.rollbackOnError=="function"){let n=l.rollbackOnError;u($=>({...$,data:n($.data)}))}else l?.optimisticUpdate&&l?.rollbackOnError!==!1&&u(n=>({...n,data:x}));throw v}finally{l?.shouldRevalidateAfter!==!1&&(a.environment.launchType===a.LaunchType.Background||a.environment.commandMode==="menu-bar"?await A():A())}},[A,W,u,b]),q=(0,s.useCallback)(()=>{d.current.page+=1;let p=k.current||[];g(...p)},[d,k,g]);(0,s.useEffect)(()=>{d.current={page:0},r?.execute!==!1?g(...t||[]):b()},[le([t,r?.execute,g]),S,d]),(0,s.useEffect)(()=>()=>{b()},[b]);let Y=r?.execute!==!1?o.isLoading:!1,X={...o,isLoading:Y},Q=C.current?{pageSize:z.current,hasMore:I.current,onLoadMore:q}:void 0;return{...X,revalidate:A,mutate:Z,pagination:Q}}function ue(e){return e===Promise.all||e===Promise.race||e===Promise.resolve||e===Promise.reject?e.bind(Promise):e}var w=require("@raycast/api");var G=require("child_process"),K=require("util"),fe=(0,K.promisify)(G.execFile);async function H(e){try{await(0,w.closeMainWindow)({clearRootSearch:!0});let t=await(0,w.showToast)({style:w.Toast.Style.Animated,title:`Launching new instance of ${e.name}...`});await fe("open",["-n",e.path]),t.style=w.Toast.Style.Success,t.title=`Launched new instance of ${e.name}`}catch(t){await L(t,{title:"Failed to launch application"})}}var h=require("react/jsx-runtime");function J(){let{data:e,isLoading:t,error:r}=B(c.getApplications),i=e||[];return r?(0,h.jsx)(c.List,{children:(0,h.jsx)(c.List.EmptyView,{icon:c.Icon.ExclamationMark,title:"Failed to load applications",description:"Unable to retrieve the list of installed applications"})}):(0,h.jsx)(c.List,{isLoading:t,searchBarPlaceholder:"Search applications...",throttle:!0,children:i.length===0&&!t?(0,h.jsx)(c.List.EmptyView,{icon:c.Icon.AppWindow,title:"No applications found",description:"No suitable applications found for launching new instances"}):i.map(o=>(0,h.jsx)(c.List.Item,{title:o.name,subtitle:o.path,icon:{fileIcon:o.path},accessories:[{text:o.bundleId||"",tooltip:"Bundle ID"}],actions:(0,h.jsxs)(c.ActionPanel,{children:[(0,h.jsx)(c.Action,{title:"Launch New Instance",icon:c.Icon.Plus,onAction:()=>H(o)}),(0,h.jsx)(c.Action.ShowInFinder,{title:"Show in Finder",path:o.path}),(0,h.jsx)(c.Action.CopyToClipboard,{title:"Copy Application Path",content:o.path,shortcut:{modifiers:["cmd"],key:"c"}}),(0,h.jsx)(c.Action.CopyToClipboard,{title:"Copy Bundle ID",content:o.bundleId||"",shortcut:{modifiers:["cmd","shift"],key:"c"}})]})},o.path))})}
