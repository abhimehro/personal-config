{
  "version": 3,
  "sources": ["../src/image-to-base64.tsx", "../src/libs/imageUtils.ts"],
  "sourcesContent": ["import { Form, ActionPanel, Action, showToast, Detail, Toast, Icon, Clipboard } from \"@raycast/api\";\nimport { useState } from \"react\";\nimport fs from \"fs\";\nimport path from \"path\";\nimport { getImageDimensionsFromBase64, formatFileSize } from \"./libs/imageUtils\";\n\ninterface Image {\n  base64: string;\n  fileName: string;\n  size: number;\n  dimensions: {\n    width: number;\n    height: number;\n  };\n}\n\nexport default function ImageToBase64() {\n  const [image, setImage] = useState<Image | null>(null);\n\n  const handleSubmit = async (values: { filePath: string[] }) => {\n    const filePath = values.filePath[0];\n    if (!filePath) {\n      showToast({\n        style: Toast.Style.Failure,\n        title: \"Error\",\n        message: \"Please select an image file\",\n      });\n      return;\n    }\n\n    try {\n      const imageBuffer = fs.readFileSync(filePath);\n      const base64String = imageBuffer.toString(\"base64\");\n      const fileName = path.basename(filePath);\n      const stats = fs.statSync(filePath);\n\n      const base64 = `data:image/${path.extname(filePath).slice(1)};base64,${base64String}`;\n\n      setImage({\n        base64,\n        fileName: fileName,\n        size: stats.size,\n        dimensions: getImageDimensionsFromBase64(base64) ?? { width: 0, height: 0 },\n      });\n    } catch (error) {\n      showToast({\n        style: Toast.Style.Failure,\n        title: \"Error\",\n        message: \"Failed to convert image to base64\",\n      });\n    }\n  };\n\n  const handleCopyToClipboard = async () => {\n    if (!image) return;\n    await Clipboard.copy(image.base64);\n    showToast({\n      style: Toast.Style.Success,\n      title: \"Success\",\n      message: \"Base64 string copied to clipboard\",\n    });\n  };\n\n  if (image) {\n    return (\n      <Detail\n        markdown={`![Converted Image](${image.base64})`}\n        actions={\n          <ActionPanel>\n            <ActionPanel.Section>\n              <Action\n                title=\"Convert Another\"\n                onAction={() => setImage(null)}\n                icon={Icon.ArrowClockwise}\n                shortcut={{ modifiers: [\"cmd\"], key: \"r\" }}\n              />\n              <Action\n                title=\"Copy Base64 to Clipboard\"\n                onAction={handleCopyToClipboard}\n                icon={Icon.Clipboard}\n                shortcut={{ modifiers: [\"cmd\"], key: \"c\" }}\n              />\n            </ActionPanel.Section>\n          </ActionPanel>\n        }\n        metadata={\n          <Detail.Metadata>\n            <Detail.Metadata.Label title=\"File Name\" text={image.fileName} />\n            <Detail.Metadata.Separator />\n            <Detail.Metadata.Label title=\"Dimensions\" text={`${image.dimensions.width}x${image.dimensions.height}`} />\n            <Detail.Metadata.Separator />\n            <Detail.Metadata.Label title=\"Size\" text={formatFileSize(image.size)} />\n            <Detail.Metadata.Separator />\n            <Detail.Metadata.TagList title=\"Actions\">\n              <Detail.Metadata.TagList.Item text=\"Copy Base64\" color={\"#32D74B\"} />\n            </Detail.Metadata.TagList>\n          </Detail.Metadata>\n        }\n      />\n    );\n  }\n\n  return (\n    <Form\n      actions={\n        <ActionPanel>\n          <Action.SubmitForm title=\"Convert to Base64\" onSubmit={handleSubmit} />\n        </ActionPanel>\n      }\n    >\n      <Form.FilePicker id=\"filePath\" title=\"Select Image\" allowMultipleSelection={false} canChooseDirectories={false} />\n    </Form>\n  );\n}\n", "import { Buffer } from \"buffer\";\n\n/**\n * Extracts the width and height of an image from its base64 representation.\n * @param base64 The base64 string of the image.\n * @returns An object containing the width and height of the image, or null if extraction fails.\n */\nexport function getImageDimensionsFromBase64(base64: string): { width: number; height: number } | null {\n  try {\n    // Remove the data URL prefix if present\n    const cleanedBase64 = base64.replace(/^data:image\\/\\w+;base64,/, \"\");\n\n    // Decode the base64 string\n    const buffer = Buffer.from(cleanedBase64, \"base64\");\n\n    // Check for PNG signature\n    if (buffer.toString(\"hex\", 0, 8) === \"89504e470d0a1a0a\") {\n      // PNG: Width is at bytes 16-19, height at 20-23\n      const width = buffer.readUInt32BE(16);\n      const height = buffer.readUInt32BE(20);\n      return { width, height };\n    }\n\n    // Check for JPEG signature\n    if (buffer[0] === 0xff && buffer[1] === 0xd8) {\n      let offset = 2;\n      while (offset < buffer.length) {\n        // Check for Start of Frame markers\n        if (buffer[offset] === 0xff && (buffer[offset + 1] === 0xc0 || buffer[offset + 1] === 0xc2)) {\n          const height = buffer.readUInt16BE(offset + 5);\n          const width = buffer.readUInt16BE(offset + 7);\n          return { width, height };\n        }\n        offset += 2 + buffer.readUInt16BE(offset + 2);\n      }\n    }\n\n    // Check for WebP signature\n    if (buffer.toString(\"ascii\", 0, 4) === \"RIFF\" && buffer.toString(\"ascii\", 8, 12) === \"WEBP\") {\n      // WebP: Width and height are stored in VP8/VP8L chunk\n      const vp8Signature = buffer.toString(\"ascii\", 12, 15);\n      if (vp8Signature === \"VP8\") {\n        // Simple WebP format\n        const width = buffer.readUInt16LE(26) & 0x3fff;\n        const height = buffer.readUInt16LE(28) & 0x3fff;\n        return { width, height };\n      } else if (vp8Signature === \"VP8L\") {\n        // Lossless WebP format\n        const bits = buffer.readUInt32LE(21);\n        const width = (bits & 0x3fff) + 1;\n        const height = ((bits >> 14) & 0x3fff) + 1;\n        return { width, height };\n      }\n    }\n\n    // Unsupported format or unable to extract dimensions\n    return null;\n  } catch (error) {\n    console.error(\"Error extracting image dimensions:\", error);\n    return null;\n  }\n}\n\nexport function calculateBase64Size(base64String: string): number {\n  const padding = base64String.endsWith(\"==\") ? 2 : base64String.endsWith(\"=\") ? 1 : 0;\n  return (base64String.length * 3) / 4 - padding;\n}\n\nexport function isValidBase64(str: string): boolean {\n  try {\n    if (!str) return false;\n\n    let base64Data = str;\n    if (str.startsWith(\"data:image/\")) {\n      const parts = str.split(\",\");\n      if (parts.length !== 2) return false;\n      base64Data = parts[1];\n    }\n\n    if (base64Data.length % 4 !== 0) return false;\n    if (!/^[A-Za-z0-9+/=]*$/.test(base64Data)) return false;\n\n    const lastPadding = base64Data.indexOf(\"=\");\n    if (lastPadding !== -1) {\n      if (lastPadding !== base64Data.length - 1 && lastPadding !== base64Data.length - 2) return false;\n      if (base64Data.indexOf(\"=\") !== lastPadding) return false;\n    }\n\n    return true;\n  } catch {\n    return false;\n  }\n}\n\nexport function formatFileSize(bytes: number): string {\n  const MB = 1024 * 1024;\n  const KB = 1024;\n\n  if (bytes > MB) {\n    return `${(bytes / MB).toFixed(2)} MB`;\n  }\n  return `${(bytes / KB).toFixed(2)} KB`;\n}\n"],
  "mappings": "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",
  "names": ["image_to_base64_exports", "__export", "ImageToBase64", "__toCommonJS", "import_api", "import_react", "import_fs", "import_path", "import_buffer", "getImageDimensionsFromBase64", "base64", "cleanedBase64", "buffer", "width", "height", "offset", "vp8Signature", "bits", "error", "formatFileSize", "bytes", "import_jsx_runtime", "ImageToBase64", "image", "setImage", "handleSubmit", "values", "filePath", "base64String", "fs", "fileName", "path", "stats", "base64", "getImageDimensionsFromBase64", "handleCopyToClipboard", "formatFileSize"]
}
