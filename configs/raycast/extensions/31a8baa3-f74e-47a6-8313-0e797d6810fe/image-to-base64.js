"use strict";var y=Object.create;var l=Object.defineProperty;var F=Object.getOwnPropertyDescriptor;var M=Object.getOwnPropertyNames;var P=Object.getPrototypeOf,C=Object.prototype.hasOwnProperty;var E=(a,n)=>{for(var t in n)l(a,t,{get:n[t],enumerable:!0})},u=(a,n,t,r)=>{if(n&&typeof n=="object"||typeof n=="function")for(let o of M(n))!C.call(a,o)&&o!==t&&l(a,o,{get:()=>n[o],enumerable:!(r=F(n,o))||r.enumerable});return a};var g=(a,n,t)=>(t=a!=null?y(P(a)):{},u(n||!a||!a.__esModule?l(t,"default",{value:a,enumerable:!0}):t,a)),A=a=>u(l({},"__esModule",{value:!0}),a);var L={};E(L,{default:()=>S});module.exports=A(L);var e=require("@raycast/api"),B=require("react"),f=g(require("fs")),m=g(require("path"));var h=require("buffer");function p(a){try{let n=a.replace(/^data:image\/\w+;base64,/,""),t=h.Buffer.from(n,"base64");if(t.toString("hex",0,8)==="89504e470d0a1a0a"){let r=t.readUInt32BE(16),o=t.readUInt32BE(20);return{width:r,height:o}}if(t[0]===255&&t[1]===216){let r=2;for(;r<t.length;){if(t[r]===255&&(t[r+1]===192||t[r+1]===194)){let o=t.readUInt16BE(r+5);return{width:t.readUInt16BE(r+7),height:o}}r+=2+t.readUInt16BE(r+2)}}if(t.toString("ascii",0,4)==="RIFF"&&t.toString("ascii",8,12)==="WEBP"){let r=t.toString("ascii",12,15);if(r==="VP8"){let o=t.readUInt16LE(26)&16383,s=t.readUInt16LE(28)&16383;return{width:o,height:s}}else if(r==="VP8L"){let o=t.readUInt32LE(21),s=(o&16383)+1,c=(o>>14&16383)+1;return{width:s,height:c}}}return null}catch(n){return console.error("Error extracting image dimensions:",n),null}}function b(a){return a>1048576?`${(a/1048576).toFixed(2)} MB`:`${(a/1024).toFixed(2)} KB`}var i=require("react/jsx-runtime");function S(){let[a,n]=(0,B.useState)(null),t=async o=>{let s=o.filePath[0];if(!s){(0,e.showToast)({style:e.Toast.Style.Failure,title:"Error",message:"Please select an image file"});return}try{let x=f.default.readFileSync(s).toString("base64"),I=m.default.basename(s),w=f.default.statSync(s),d=`data:image/${m.default.extname(s).slice(1)};base64,${x}`;n({base64:d,fileName:I,size:w.size,dimensions:p(d)??{width:0,height:0}})}catch{(0,e.showToast)({style:e.Toast.Style.Failure,title:"Error",message:"Failed to convert image to base64"})}},r=async()=>{a&&(await e.Clipboard.copy(a.base64),(0,e.showToast)({style:e.Toast.Style.Success,title:"Success",message:"Base64 string copied to clipboard"}))};return a?(0,i.jsx)(e.Detail,{markdown:`![Converted Image](${a.base64})`,actions:(0,i.jsx)(e.ActionPanel,{children:(0,i.jsxs)(e.ActionPanel.Section,{children:[(0,i.jsx)(e.Action,{title:"Convert Another",onAction:()=>n(null),icon:e.Icon.ArrowClockwise,shortcut:{modifiers:["cmd"],key:"r"}}),(0,i.jsx)(e.Action,{title:"Copy Base64 to Clipboard",onAction:r,icon:e.Icon.Clipboard,shortcut:{modifiers:["cmd"],key:"c"}})]})}),metadata:(0,i.jsxs)(e.Detail.Metadata,{children:[(0,i.jsx)(e.Detail.Metadata.Label,{title:"File Name",text:a.fileName}),(0,i.jsx)(e.Detail.Metadata.Separator,{}),(0,i.jsx)(e.Detail.Metadata.Label,{title:"Dimensions",text:`${a.dimensions.width}x${a.dimensions.height}`}),(0,i.jsx)(e.Detail.Metadata.Separator,{}),(0,i.jsx)(e.Detail.Metadata.Label,{title:"Size",text:b(a.size)}),(0,i.jsx)(e.Detail.Metadata.Separator,{}),(0,i.jsx)(e.Detail.Metadata.TagList,{title:"Actions",children:(0,i.jsx)(e.Detail.Metadata.TagList.Item,{text:"Copy Base64",color:"#32D74B"})})]})}):(0,i.jsx)(e.Form,{actions:(0,i.jsx)(e.ActionPanel,{children:(0,i.jsx)(e.Action.SubmitForm,{title:"Convert to Base64",onSubmit:t})}),children:(0,i.jsx)(e.Form.FilePicker,{id:"filePath",title:"Select Image",allowMultipleSelection:!1,canChooseDirectories:!1})})}
