"use strict";var Ke=Object.create;var G=Object.defineProperty;var Be=Object.getOwnPropertyDescriptor;var Ge=Object.getOwnPropertyNames;var He=Object.getPrototypeOf,Je=Object.prototype.hasOwnProperty;var Ze=(r,t)=>{for(var e in t)G(r,e,{get:t[e],enumerable:!0})},pe=(r,t,e,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of Ge(t))!Je.call(r,a)&&a!==e&&G(r,a,{get:()=>t[a],enumerable:!(n=Be(t,a))||n.enumerable});return r};var M=(r,t,e)=>(e=r!=null?Ke(He(r)):{},pe(t||!r||!r.__esModule?G(e,"default",{value:r,enumerable:!0}):e,r)),qe=r=>pe(G({},"__esModule",{value:!0}),r);var At={};Ze(At,{default:()=>Fe});module.exports=qe(At);var l=M(require("react")),m=require("@raycast/api");var me=Object.prototype.hasOwnProperty;function H(r,t){var e,n;if(r===t)return!0;if(r&&t&&(e=r.constructor)===t.constructor){if(e===Date)return r.getTime()===t.getTime();if(e===RegExp)return r.toString()===t.toString();if(e===Array){if((n=r.length)===t.length)for(;n--&&H(r[n],t[n]););return n===-1}if(!e||typeof r=="object"){n=0;for(e in r)if(me.call(r,e)&&++n&&!me.call(t,e)||!(e in t)||!H(r[e],t[e]))return!1;return Object.keys(t).length===n}}return r!==r&&t!==t}var U=M(require("node:fs")),q=M(require("node:path")),xe=M(require("node:crypto")),ve=M(require("node:child_process")),Se=require("node:buffer"),D=M(require("node:stream")),Ee=require("node:util");var Ae=require("react/jsx-runtime");var ne=globalThis;function Ye(r){let t=(0,l.useRef)(r),e=(0,l.useRef)(0);return H(r,t.current)||(t.current=r,e.current+=1),(0,l.useMemo)(()=>t.current,[e.current])}function S(r){let t=(0,l.useRef)(r);return t.current=r,t}function ue(r,t){let e=r instanceof Error?r.message:String(r);return(0,m.showToast)({style:m.Toast.Style.Failure,title:t?.title??"Something went wrong",message:t?.message??e,primaryAction:t?.primaryAction??ge(r),secondaryAction:t?.primaryAction?ge(r):void 0})}var ge=r=>{let t=!0,e="[Extension Name]...",n="";try{let s=JSON.parse((0,U.readFileSync)((0,q.join)(m.environment.assetsPath,"..","package.json"),"utf8"));e=`[${s.title}]...`,n=`https://raycast.com/${s.owner||s.author}/${s.name}`,(!s.owner||s.access==="public")&&(t=!1)}catch{}let a=m.environment.isDevelopment||t,i=r instanceof Error?r?.stack||r?.message||"":String(r);return{title:a?"Copy Logs":"Report Error",onAction(s){s.hide(),a?m.Clipboard.copy(i):(0,m.open)(`https://github.com/raycast/extensions/issues/new?&labels=extension%2Cbug&template=extension_bug_report.yml&title=${encodeURIComponent(e)}&extension-url=${encodeURI(n)}&description=${encodeURIComponent(`#### Error:
\`\`\`
${i}
\`\`\`
`)}`)}}};function fe(r,t,e){let n=(0,l.useRef)(0),[a,i]=(0,l.useState)({isLoading:!0}),s=S(r),c=S(e?.abortable),o=S(t||[]),u=S(e?.onError),d=S(e?.onData),f=S(e?.onWillExecute),g=S(e?.failureToastOptions),w=S(a.data),$=(0,l.useRef)(null),h=(0,l.useRef)({page:0}),y=(0,l.useRef)(!1),v=(0,l.useRef)(!0),A=(0,l.useRef)(50),k=(0,l.useCallback)(()=>(c.current&&(c.current.current?.abort(),c.current.current=new AbortController),++n.current),[c]),b=(0,l.useCallback)((...C)=>{let E=k();f.current?.(C),i(p=>({...p,isLoading:!0}));let L=Xe(s.current)(...C);function O(p){return p.name=="AbortError"||E===n.current&&(u.current?u.current(p):m.environment.launchType!==m.LaunchType.Background&&ue(p,{title:"Failed to fetch latest data",primaryAction:{title:"Retry",onAction(P){P.hide(),$.current?.(...o.current||[])}},...g.current}),i({error:p,isLoading:!1})),p}return typeof L=="function"?(y.current=!0,L(h.current).then(({data:p,hasMore:P,cursor:Ne})=>(E===n.current&&(h.current&&(h.current.cursor=Ne,h.current.lastItem=p?.[p.length-1]),d.current&&d.current(p,h.current),P&&(A.current=p.length),v.current=P,i(je=>h.current.page===0?{data:p,isLoading:!1}:{data:(je.data||[])?.concat(p),isLoading:!1})),p),p=>(v.current=!1,O(p)))):(y.current=!1,L.then(p=>(E===n.current&&(d.current&&d.current(p),i({data:p,isLoading:!1})),p),O))},[d,u,o,s,i,$,f,h,g,k]);$.current=b;let I=(0,l.useCallback)(()=>{h.current={page:0};let C=o.current||[];return b(...C)},[b,o]),R=(0,l.useCallback)(async(C,E)=>{let L;try{if(E?.optimisticUpdate){k(),typeof E?.rollbackOnError!="function"&&E?.rollbackOnError!==!1&&(L=structuredClone(w.current?.value));let O=E.optimisticUpdate;i(p=>({...p,data:O(p.data)}))}return await C}catch(O){if(typeof E?.rollbackOnError=="function"){let p=E.rollbackOnError;i(P=>({...P,data:p(P.data)}))}else E?.optimisticUpdate&&E?.rollbackOnError!==!1&&i(p=>({...p,data:L}));throw O}finally{E?.shouldRevalidateAfter!==!1&&(m.environment.launchType===m.LaunchType.Background||m.environment.commandMode==="menu-bar"?await I():I())}},[I,w,i,k]),T=(0,l.useCallback)(()=>{h.current.page+=1;let C=o.current||[];b(...C)},[h,o,b]);(0,l.useEffect)(()=>{h.current={page:0},e?.execute!==!1?b(...t||[]):k()},[Ye([t,e?.execute,b]),c,h]),(0,l.useEffect)(()=>()=>{k()},[k]);let z=e?.execute!==!1?a.isLoading:!1,N={...a,isLoading:z},B=y.current?{pageSize:A.current,hasMore:v.current,onLoadMore:T}:void 0;return{...N,revalidate:I,mutate:R,pagination:B}}function Xe(r){return r===Promise.all||r===Promise.race||r===Promise.resolve||r===Promise.reject?r.bind(Promise):r}function be(r){return typeof r!="function"?!1:/^function\s+\w*\s*\(\s*\)\s*{\s+\[native code\]\s+}$/i.exec(Function.prototype.toString.call(r))!==null}function Qe(r){return r instanceof URLSearchParams?r.toString():r}function Ie(r,t=[]){function e(n){return"update"in r?r.update(n,"utf8"):r.write(n)}return{dispatch:function(n){n=Qe(n),n===null?this._null():this["_"+typeof n](n)},_object:function(n){let a=/\[object (.*)\]/i,i=Object.prototype.toString.call(n),s=a.exec(i)?.[1]??"unknown:["+i+"]";s=s.toLowerCase();let c=null;if((c=t.indexOf(n))>=0){this.dispatch("[CIRCULAR:"+c+"]");return}else t.push(n);if(Buffer.isBuffer(n))return e("buffer:"),e(n.toString("utf8"));if(s!=="object"&&s!=="function"&&s!=="asyncfunction")if(this["_"+s])this["_"+s](n);else throw new Error('Unknown object type "'+s+'"');else{let o=Object.keys(n);o=o.sort(),be(n)||o.splice(0,0,"prototype","__proto__","constructor"),e("object:"+o.length+":");let u=this;return o.forEach(function(d){u.dispatch(d),e(":"),u.dispatch(n[d]),e(",")})}},_array:function(n,a){a=typeof a<"u"?a:!1;let i=this;if(e("array:"+n.length+":"),!a||n.length<=1){n.forEach(function(o){i.dispatch(o)});return}let s=[],c=n.map(function(o){let u=et(),d=t.slice();return Ie(u,d).dispatch(o),s=s.concat(d.slice(t.length)),u.read().toString()});t=t.concat(s),c.sort(),this._array(c,!1)},_date:function(n){e("date:"+n.toJSON())},_symbol:function(n){e("symbol:"+n.toString())},_error:function(n){e("error:"+n.toString())},_boolean:function(n){e("bool:"+n.toString())},_string:function(n){e("string:"+n.length+":"),e(n.toString())},_function:function(n){e("fn:"),be(n)?this.dispatch("[native]"):this.dispatch(n.toString()),this.dispatch("function-name:"+String(n.name)),this._object(n)},_number:function(n){e("number:"+n.toString())},_xml:function(n){e("xml:"+n.toString())},_null:function(){e("Null")},_undefined:function(){e("Undefined")},_regexp:function(n){e("regex:"+n.toString())},_uint8array:function(n){e("uint8array:"),this.dispatch(Array.prototype.slice.call(n))},_uint8clampedarray:function(n){e("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(n))},_int8array:function(n){e("int8array:"),this.dispatch(Array.prototype.slice.call(n))},_uint16array:function(n){e("uint16array:"),this.dispatch(Array.prototype.slice.call(n))},_int16array:function(n){e("int16array:"),this.dispatch(Array.prototype.slice.call(n))},_uint32array:function(n){e("uint32array:"),this.dispatch(Array.prototype.slice.call(n))},_int32array:function(n){e("int32array:"),this.dispatch(Array.prototype.slice.call(n))},_float32array:function(n){e("float32array:"),this.dispatch(Array.prototype.slice.call(n))},_float64array:function(n){e("float64array:"),this.dispatch(Array.prototype.slice.call(n))},_arraybuffer:function(n){e("arraybuffer:"),this.dispatch(new Uint8Array(n))},_url:function(n){e("url:"+n.toString())},_map:function(n){e("map:");let a=Array.from(n);this._array(a,!0)},_set:function(n){e("set:");let a=Array.from(n);this._array(a,!0)},_file:function(n){e("file:"),this.dispatch([n.name,n.size,n.type,n.lastModified])},_blob:function(){throw Error(`Hashing Blob objects is currently not supported
(see https://github.com/puleos/object-hash/issues/26)
Use "options.replacer" or "options.ignoreUnknown"
`)},_domwindow:function(){e("domwindow")},_bigint:function(n){e("bigint:"+n.toString())},_process:function(){e("process")},_timer:function(){e("timer")},_pipe:function(){e("pipe")},_tcp:function(){e("tcp")},_udp:function(){e("udp")},_tty:function(){e("tty")},_statwatcher:function(){e("statwatcher")},_securecontext:function(){e("securecontext")},_connection:function(){e("connection")},_zlib:function(){e("zlib")},_context:function(){e("context")},_nodescript:function(){e("nodescript")},_httpparser:function(){e("httpparser")},_dataview:function(){e("dataview")},_signal:function(){e("signal")},_fsevent:function(){e("fsevent")},_tlswrap:function(){e("tlswrap")}}}function et(){return{buf:"",write:function(r){this.buf+=r},end:function(r){this.buf+=r},read:function(){return this.buf}}}function tt(r,t){let e=this[r];return e instanceof Date?`__raycast_cached_date__${e.toISOString()}`:Buffer.isBuffer(e)?`__raycast_cached_buffer__${e.toString("base64")}`:t}function rt(r,t){return typeof t=="string"&&t.startsWith("__raycast_cached_date__")?new Date(t.replace("__raycast_cached_date__","")):typeof t=="string"&&t.startsWith("__raycast_cached_buffer__")?Buffer.from(t.replace("__raycast_cached_buffer__",""),"base64"):t}function Z(r){let t=xe.default.createHash("sha1");return Ie(t).dispatch(r),t.digest("hex")}var nt=Symbol("cache without namespace"),ye=new Map;function at(r,t,e){let n=e?.cacheNamespace||nt,a=ye.get(n)||ye.set(n,new m.Cache({namespace:e?.cacheNamespace})).get(n);if(!a)throw new Error("Missing cache");let i=S(r),s=S(t),c=(0,l.useSyncExternalStore)(a.subscribe,()=>{try{return a.get(i.current)}catch(f){console.error("Could not get Cache data:",f);return}}),o=(0,l.useMemo)(()=>{if(typeof c<"u"){if(c==="undefined")return;try{return JSON.parse(c,rt)}catch(f){return console.warn("The cached data is corrupted",f),s.current}}else return s.current},[c,s]),u=S(o),d=(0,l.useCallback)(f=>{let g=typeof f=="function"?f(u.current):f;if(typeof g>"u")a.set(i.current,"undefined");else{let w=JSON.stringify(g,tt);a.set(i.current,w)}return g},[a,i,u]);return[o,d]}var V=Symbol();function st(r,t,e){let{initialData:n,keepPreviousData:a,internal_cacheKeySuffix:i,...s}=e||{},c=(0,l.useRef)(null),[o,u]=at(Z(t||[])+i,V,{cacheNamespace:Z(r)}),d=(0,l.useRef)(o!==V?o:n),f=(0,l.useRef)(void 0),{mutate:g,revalidate:w,...$}=fe(r,t||[],{...s,onData(k,b){f.current=b,s.onData&&s.onData(k,b),!(b&&b.page>0)&&(c.current="promise",d.current=k,u(k))}}),h,y=$.pagination;f.current&&f.current.page>0&&$.data?h=$.data:c.current==="promise"?h=d.current:a&&o!==V?(h=o,y&&(y.hasMore=!0,y.pageSize=o.length)):a&&o===V?h=d.current:o!==V?(h=o,y&&(y.hasMore=!0,y.pageSize=o.length)):h=n;let v=S(h),A=(0,l.useCallback)(async(k,b)=>{let I;try{if(b?.optimisticUpdate){typeof b?.rollbackOnError!="function"&&b?.rollbackOnError!==!1&&(I=structuredClone(v.current));let R=b.optimisticUpdate(v.current);c.current="cache",d.current=R,u(R)}return await g(k,{shouldRevalidateAfter:b?.shouldRevalidateAfter})}catch(R){if(typeof b?.rollbackOnError=="function"){let T=b.rollbackOnError(v.current);c.current="cache",d.current=T,u(T)}else b?.optimisticUpdate&&b?.rollbackOnError!==!1&&(c.current="cache",d.current=I,u(I));throw R}},[u,g,v,d,c]);return(0,l.useEffect)(()=>{o!==V&&(c.current="cache",d.current=o)},[o]),{data:h,isLoading:$.isLoading,error:$.error,mutate:f.current&&f.current.page>0?g:A,pagination:y,revalidate:w}}function it(r){if(r){let t=ct(r);if(!t)return!1;if(t.subtype==="json"||t.suffix==="json"||t.suffix&&/\bjson\b/i.test(t.suffix)||t.subtype&&/\bjson\b/i.test(t.subtype))return!0}return!1}var ot=/^([A-Za-z0-9][A-Za-z0-9!#$&^_-]{0,126})\/([A-Za-z0-9][A-Za-z0-9!#$&^_.+-]{0,126});?$/;function ct(r){let t=r.indexOf(";"),e=t!==-1?r.slice(0,t).trim():r.trim(),n=ot.exec(e.toLowerCase().toLowerCase());if(!n)return;let a=n[1],i=n[2],s,c=i.lastIndexOf("+");return c!==-1&&(s=i.substring(c+1),i=i.substring(0,c)),{type:a,subtype:i,suffix:s}}async function lt(r){if(!r.ok)throw new Error(r.statusText);let t=r.headers.get("content-type");return t&&it(t)?await r.json():await r.text()}function ut(r){return{data:r,hasMore:!1}}function W(r,t){let{parseResponse:e,mapResult:n,initialData:a,execute:i,keepPreviousData:s,onError:c,onData:o,onWillExecute:u,failureToastOptions:d,...f}=t||{},g={initialData:a,execute:i,keepPreviousData:s,onError:c,onData:o,onWillExecute:u,failureToastOptions:d},w=S(e||lt),$=S(n||ut),h=(0,l.useRef)(null),y=(0,l.useRef)(null),v=typeof r=="function"?r({page:0}):void 0;(!h.current||typeof y.current>"u"||y.current!==v)&&(h.current=r),y.current=v;let A=(0,l.useRef)(null),k=(0,l.useCallback)((R,T)=>async z=>{let N=await fetch(R(z),{signal:A.current?.signal,...T}),B=await w.current(N);return $.current?.(B)},[w,$]),b=(0,l.useCallback)(async(R,T)=>{let z=await fetch(R,{signal:A.current?.signal,...T}),N=await w.current(z);return $.current(N)?.data},[w,$]),I=(0,l.useMemo)(()=>y.current?k:b,[y,b,k]);return st(I,[h.current,f],{...g,internal_cacheKeySuffix:y.current+Z($.current)+Z(w.current),abortable:A})}var J=r=>!!r&&typeof r=="object"&&typeof r.removeListener=="function"&&typeof r.emit=="function"&&typeof r.reallyExit=="function"&&typeof r.listeners=="function"&&typeof r.kill=="function"&&typeof r.pid=="number"&&typeof r.on=="function",ae=Symbol.for("signal-exit emitter"),ie=class{constructor(){if(this.emitted={afterExit:!1,exit:!1},this.listeners={afterExit:[],exit:[]},this.count=0,this.id=Math.random(),ne[ae])return ne[ae];Object.defineProperty(ne,ae,{value:this,writable:!1,enumerable:!1,configurable:!1})}on(t,e){this.listeners[t].push(e)}removeListener(t,e){let n=this.listeners[t],a=n.indexOf(e);a!==-1&&(a===0&&n.length===1?n.length=0:n.splice(a,1))}emit(t,e,n){if(this.emitted[t])return!1;this.emitted[t]=!0;let a=!1;for(let i of this.listeners[t])a=i(e,n)===!0||a;return t==="exit"&&(a=this.emit("afterExit",e,n)||a),a}},oe=class{onExit(){return()=>{}}load(){}unload(){}},ce=class{#o;#t;#e;#s;#i;#a;#n;#r;constructor(t){this.#o=process.platform==="win32"?"SIGINT":"SIGHUP",this.#t=new ie,this.#a={},this.#n=!1,this.#r=[],this.#r.push("SIGHUP","SIGINT","SIGTERM"),globalThis.process.platform!=="win32"&&this.#r.push("SIGALRM","SIGABRT","SIGVTALRM","SIGXCPU","SIGXFSZ","SIGUSR2","SIGTRAP","SIGSYS","SIGQUIT","SIGIOT"),globalThis.process.platform==="linux"&&this.#r.push("SIGIO","SIGPOLL","SIGPWR","SIGSTKFLT"),this.#e=t,this.#a={};for(let e of this.#r)this.#a[e]=()=>{let n=this.#e.listeners(e),{count:a}=this.#t,i=t;if(typeof i.__signal_exit_emitter__=="object"&&typeof i.__signal_exit_emitter__.count=="number"&&(a+=i.__signal_exit_emitter__.count),n.length===a){this.unload();let s=this.#t.emit("exit",null,e),c=e==="SIGHUP"?this.#o:e;s||t.kill(t.pid,c)}};this.#i=t.reallyExit,this.#s=t.emit}onExit(t,e){if(!J(this.#e))return()=>{};this.#n===!1&&this.load();let n=e?.alwaysLast?"afterExit":"exit";return this.#t.on(n,t),()=>{this.#t.removeListener(n,t),this.#t.listeners.exit.length===0&&this.#t.listeners.afterExit.length===0&&this.unload()}}load(){if(!this.#n){this.#n=!0,this.#t.count+=1;for(let t of this.#r)try{let e=this.#a[t];e&&this.#e.on(t,e)}catch{}this.#e.emit=(t,...e)=>this.#l(t,...e),this.#e.reallyExit=t=>this.#c(t)}}unload(){this.#n&&(this.#n=!1,this.#r.forEach(t=>{let e=this.#a[t];if(!e)throw new Error("Listener not defined for signal: "+t);try{this.#e.removeListener(t,e)}catch{}}),this.#e.emit=this.#s,this.#e.reallyExit=this.#i,this.#t.count-=1)}#c(t){return J(this.#e)?(this.#e.exitCode=t||0,this.#t.emit("exit",this.#e.exitCode,null),this.#i.call(this.#e,this.#e.exitCode)):0}#l(t,...e){let n=this.#s;if(t==="exit"&&J(this.#e)){typeof e[0]=="number"&&(this.#e.exitCode=e[0]);let a=n.call(this.#e,t,...e);return this.#t.emit("exit",this.#e.exitCode,null),a}else return n.call(this.#e,t,...e)}},se=null,ft=(r,t)=>(se||(se=J(process)?new ce(process):new oe),se.onExit(r,t));function dt(r,{timeout:t}={}){let e=new Promise((c,o)=>{r.on("exit",(u,d)=>{c({exitCode:u,signal:d,timedOut:!1})}),r.on("error",u=>{o(u)}),r.stdin&&r.stdin.on("error",u=>{o(u)})}),n=ft(()=>{r.kill()});if(t===0||t===void 0)return e.finally(()=>n());let a,i=new Promise((c,o)=>{a=setTimeout(()=>{r.kill("SIGTERM"),o(Object.assign(new Error("Timed out"),{timedOut:!0,signal:"SIGTERM"}))},t)}),s=e.finally(()=>{clearTimeout(a)});return Promise.race([i,s]).finally(()=>n())}var le=class extends Error{constructor(){super("The output is too big"),this.name="MaxBufferError"}};function ht(r){let{encoding:t}=r,e=t==="buffer",n=new D.default.PassThrough({objectMode:!1});t&&t!=="buffer"&&n.setEncoding(t);let a=0,i=[];return n.on("data",s=>{i.push(s),a+=s.length}),n.getBufferedValue=()=>e?Buffer.concat(i,a):i.join(""),n.getBufferedLength=()=>a,n}async function $e(r,t){let e=ht(t);return await new Promise((n,a)=>{let i=s=>{s&&e.getBufferedLength()<=Se.constants.MAX_LENGTH&&(s.bufferedData=e.getBufferedValue()),a(s)};(async()=>{try{await(0,Ee.promisify)(D.default.pipeline)(r,e),n()}catch(s){i(s)}})(),e.on("data",()=>{e.getBufferedLength()>8e7&&i(new le)})}),e.getBufferedValue()}async function we(r,t){r.destroy();try{return await t}catch(e){return e.bufferedData}}async function pt({stdout:r,stderr:t},{encoding:e},n){let a=$e(r,{encoding:e}),i=$e(t,{encoding:e});try{return await Promise.all([n,a,i])}catch(s){return Promise.all([{error:s,exitCode:null,signal:s.signal,timedOut:s.timedOut||!1},we(r,a),we(t,i)])}}function mt(r){let t=typeof r=="string"?`
`:10,e=typeof r=="string"?"\r":13;return r[r.length-1]===t&&(r=r.slice(0,-1)),r[r.length-1]===e&&(r=r.slice(0,-1)),r}function ke(r,t){return r.stripFinalNewline?mt(t):t}function gt({timedOut:r,timeout:t,signal:e,exitCode:n}){return r?`timed out after ${t} milliseconds`:e!=null?`was killed with ${e}`:n!=null?`failed with exit code ${n}`:"failed"}function bt({stdout:r,stderr:t,error:e,signal:n,exitCode:a,command:i,timedOut:s,options:c,parentError:o}){let d=`Command ${gt({timedOut:s,timeout:c?.timeout,signal:n,exitCode:a})}: ${i}`,f=e?`${d}
${e.message}`:d,g=[f,t,r].filter(Boolean).join(`
`);return e?e.originalMessage=e.message:e=o,e.message=g,e.shortMessage=f,e.command=i,e.exitCode=a,e.signal=n,e.stdout=r,e.stderr=t,"bufferedData"in e&&delete e.bufferedData,e}function yt({stdout:r,stderr:t,error:e,exitCode:n,signal:a,timedOut:i,command:s,options:c,parentError:o}){if(e||n!==0||a!==null)throw bt({error:e,exitCode:n,signal:a,stdout:r,stderr:t,command:s,timedOut:i,options:c,parentError:o});return r}async function Re(r,t,e){if(process.platform!=="darwin")throw new Error("AppleScript is only supported on macOS");let{humanReadableOutput:n,language:a,timeout:i,...s}=Array.isArray(t)?e||{}:t||{},c=n!==!1?[]:["-ss"];a==="JavaScript"&&c.push("-l","JavaScript"),Array.isArray(t)&&c.push("-",...t);let o=ve.default.spawn("osascript",c,{...s,env:{PATH:"/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin"}}),u=dt(o,{timeout:i??1e4});o.stdin.end(r);let[{error:d,exitCode:f,signal:g,timedOut:w},$,h]=await pt(o,{encoding:"utf8"},u),y=ke({stripFinalNewline:!0},$),v=ke({stripFinalNewline:!0},h);return yt({stdout:y,stderr:v,error:d,exitCode:f,signal:g,timedOut:w,command:"osascript",options:e,parentError:new Error})}var re=require("react");function F(){return process.platform==="darwin"?"macos":"windows"}var $t=[];function Te(){let r=F(),{isLoading:t,data:e}=W(`https://hotkys.com/data/${r}/apps.json`,{keepPreviousData:!0,failureToastOptions:{title:"Failed to load applications"}});return{isLoading:t,data:e?.apps??$t}}var Pe=require("react");var Ce=new Map([["command down","\u2318"],["control down","\u2303"],["option down","\u2325"],["shift down","\u21E7"]]),de=new Map([["ctrl","control down"],["shift","shift down"],["opt","option down"],["alt","option down"],["cmd","command down"]]);var Y=class{constructor(t){this.keyCodes=t}parseInputShortcuts(t){return t.filter(e=>this.inputAppIsValid(e)).map(e=>({name:e.name,bundleId:e.bundleId,hostname:e.hostname,slug:e.slug,keymaps:e.keymaps.map(n=>({title:n.title,platforms:n.platforms,sections:n.sections.map(a=>({title:a.title,hotkeys:a.shortcuts.map(i=>this.parseSingleShortcut(i))}))}))}))}inputAppIsValid(t){return t.name!==void 0&&t.name.length>0&&t.slug!==void 0&&t.slug.length>0&&t.keymaps!==void 0&&t.keymaps.length>0&&t.keymaps.every(e=>this.inputKeymapIsValid(e))}inputKeymapIsValid(t){return t.title!==void 0&&t.title.length>0&&t.sections!==void 0&&t.sections.length>0&&t.sections.every(e=>this.inputSectionIsValid(e))}inputSectionIsValid(t){return t.title!==void 0&&t.title.length>0&&t.shortcuts!==void 0&&t.shortcuts.length>0&&t.shortcuts.every(e=>this.inputShortcutIsValid(e))}inputShortcutIsValid(t){return t.title!==void 0&&t.title.length>0&&this.shortcutKeyIsValid(t.key)}shortcutKeyIsValid(t){if(t===void 0)return!0;let e=t.split(" ");return e.length>0&&e.every(n=>this.chordIsValid(n))}chordIsValid(t){let e=t.split(/(?<!\+)\+/);if(e.length===0)return!1;let n=e.length;return this.modifiersExist(n,e)&&this.baseShortcutTokenIsValid(e[n-1])}modifiersExist(t,e){for(let n=0;n<t-1;n++)if(!de.has(e[n]))return!1;return!0}baseShortcutTokenIsValid(t){return t in this.keyCodes}parseSingleShortcut(t){let n=t.key?.split(" ")?.map(a=>this.parseChord(a));return{title:t.title,sequence:n??[],comment:t.comment}}parseChord(t){let e=t.split(/(?<!\+)\+/),n=e.length,a=[];for(let s=0;s<n-1;s++){let c=e[s],o=de.get(c);o&&a.push(o)}return{base:e[n-1],modifiers:a}}};function j(){let{isLoading:r,data:t,revalidate:e}=W("https://hotkys.com/data/key-codes.json",{mapResult:n=>({data:Object.fromEntries(n.keyCodes)}),failureToastOptions:{title:"Failed to load key codes"}});return{isLoading:r,data:t,revalidate:e}}function Ue(r){let t=F(),e=j(),{isLoading:n,data:a}=W(`https://hotkys.com/data/${t}/${r}.json`,{execute:!!r,failureToastOptions:{title:"Failed to load shortcuts"}}),i=(0,Pe.useMemo)(()=>{if(!(!a||!e.data))return new Y(e.data).parseInputShortcuts([a])[0]},[a,e.data]);return{isLoading:n||e.isLoading,data:i}}var x=require("@raycast/api");var X=require("@raycast/api"),Q=require("react/jsx-runtime");function _e(r){let{keymaps:t,onKeymapChange:e}=r;return t.length==1?null:(0,Q.jsx)(X.List.Dropdown,{tooltip:"Select Keymap",storeValue:!0,onChange:e,children:(0,Q.jsx)(X.List.Dropdown.Section,{title:"Keymaps",children:t.map(n=>(0,Q.jsx)(X.List.Dropdown.Item,{title:n,value:n},n))})})}var wt=new Map([["left","\u2190"],["right","\u2192"],["up","\u2191"],["down","\u2193"],["pageup","PgUp"],["pagedown","PgDown"],["home","Home"],["end","End"],["space","Space"],["capslock","\u21EA"],["backspace","\u232B"],["tab","\u21E5"],["esc","\u238B"],["enter","\u21A9"],["cmd","\u2318"],["ctrl","\u2303"],["opt","\u2325"],["shift","\u21E7"]]);function kt(r){return wt.get(r)??r.toUpperCase()}function Le(r){let t=[];return r.sequence.forEach((e,n)=>{n>0&&t.push({text:"then"});let a=[];for(let i of e.modifiers){let s=Ce.get(i);s&&a.push(s)}a.push(kt(e.base)),t.push({tag:a.join(" ")})}),t}var ee=require("@raycast/api"),Oe=require("child_process");function xt(r,t,e){let n=JSON.stringify(r),a=JSON.stringify(e);return`(function() {
    const app = Application.currentApplication();
    app.includeStandardAdditions = true;
    const systemEvents = Application("System Events");
    const bundleId = ${n};
    if (bundleId && systemEvents.applicationProcesses.whose({ bundleIdentifier: bundleId }).length > 0) {
      app.doShellScript("open -b " + bundleId);
      delay(${t});
    }
    ${a}.forEach(function(chord) {
      systemEvents.keyCode(chord.keyCode, { using: chord.modifiers });
    });
  })();`}async function Me(r,t,e,n){if(F()!=="macos"){await(0,ee.showToast)({style:ee.Toast.Style.Failure,title:"Shortcut execution is only supported on macOS"});return}let a=e.map(s=>({keyCode:parseInt(n[s.base],10),modifiers:s.modifiers})),i=xt(r??"",t,a);(0,Oe.spawn)("osascript",["-l","JavaScript","-e",i],{detached:!0,stdio:"ignore"}).unref()}var K=require("react"),_=require("react/jsx-runtime");function Ve({application:r,isLoading:t}){let e=j(),n=r?.keymaps.map(f=>f.title)??[],[a,i]=(0,K.useState)([]),[s,c]=(0,K.useState)(!0);(0,K.useEffect)(()=>{r&&(i(r?.keymaps[0].sections??[]),c(!1))},[r]);let o=t??s,u=async(f,g)=>{if(e.data===void 0)return;let w=parseFloat((0,x.getPreferenceValues)().delay);await(0,x.closeMainWindow)({popToRootType:x.PopToRootType.Immediate}),await Me(f.bundleId,w,g.sequence,e.data)};return(0,_.jsx)(x.List,{isLoading:o,searchBarPlaceholder:"Search for shortcuts",searchBarAccessory:(0,_.jsx)(_e,{keymaps:n,onKeymapChange:f=>{i(vt(r?.keymaps??[],f)?.sections??[])}}),navigationTitle:r?.name,children:r&&a.map(f=>(0,_.jsx)(x.List.Section,{title:f.title,children:f.hotkeys.map(g=>{let w=({title:y,sequence:v})=>`${y}-${[v.map(({modifiers:A,base:k})=>`${A.join("")}${k}`)].flat().join("")}`,$=Le(g),h=g.comment?[{text:g.comment,icon:x.Icon.SpeechBubble}]:[];return(0,_.jsx)(x.List.Item,{title:g.title,accessories:[...$,...h],keywords:[f.title],actions:g.sequence.length>0?(0,_.jsx)(x.ActionPanel,{children:(0,_.jsx)(x.Action,{title:"Apply",onAction:()=>u(r,g)})}):void 0},w(g))})},f.title))})}function vt(r,t){return r.find(e=>e.title===t)}var St=`
  const chromium = new Set([
    "com.google.Chrome",
    "com.google.Chrome.beta",
    "com.google.Chrome.canary",
    "com.vivaldi.Vivaldi",
    "com.brave.Browser",
    "com.microsoft.edgemac",
    "com.operasoftware.Opera",
    "org.chromium.Chromium",
  ]);
  const safari = new Set(["com.apple.Safari", "com.apple.SafariTechPreview"]);
  const arc = new Set(["company.thebrowser.Browser"]);

  function getFrontmostChromiumLink(bundleId) {
    const tab = Application(bundleId).windows[0].activeTab();
    return tab.url();
  }

  function getFrontmostSafariLink(bundleId) {
    const tab = Application(bundleId).documents[0];
    return tab.url();
  }

  function getFrontmostArcLink(bundleId) {
    const tab = Application(bundleId).windows[0].activeTab;
    return tab.url();
  }


  function getFrontmostApp() {
    const apps = Application("System Events")
      .applicationProcesses
      .where({ frontmost: true });
    return apps[0].bundleIdentifier();
  }

  function getFrontmostLink() {
    const app = getFrontmostApp();
    if (chromium.has(app)) {
      return getFrontmostChromiumLink(app);
    } else if (safari.has(app)) {
      return getFrontmostSafariLink(app);
    } else if (arc.has(app)) {
      return getFrontmostArcLink(app);
    } else {
      return null;
    }
  }

  function run(argv) {
    return getFrontmostLink();
  }
`;function Et(r){let t=r.match(/^(?:https?:\/\/)?(?:[^@\n]+@)?(?:www\.)?([^:/\n?]+)/im);return t?t[1]:r}async function De(){let r=await Re(St,{language:"JavaScript"});return r&&r!=="null"?Et(r):null}function We(r,t){if(r.startsWith("*.")){let e=r.slice(1);return t.endsWith(e)&&t.length>e.length}return r===t}var te=require("@raycast/api");function he(r){(0,te.closeMainWindow)({clearRootSearch:!0,popToRootType:te.PopToRootType.Immediate}),ue(void 0,{title:r})}var ze=require("react/jsx-runtime");function Fe(){let[r,t]=(0,re.useState)(),{isLoading:e,data:n}=Te(),{isLoading:a,data:i}=Ue(r),{isLoading:s,data:c}=fe(De,[],{failureToastOptions:{title:"Failed to get current web page"}});return(0,re.useEffect)(()=>{if(s||r||e)return;if(!c){he("No current web application found");return}let o=n.find(u=>u.hostname!==void 0&&We(u.hostname,c));if(!o){he(`Shortcuts not available for application ${c}`);return}t(o.slug)},[e,c,r,s,n]),(0,ze.jsx)(Ve,{application:i,isLoading:s||e||a})}
