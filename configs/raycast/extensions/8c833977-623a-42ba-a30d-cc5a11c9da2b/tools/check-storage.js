"use strict";var u=Object.defineProperty;var F=Object.getOwnPropertyDescriptor;var x=Object.getOwnPropertyNames;var j=Object.prototype.hasOwnProperty;var I=(t,r)=>{for(var n in r)u(t,n,{get:r[n],enumerable:!0})},P=(t,r,n,i)=>{if(r&&typeof r=="object"||typeof r=="function")for(let o of x(r))!j.call(t,o)&&o!==n&&u(t,o,{get:()=>r[o],enumerable:!(i=F(r,o))||i.enumerable});return t};var E=t=>P(u({},"__esModule",{value:!0}),t);var N={};I(N,{default:()=>y});module.exports=E(N);var g=require("@raycast/api"),p=require("path"),w=require("fs/promises"),S=require("child_process");async function J(t,...r){if(process.platform==="win32")return Promise.reject(new Error("Swift functions are not supported on Windows"));let n=(0,p.join)(g.environment.assetsPath,"compiled_raycast_swift/swift");return await(0,w.chmod)(n,"755"),new Promise((i,o)=>{let l=[t];for(let s of r)try{l.push(JSON.stringify(s,(e,a)=>a===void 0?null:a))}catch(e){o(new m("Failed to serialize input to JSON: "+e.message));return}let c=(0,S.spawn)(n,l),d=[],f=[];c.stdout?.on("data",s=>{d.push(s.toString())}),c.stderr?.on("data",s=>{f.push(s.toString())}),c.on("exit",s=>{if(s===0)try{let e=d.join("").trim();e.length!=0?i(JSON.parse(e)):i(null)}catch(e){let a=new m("Failed to deserialize result from JSON: "+e.message);a.stdout=d.join("").trim(),a.stderr=f.join("").trim(),o(a)}else{let e=new m(f.join("").trim()||d.join("").trim()||"Could not get any data");e.stdout=d.join("").trim(),e.stderr=f.join("").trim(),o(e)}}),c.on("error",s=>{o(s)})})}async function h(){return await J("getStorageInfo")}var m=class extends Error{constructor(r){super(r),this.name="SwiftError"}};async function y(){try{let t=await h(),r=t.total.toFixed(2)+" GB",n=t.used.toFixed(2)+" GB",i=t.free.toFixed(2)+" GB",o=(t.used/t.total*100).toFixed(2)+"%";return{total:r,used:n,free:i,percentUsed:o,summary:`${n} used of ${r} (${i} available)`}}catch(t){throw new Error(`Failed to retrieve storage information: ${t instanceof Error?t.message:String(t)}`)}}
