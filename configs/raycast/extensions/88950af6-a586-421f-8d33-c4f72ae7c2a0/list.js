"use strict";var ae=Object.create;var V=Object.defineProperty;var se=Object.getOwnPropertyDescriptor;var ie=Object.getOwnPropertyNames;var oe=Object.getPrototypeOf,ce=Object.prototype.hasOwnProperty;var le=(t,n)=>{for(var r in n)V(t,r,{get:n[r],enumerable:!0})},G=(t,n,r,e)=>{if(n&&typeof n=="object"||typeof n=="function")for(let a of ie(n))!ce.call(t,a)&&a!==r&&V(t,a,{get:()=>n[a],enumerable:!(e=se(n,a))||e.enumerable});return t};var N=(t,n,r)=>(r=t!=null?ae(oe(t)):{},G(n||!t||!t.__esModule?V(r,"default",{value:t,enumerable:!0}):r,t)),ue=t=>G(V({},"__esModule",{value:!0}),t);var Re={};le(Re,{default:()=>te});module.exports=ue(Re);var x=require("@raycast/api");var i=N(require("react")),f=require("@raycast/api");var K=Object.prototype.hasOwnProperty;function j(t,n){var r,e;if(t===n)return!0;if(t&&n&&(r=t.constructor)===n.constructor){if(r===Date)return t.getTime()===n.getTime();if(r===RegExp)return t.toString()===n.toString();if(r===Array){if((e=t.length)===n.length)for(;e--&&j(t[e],n[e]););return e===-1}if(!r||typeof t=="object"){e=0;for(r in t)if(K.call(t,r)&&++e&&!K.call(n,r)||!(r in n)||!j(t[r],n[r]))return!1;return Object.keys(n).length===e}}return t!==t&&n!==n}var C=N(require("node:fs")),B=N(require("node:path")),q=N(require("node:crypto"));var Y=require("react/jsx-runtime");function fe(t){let n=(0,i.useRef)(t),r=(0,i.useRef)(0);return j(t,n.current)||(n.current=t,r.current+=1),(0,i.useMemo)(()=>n.current,[r.current])}function w(t){let n=(0,i.useRef)(t);return n.current=t,n}function de(t,n){let r=t instanceof Error?t.message:String(t);return(0,f.showToast)({style:f.Toast.Style.Failure,title:n?.title??"Something went wrong",message:n?.message??r,primaryAction:n?.primaryAction??H(t),secondaryAction:n?.primaryAction?H(t):void 0})}var H=t=>{let n=!0,r="[Extension Name]...",e="";try{let s=JSON.parse((0,C.readFileSync)((0,B.join)(f.environment.assetsPath,"..","package.json"),"utf8"));r=`[${s.title}]...`,e=`https://raycast.com/${s.owner||s.author}/${s.name}`,(!s.owner||s.access==="public")&&(n=!1)}catch{}let a=f.environment.isDevelopment||n,o=t instanceof Error?t?.stack||t?.message||"":String(t);return{title:a?"Copy Logs":"Report Error",onAction(s){s.hide(),a?f.Clipboard.copy(o):(0,f.open)(`https://github.com/raycast/extensions/issues/new?&labels=extension%2Cbug&template=extension_bug_report.yml&title=${encodeURIComponent(r)}&extension-url=${encodeURI(e)}&description=${encodeURIComponent(`#### Error:
\`\`\`
${o}
\`\`\`
`)}`)}}};function he(t,n,r){let e=(0,i.useRef)(0),[a,o]=(0,i.useState)({isLoading:!0}),s=w(t),l=w(r?.abortable),c=w(n||[]),m=w(r?.onError),p=w(r?.onData),b=w(r?.onWillExecute),v=w(r?.failureToastOptions),S=w(a.data),y=(0,i.useRef)(null),d=(0,i.useRef)({page:0}),g=(0,i.useRef)(!1),E=(0,i.useRef)(!0),P=(0,i.useRef)(50),$=(0,i.useCallback)(()=>(l.current&&(l.current.current?.abort(),l.current.current=new AbortController),++e.current),[l]),h=(0,i.useCallback)((...U)=>{let k=$();b.current?.(U),o(u=>({...u,isLoading:!0}));let O=pe(s.current)(...U);function L(u){return u.name=="AbortError"||k===e.current&&(m.current?m.current(u):f.environment.launchType!==f.LaunchType.Background&&de(u,{title:"Failed to fetch latest data",primaryAction:{title:"Retry",onAction(I){I.hide(),y.current?.(...c.current||[])}},...v.current}),o({error:u,isLoading:!1})),u}return typeof O=="function"?(g.current=!0,O(d.current).then(({data:u,hasMore:I,cursor:re})=>(k===e.current&&(d.current&&(d.current.cursor=re,d.current.lastItem=u?.[u.length-1]),p.current&&p.current(u,d.current),I&&(P.current=u.length),E.current=I,o(ne=>d.current.page===0?{data:u,isLoading:!1}:{data:(ne.data||[])?.concat(u),isLoading:!1})),u),u=>(E.current=!1,L(u)))):(g.current=!1,O.then(u=>(k===e.current&&(p.current&&p.current(u),o({data:u,isLoading:!1})),u),L))},[p,m,c,s,o,y,b,d,v,$]);y.current=h;let A=(0,i.useCallback)(()=>{d.current={page:0};let U=c.current||[];return h(...U)},[h,c]),R=(0,i.useCallback)(async(U,k)=>{let O;try{if(k?.optimisticUpdate){$(),typeof k?.rollbackOnError!="function"&&k?.rollbackOnError!==!1&&(O=structuredClone(S.current?.value));let L=k.optimisticUpdate;o(u=>({...u,data:L(u.data)}))}return await U}catch(L){if(typeof k?.rollbackOnError=="function"){let u=k.rollbackOnError;o(I=>({...I,data:u(I.data)}))}else k?.optimisticUpdate&&k?.rollbackOnError!==!1&&o(u=>({...u,data:O}));throw L}finally{k?.shouldRevalidateAfter!==!1&&(f.environment.launchType===f.LaunchType.Background||f.environment.commandMode==="menu-bar"?await A():A())}},[A,S,o,$]),_=(0,i.useCallback)(()=>{d.current.page+=1;let U=c.current||[];h(...U)},[d,c,h]);(0,i.useEffect)(()=>{d.current={page:0},r?.execute!==!1?h(...n||[]):$()},[fe([n,r?.execute,h]),l,d]),(0,i.useEffect)(()=>()=>{$()},[$]);let D=r?.execute!==!1?a.isLoading:!1,W={...a,isLoading:D},z=g.current?{pageSize:P.current,hasMore:E.current,onLoadMore:_}:void 0;return{...W,revalidate:A,mutate:R,pagination:z}}function pe(t){return t===Promise.all||t===Promise.race||t===Promise.resolve||t===Promise.reject?t.bind(Promise):t}function J(t){return typeof t!="function"?!1:/^function\s+\w*\s*\(\s*\)\s*{\s+\[native code\]\s+}$/i.exec(Function.prototype.toString.call(t))!==null}function me(t){return t instanceof URLSearchParams?t.toString():t}function X(t,n=[]){function r(e){return"update"in t?t.update(e,"utf8"):t.write(e)}return{dispatch:function(e){e=me(e),e===null?this._null():this["_"+typeof e](e)},_object:function(e){let a=/\[object (.*)\]/i,o=Object.prototype.toString.call(e),s=a.exec(o)?.[1]??"unknown:["+o+"]";s=s.toLowerCase();let l=null;if((l=n.indexOf(e))>=0){this.dispatch("[CIRCULAR:"+l+"]");return}else n.push(e);if(Buffer.isBuffer(e))return r("buffer:"),r(e.toString("utf8"));if(s!=="object"&&s!=="function"&&s!=="asyncfunction")if(this["_"+s])this["_"+s](e);else throw new Error('Unknown object type "'+s+'"');else{let c=Object.keys(e);c=c.sort(),J(e)||c.splice(0,0,"prototype","__proto__","constructor"),r("object:"+c.length+":");let m=this;return c.forEach(function(p){m.dispatch(p),r(":"),m.dispatch(e[p]),r(",")})}},_array:function(e,a){a=typeof a<"u"?a:!1;let o=this;if(r("array:"+e.length+":"),!a||e.length<=1){e.forEach(function(c){o.dispatch(c)});return}let s=[],l=e.map(function(c){let m=be(),p=n.slice();return X(m,p).dispatch(c),s=s.concat(p.slice(n.length)),m.read().toString()});n=n.concat(s),l.sort(),this._array(l,!1)},_date:function(e){r("date:"+e.toJSON())},_symbol:function(e){r("symbol:"+e.toString())},_error:function(e){r("error:"+e.toString())},_boolean:function(e){r("bool:"+e.toString())},_string:function(e){r("string:"+e.length+":"),r(e.toString())},_function:function(e){r("fn:"),J(e)?this.dispatch("[native]"):this.dispatch(e.toString()),this.dispatch("function-name:"+String(e.name)),this._object(e)},_number:function(e){r("number:"+e.toString())},_xml:function(e){r("xml:"+e.toString())},_null:function(){r("Null")},_undefined:function(){r("Undefined")},_regexp:function(e){r("regex:"+e.toString())},_uint8array:function(e){r("uint8array:"),this.dispatch(Array.prototype.slice.call(e))},_uint8clampedarray:function(e){r("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(e))},_int8array:function(e){r("int8array:"),this.dispatch(Array.prototype.slice.call(e))},_uint16array:function(e){r("uint16array:"),this.dispatch(Array.prototype.slice.call(e))},_int16array:function(e){r("int16array:"),this.dispatch(Array.prototype.slice.call(e))},_uint32array:function(e){r("uint32array:"),this.dispatch(Array.prototype.slice.call(e))},_int32array:function(e){r("int32array:"),this.dispatch(Array.prototype.slice.call(e))},_float32array:function(e){r("float32array:"),this.dispatch(Array.prototype.slice.call(e))},_float64array:function(e){r("float64array:"),this.dispatch(Array.prototype.slice.call(e))},_arraybuffer:function(e){r("arraybuffer:"),this.dispatch(new Uint8Array(e))},_url:function(e){r("url:"+e.toString())},_map:function(e){r("map:");let a=Array.from(e);this._array(a,!0)},_set:function(e){r("set:");let a=Array.from(e);this._array(a,!0)},_file:function(e){r("file:"),this.dispatch([e.name,e.size,e.type,e.lastModified])},_blob:function(){throw Error(`Hashing Blob objects is currently not supported
(see https://github.com/puleos/object-hash/issues/26)
Use "options.replacer" or "options.ignoreUnknown"
`)},_domwindow:function(){r("domwindow")},_bigint:function(e){r("bigint:"+e.toString())},_process:function(){r("process")},_timer:function(){r("timer")},_pipe:function(){r("pipe")},_tcp:function(){r("tcp")},_udp:function(){r("udp")},_tty:function(){r("tty")},_statwatcher:function(){r("statwatcher")},_securecontext:function(){r("securecontext")},_connection:function(){r("connection")},_zlib:function(){r("zlib")},_context:function(){r("context")},_nodescript:function(){r("nodescript")},_httpparser:function(){r("httpparser")},_dataview:function(){r("dataview")},_signal:function(){r("signal")},_fsevent:function(){r("fsevent")},_tlswrap:function(){r("tlswrap")}}}function be(){return{buf:"",write:function(t){this.buf+=t},end:function(t){this.buf+=t},read:function(){return this.buf}}}function ge(t,n){let r=this[t];return r instanceof Date?`__raycast_cached_date__${r.toISOString()}`:Buffer.isBuffer(r)?`__raycast_cached_buffer__${r.toString("base64")}`:n}function $e(t,n){return typeof n=="string"&&n.startsWith("__raycast_cached_date__")?new Date(n.replace("__raycast_cached_date__","")):typeof n=="string"&&n.startsWith("__raycast_cached_buffer__")?Buffer.from(n.replace("__raycast_cached_buffer__",""),"base64"):n}function F(t){let n=q.default.createHash("sha1");return X(n).dispatch(t),n.digest("hex")}var ye=Symbol("cache without namespace"),Z=new Map;function we(t,n,r){let e=r?.cacheNamespace||ye,a=Z.get(e)||Z.set(e,new f.Cache({namespace:r?.cacheNamespace})).get(e);if(!a)throw new Error("Missing cache");let o=w(t),s=w(n),l=(0,i.useSyncExternalStore)(a.subscribe,()=>{try{return a.get(o.current)}catch(b){console.error("Could not get Cache data:",b);return}}),c=(0,i.useMemo)(()=>{if(typeof l<"u"){if(l==="undefined")return;try{return JSON.parse(l,$e)}catch(b){return console.warn("The cached data is corrupted",b),s.current}}else return s.current},[l,s]),m=w(c),p=(0,i.useCallback)(b=>{let v=typeof b=="function"?b(m.current):b;if(typeof v>"u")a.set(o.current,"undefined");else{let S=JSON.stringify(v,ge);a.set(o.current,S)}return v},[a,o,m]);return[c,p]}var M=Symbol();function ke(t,n,r){let{initialData:e,keepPreviousData:a,internal_cacheKeySuffix:o,...s}=r||{},l=(0,i.useRef)(null),[c,m]=we(F(n||[])+o,M,{cacheNamespace:F(t)}),p=(0,i.useRef)(c!==M?c:e),b=(0,i.useRef)(void 0),{mutate:v,revalidate:S,...y}=he(t,n||[],{...s,onData($,h){b.current=h,s.onData&&s.onData($,h),!(h&&h.page>0)&&(l.current="promise",p.current=$,m($))}}),d,g=y.pagination;b.current&&b.current.page>0&&y.data?d=y.data:l.current==="promise"?d=p.current:a&&c!==M?(d=c,g&&(g.hasMore=!0,g.pageSize=c.length)):a&&c===M?d=p.current:c!==M?(d=c,g&&(g.hasMore=!0,g.pageSize=c.length)):d=e;let E=w(d),P=(0,i.useCallback)(async($,h)=>{let A;try{if(h?.optimisticUpdate){typeof h?.rollbackOnError!="function"&&h?.rollbackOnError!==!1&&(A=structuredClone(E.current));let R=h.optimisticUpdate(E.current);l.current="cache",p.current=R,m(R)}return await v($,{shouldRevalidateAfter:h?.shouldRevalidateAfter})}catch(R){if(typeof h?.rollbackOnError=="function"){let _=h.rollbackOnError(E.current);l.current="cache",p.current=_,m(_)}else h?.optimisticUpdate&&h?.rollbackOnError!==!1&&(l.current="cache",p.current=A,m(A));throw R}},[m,v,E,p,l]);return(0,i.useEffect)(()=>{c!==M&&(l.current="cache",p.current=c)},[c]),{data:d,isLoading:y.isLoading,error:y.error,mutate:b.current&&b.current.page>0?v:P,pagination:g,revalidate:S}}function xe(t){if(t){let n=Se(t);if(!n)return!1;if(n.subtype==="json"||n.suffix==="json"||n.suffix&&/\bjson\b/i.test(n.suffix)||n.subtype&&/\bjson\b/i.test(n.subtype))return!0}return!1}var ve=/^([A-Za-z0-9][A-Za-z0-9!#$&^_-]{0,126})\/([A-Za-z0-9][A-Za-z0-9!#$&^_.+-]{0,126});?$/;function Se(t){let n=t.indexOf(";"),r=n!==-1?t.slice(0,n).trim():t.trim(),e=ve.exec(r.toLowerCase().toLowerCase());if(!e)return;let a=e[1],o=e[2],s,l=o.lastIndexOf("+");return l!==-1&&(s=o.substring(l+1),o=o.substring(0,l)),{type:a,subtype:o,suffix:s}}async function Ee(t){if(!t.ok)throw new Error(t.statusText);let n=t.headers.get("content-type");return n&&xe(n)?await t.json():await t.text()}function Ae(t){return{data:t,hasMore:!1}}function Q(t,n){let{parseResponse:r,mapResult:e,initialData:a,execute:o,keepPreviousData:s,onError:l,onData:c,onWillExecute:m,failureToastOptions:p,...b}=n||{},v={initialData:a,execute:o,keepPreviousData:s,onError:l,onData:c,onWillExecute:m,failureToastOptions:p},S=w(r||Ee),y=w(e||Ae),d=(0,i.useRef)(null),g=(0,i.useRef)(null),E=typeof t=="function"?t({page:0}):void 0;(!d.current||typeof g.current>"u"||g.current!==E)&&(d.current=t),g.current=E;let P=(0,i.useRef)(null),$=(0,i.useCallback)((R,_)=>async D=>{let W=await fetch(R(D),{signal:P.current?.signal,..._}),z=await S.current(W);return y.current?.(z)},[S,y]),h=(0,i.useCallback)(async(R,_)=>{let D=await fetch(R,{signal:P.current?.signal,..._}),W=await S.current(D);return y.current(W)?.data},[S,y]),A=(0,i.useMemo)(()=>g.current?$:h,[g,h,$]);return ke(A,[d.current,b],{...v,internal_cacheKeySuffix:g.current+F(y.current)+F(S.current),abortable:P})}var ee=({width:t,height:n,id:r},e)=>{let a=t>n?t:n;if(a<=e)return`https://picsum.photos/id/${r}/${t}/${n}`;let o=a/e,s=Math.floor(t/o),l=Math.floor(n/o);return`https://picsum.photos/id/${r}/${s}/${l}`};var T=require("react/jsx-runtime");function te(){let{isLoading:t,data:n,pagination:r}=Q(e=>`https://picsum.photos/v2/list?page=${e.page+1}&limit=100`,{parseResponse:async e=>{let s=e.headers.get("Link")?.includes('rel="next"');return{data:await e.json(),hasMore:s??!1}},keepPreviousData:!0,initialData:[]});return(0,T.jsx)(x.Grid,{isLoading:t,pagination:r,filtering:!1,children:n.map(e=>(0,T.jsx)(x.Grid.Item,{title:e.author,content:ee(e,200),subtitle:`${e.width}x${e.height}`,actions:(0,T.jsxs)(x.ActionPanel,{children:[(0,T.jsx)(x.Action.OpenInBrowser,{title:"Open Original Page",icon:x.Icon.Globe,url:e.url}),(0,T.jsx)(x.Action.OpenInBrowser,{title:"Open Image in Browser",icon:x.Icon.Globe,url:e.download_url}),(0,T.jsx)(x.Action.CopyToClipboard,{title:"Copy Image URL",icon:x.Icon.Clipboard,content:e.download_url})]})},e.id))})}
