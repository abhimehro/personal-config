"use strict";var C=Object.defineProperty;var D=Object.getOwnPropertyDescriptor;var G=Object.getOwnPropertyNames;var q=Object.prototype.hasOwnProperty;var N=(d,e)=>{for(var t in e)C(d,t,{get:e[t],enumerable:!0})},Q=(d,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of G(e))!q.call(d,o)&&o!==t&&C(d,o,{get:()=>e[o],enumerable:!(i=D(e,o))||i.enumerable});return d};var I=d=>Q(C({},"__esModule",{value:!0}),d);var T={};N(T,{default:()=>P});module.exports=I(T);var n=require("@raycast/api"),v=require("react");var x=require("@raycast/api"),k=class d{static key="favorites";static async getEntries(){try{let e=await x.LocalStorage.getItem(d.key);return e?JSON.parse(e.toString()):[]}catch{return[]}}static async addEntry(e,t,i,o,a,r){let g=!0;try{let s=await this.getEntries();await d.exist(e,t,a,r)?g=!0:(s.push({language:e.toLowerCase(),word:t,markdown:i,url:o,entry:a,partOfSpeech:r}),s.sort((p,c)=>p.word.localeCompare(c.word)),x.LocalStorage.setItem(d.key,JSON.stringify(s)))}catch{g=!1}return g}static async removeEntry(e,t,i,o){let a=!0;try{let g=(await this.getEntries()).filter(s=>s.language!==e.toLowerCase()||s.word!==t||s.entry!==i||s.partOfSpeech!==o);x.LocalStorage.setItem(d.key,JSON.stringify(g))}catch{a=!1}return a}static async removeAll(){let e=!0;try{await x.LocalStorage.removeItem(d.key)}catch{e=!1}return e}static async exist(e,t,i,o){return(await this.getEntries()).some(r=>r.language===e.toLowerCase()&&r.word===t&&r.entry===i&&r.partOfSpeech===o)}static async existMultiple(e,t){let i={},o=await this.getEntries();for(let[a,r]of Object.entries(e))r.senses&&r.senses.length&&r.senses.forEach((g,s)=>{let l=`${a}-${s}`,p=o.some(c=>c.language.toLowerCase()===r.language.name.toLowerCase()&&c.word.toLowerCase()===t.toLowerCase()&&c.entry===s&&c.partOfSpeech===a);i[l]=p});return i}},b=k;var j=require("@raycast/api"),L=class d{static cache=new j.Cache;url="https://freedictionaryapi.com/api/v1/entries";urlWord="";language="";word="";languageCode="";wordQuery="";get getURL(){return this.urlWord}get getLanguage(){return this.language}constructor(e,t){this.languageCode=e,this.wordQuery=t}static capitalize(e){return e.slice(0,1).toUpperCase()+e.slice(1).toLowerCase()}async getEntry(){let e={};try{let t=this.checkCache();!t||!Object.keys(t).length?e=await this.fetchEntry():e=t}catch(t){console.error(t),e=await this.fetchEntry()}return e}checkCache(){let e={};try{let t=d.cache.get(`${this.languageCode}-${this.wordQuery}`);if(t){let i=JSON.parse(t);this.language=d.capitalize(i[Object.keys(i)?.[0]]?.language?.name||this.languageCode),this.word=i[Object.keys(i)?.[0]]?.forms[0]?.word||this.wordQuery,e=i}else e={}}catch{e=void 0}return e}async fetchEntry(){let e={};try{let t=await fetch(`${this.url}/${this.languageCode}/${this.wordQuery}`);if(t.ok){let i=await t.json();if(i.entries.length){this.language=d.capitalize(i.entries[0]?.language?.name),this.word=i.word,this.urlWord=i.source.url.replaceAll(" ","%20");let o=this.groupEntries(i);try{d.cache.set(`${this.languageCode}-${this.wordQuery}`,JSON.stringify(o))}catch(a){console.error("Failed to cache dictionary entry:",a)}e=o}}else e=void 0}catch{e=void 0}return e}groupEntries(e){let t={},i="",o="",a="";return e.entries.forEach(r=>{t[r.partOfSpeech]||(t[r.partOfSpeech]={language:r.language,partOfSpeech:r.partOfSpeech,pronunciations:[],forms:[],senses:[]},i=`# ${this.word} (_${r.partOfSpeech}_)
### Definition:
`,o=this.renderPronunciations(r),a=this.renderForms(r)),t[r.partOfSpeech].pronunciations.push(...r.pronunciations),t[r.partOfSpeech].forms.push(...r.forms),r.senses.forEach(g=>{let s={...g,markdown:(i+this.renderSenses(g)+o+a).replaceAll("..",".")};t[r.partOfSpeech].senses.push(s)})}),t}renderPronunciations(e){if(!e.pronunciations||!e.pronunciations.length)return"";let t=`### Pronunciations
`,i={};return e.pronunciations.forEach(o=>{o.tags.length?o.tags.forEach(a=>{i[a]||(i[a]={type:o.type,text:[]}),i[a].text.push(o.text)}):(i["-"]||(i["-"]={type:o.type,text:[]}),i["-"].text.push(o.text))}),Object.entries(i).length?(t+=`| Dialect | Pronunciation | Phonetic System | 
|---|---|---|
`,Object.entries(i).forEach(([o,a])=>{t+=`| ${o} | ${a.text.join(", ")} | ${a.type} |
`}),t+=`

`,t):""}renderForms(e){if(!e.forms||!e.forms.length)return"";let t=`### Forms
`,i=["inflection-template","table-tags","class"],o=["ca","cs","fr","de","el","hu","it","la","pt","ro","ru","sh","es","nl"],a=[];if(o.includes(this.languageCode)){let r=["gerund","participle","infinitive"],g=["indicative","subjunctive-i","subjunctive-ii","subjunctive","imperative"],s=["future-i","future-ii","present","imperfect","preterite","future","conditional","perfect","pluperfect","past perfect","future perfect","conditional perfect"],l=["singular","plural"],p=["first-person","second-person","third-person"],c={};e.forms.forEach(u=>{if(!u.tags.length||u.tags.some(f=>i.includes(f)))return;for(let f of s)if(u.word.includes(f.toLowerCase()))return;for(let f of l)if(u.word.includes(f.toLowerCase()))return;for(let f of p)if(u.word.includes(f.toLowerCase()))return;let y=g.find(f=>u.tags.includes(f))||(r.find(f=>u.tags.includes(f))?"non-finite":"indicative"),m=s.find(f=>u.tags.includes(f))||"",w=l.find(f=>u.tags.includes(f))||"",E=p.find(f=>u.tags.includes(f))||"";c[y]||(c[y]={}),c[y][m]||(c[y][m]={}),c[y][m][w]||(c[y][m][w]={}),c[y][m][w][E]||(c[y][m][w][E]=[]),c[y][m][w][E].push(u)}),Object.entries(c).forEach(([u,y])=>{let m=u==="non-finite";t+=`#### ${m?"Non-finite forms":`Mood: ${u}`}
`,m&&(t+=`| Name | Form |
|---|---|
`),Object.entries(y).forEach(([w,E])=>{if(m){if(w&&u!=="imperative")return;Object.entries(E).forEach(([,f])=>{Object.entries(f).forEach(([,O])=>{O.forEach(F=>{let $=`| ${F.tags.join(", ")} | ${F.word} |
`;a.includes($)||(t+=$,a.push($))})})}),a.length=0}else{if(!w&&u!=="imperative")return;t+=`##### Tense: ${u==="imperative"?"present":w}
`,t+=`| Person & Number | Form |
|---|---|
`,Object.entries(E).forEach(([f,O])=>{Object.entries(O).forEach(([F,$])=>{$.forEach(R=>{let A=`| ${F} ${f} | ${R.word} |
`;a.includes(A)||(t+=A,a.push(A))})})}),a.length=0}}),t+=`
`})}else e.forms.forEach(r=>{r.tags.some(g=>i.includes(g))||(t+=`- ${r.word} (${r.tags.join(", ")})
`)});return t+=`

`,t}renderSenses(e){if(!e)return"";let t="",i=(o,a=1)=>{let r="",g="  ".repeat(a);return o.forEach((s,l,p)=>{r+=`${g}${l+1}. ${s.definition}
`,s.synonyms&&s.synonyms.length&&(r+=`${g}   - **Synonyms:** ${s.synonyms.join(", ")}
`),s.antonyms&&s.antonyms.length&&(r+=`${g}   - **Antonyms:** ${s.antonyms.join(", ")}
`),s.examples&&s.examples.length&&(s.examples.length>1?s.examples.forEach((c,u)=>{r+=`${g}   - **Example ${u+1}:** "${c}"
`}):r+=`${g}   - **Example:** "${s.examples[0]}"
`),s.quotes&&s.quotes.length&&(s.quotes.length>1?s.quotes.forEach((c,u)=>{r+=`${g}   - **Quote ${u+1}:** "${c.text}" - _${c.reference}_
`}):r+=`${g}   - **Quote:** "${s.quotes[0].text}" - _${s.quotes[0].reference}_
`),s.subsenses&&s.subsenses.length&&(r+=i(s.subsenses,a+1)),l+1===p.length&&(r+=`
`)}),r};return t+=`${e.definition}
`,e.examples&&e.examples.length&&(e.examples.length>1?e.examples.forEach((o,a)=>{t+=`- **Example ${a+1}:** "${o}"
`}):t+=`- **Example:** "${e.examples[0]}"
`),e.quotes&&e.quotes.length&&(e.quotes.length>1?e.quotes.forEach((o,a)=>{t+=`- **Quote ${a+1}:** "${o.text}" - _${o.reference}_
`}):t+=`- **Quote:** "${e.quotes[0].text}" - _${e.quotes[0].reference}_
`),e.synonyms&&e.synonyms.length&&(t+=`- **Synonyms:** ${e.synonyms.join(", ")}
`),e.antonyms&&e.antonyms.length&&(t+=`- **Antonyms:** ${e.antonyms.join(", ")}
`),e.subsenses&&e.subsenses.length&&(t+=i(e.subsenses,1)),t+=`

`,t}},S=L;var h=require("react/jsx-runtime");function P(){let[d,e]=(0,v.useState)([]),[t,i]=(0,v.useState)(""),[o,a]=(0,v.useState)(!0),[r,g]=(0,v.useState)("All");(0,v.useEffect)(()=>{(async()=>{let p=await b.getEntries();e(p),a(!1)})()},[]);let s=Array.from(new Set(d.map(l=>l.language)));return(0,h.jsx)(n.List,{isLoading:o,searchText:t,onSearchTextChange:i,searchBarPlaceholder:"Filter favorites by word...",filtering:!0,isShowingDetail:!0,searchBarAccessory:(0,h.jsxs)(n.List.Dropdown,{tooltip:"Filter by language",storeValue:!0,onChange:g,defaultValue:"All",children:[(0,h.jsx)(n.List.Dropdown.Item,{title:"All",value:"All"}),s.map(l=>(0,h.jsx)(n.List.Dropdown.Item,{title:S.capitalize(l),value:l},l))]}),children:d.length?Object.entries(d.reduce((l,p)=>(l[p.language]||(l[p.language]=[]),l[p.language].push({word:p.word,markdown:p.markdown,url:p.url,partOfSpeech:p.partOfSpeech,entry:p.entry}),l),{})).filter(([l])=>r==="All"||l===r).sort(([l],[p])=>l.localeCompare(p)).map(([l,p])=>(0,h.jsx)(n.List.Section,{title:S.capitalize(l),children:p.filter(c=>c.word.toLowerCase().includes(t.toLowerCase())).map(c=>(0,h.jsx)(n.List.Item,{title:c.word,detail:(0,h.jsx)(n.List.Item.Detail,{markdown:c.markdown||"No details available."}),actions:(0,h.jsxs)(n.ActionPanel,{children:[(0,h.jsx)(n.Action,{title:"Open in Browser",icon:n.Icon.Globe,shortcut:n.Keyboard.Shortcut.Common.Open,onAction:()=>{let u=c.url;u&&(0,n.open)(u)}}),(0,h.jsxs)(n.ActionPanel.Section,{children:[(0,h.jsx)(n.Action,{title:"Remove from Favorites",icon:n.Icon.StarDisabled,style:n.Action.Style.Destructive,shortcut:n.Keyboard.Shortcut.Common.Remove,onAction:async()=>{let u={title:"Remove from Favorites",message:`"${c.word}" (${S.capitalize(l)}) will be removed from your favorites`,primaryAction:{title:"Delete",style:n.Alert.ActionStyle.Destructive,onAction:async()=>{if(await b.removeEntry(l,c.word,c.entry,c.partOfSpeech)){let m=await b.getEntries();e(m),await(0,n.showToast)({style:n.Toast.Style.Success,title:"Removed from Favorites",message:`"${c.word}" (${S.capitalize(l)}) has been removed from your favorites`})}else await(0,n.showToast)({style:n.Toast.Style.Failure,title:"Failed to remove from Favorites",message:`"${c.word}" (${S.capitalize(l)}) could not be found in your favorites`})}}};await(0,n.confirmAlert)(u)}}),(0,h.jsx)(n.Action,{title:"Remove All Favorites",icon:n.Icon.Trash,style:n.Action.Style.Destructive,shortcut:n.Keyboard.Shortcut.Common.RemoveAll,onAction:async()=>{let u={title:"Remove All Favorites",message:"All favorites will be removed",primaryAction:{title:"Delete",style:n.Alert.ActionStyle.Destructive,onAction:async()=>{if(await b.removeAll()){let m=await b.getEntries();e(m),await(0,n.showToast)({style:n.Toast.Style.Success,title:"Removed from Favorites",message:"All favorites have been removed"})}else await(0,n.showToast)({style:n.Toast.Style.Failure,title:"Failed to remove from Favorites",message:"Could not remove all favorites"})}}};await(0,n.confirmAlert)(u)}})]})]})},`${c.word}-${c.partOfSpeech}-${c.entry}`))},l)):(0,h.jsx)(n.List.EmptyView,{title:"No favorites found"})})}
