"use strict";var Ve=Object.create;var N=Object.defineProperty;var Fe=Object.getOwnPropertyDescriptor;var ze=Object.getOwnPropertyNames;var je=Object.getPrototypeOf,Ke=Object.prototype.hasOwnProperty;var Ge=(e,r)=>{for(var t in r)N(e,t,{get:r[t],enumerable:!0})},oe=(e,r,t,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let a of ze(r))!Ke.call(e,a)&&a!==t&&N(e,a,{get:()=>r[a],enumerable:!(n=Fe(r,a))||n.enumerable});return e};var C=(e,r,t)=>(t=e!=null?Ve(je(e)):{},oe(r||!e||!e.__esModule?N(t,"default",{value:e,enumerable:!0}):t,e)),He=e=>oe(N({},"__esModule",{value:!0}),e);var wt={};Ge(wt,{default:()=>Oe});module.exports=He(wt);var G=require("@raycast/api"),Ie=require("react");var m=require("@raycast/api");var h=C(require("react")),o=require("@raycast/api");var ce=Object.prototype.hasOwnProperty;function B(e,r){var t,n;if(e===r)return!0;if(e&&r&&(t=e.constructor)===r.constructor){if(t===Date)return e.getTime()===r.getTime();if(t===RegExp)return e.toString()===r.toString();if(t===Array){if((n=e.length)===r.length)for(;n--&&B(e[n],r[n]););return n===-1}if(!t||typeof e=="object"){n=0;for(t in e)if(ce.call(e,t)&&++n&&!ce.call(r,t)||!(t in r)||!B(e[t],r[t]))return!1;return Object.keys(r).length===n}}return e!==e&&r!==r}var v=C(require("node:fs")),_=C(require("node:path")),me=C(require("node:crypto")),X=C(require("node:child_process")),ge=require("node:buffer"),U=C(require("node:stream")),be=require("node:util"),w=require("node:fs/promises");var k=require("react/jsx-runtime"),F=C(require("node:os")),ye=require("node:url"),Q=globalThis;function Je(e){let r=(0,h.useRef)(e),t=(0,h.useRef)(0);return B(e,r.current)||(r.current=e,t.current+=1),(0,h.useMemo)(()=>r.current,[t.current])}function S(e){let r=(0,h.useRef)(e);return r.current=e,r}function z(e,r){let t=e instanceof Error?e.message:String(e);return(0,o.showToast)({style:o.Toast.Style.Failure,title:r?.title??"Something went wrong",message:r?.message??t,primaryAction:r?.primaryAction??le(e),secondaryAction:r?.primaryAction?le(e):void 0})}var le=e=>{let r=!0,t="[Extension Name]...",n="";try{let s=JSON.parse((0,v.readFileSync)((0,_.join)(o.environment.assetsPath,"..","package.json"),"utf8"));t=`[${s.title}]...`,n=`https://raycast.com/${s.owner||s.author}/${s.name}`,(!s.owner||s.access==="public")&&(r=!1)}catch{}let a=o.environment.isDevelopment||r,i=e instanceof Error?e?.stack||e?.message||"":String(e);return{title:a?"Copy Logs":"Report Error",onAction(s){s.hide(),a?o.Clipboard.copy(i):(0,o.open)(`https://github.com/raycast/extensions/issues/new?&labels=extension%2Cbug&template=extension_bug_report.yml&title=${encodeURIComponent(t)}&extension-url=${encodeURI(n)}&description=${encodeURIComponent(`#### Error:
\`\`\`
${i}
\`\`\`
`)}`)}}};function ae(e,r,t){let n=(0,h.useRef)(0),[a,i]=(0,h.useState)({isLoading:!0}),s=S(e),u=S(t?.abortable),c=S(r||[]),l=S(t?.onError),f=S(t?.onData),p=S(t?.onWillExecute),g=S(t?.failureToastOptions),x=S(a.data),H=(0,h.useRef)(null),$=(0,h.useRef)({page:0}),J=(0,h.useRef)(!1),Z=(0,h.useRef)(!0),ie=(0,h.useRef)(50),T=(0,h.useCallback)(()=>(u.current&&(u.current.current?.abort(),u.current.current=new AbortController),++n.current),[u]),P=(0,h.useCallback)((...E)=>{let y=T();p.current?.(E),i(d=>({...d,isLoading:!0}));let I=Ze(s.current)(...E);function O(d){return d.name=="AbortError"||y===n.current&&(l.current?l.current(d):o.environment.launchType!==o.LaunchType.Background&&z(d,{title:"Failed to fetch latest data",primaryAction:{title:"Retry",onAction(R){R.hide(),H.current?.(...c.current||[])}},...g.current}),i({error:d,isLoading:!1})),d}return typeof I=="function"?(J.current=!0,I($.current).then(({data:d,hasMore:R,cursor:Be})=>(y===n.current&&($.current&&($.current.cursor=Be,$.current.lastItem=d?.[d.length-1]),f.current&&f.current(d,$.current),R&&(ie.current=d.length),Z.current=R,i(We=>$.current.page===0?{data:d,isLoading:!1}:{data:(We.data||[])?.concat(d),isLoading:!1})),d),d=>(Z.current=!1,O(d)))):(J.current=!1,I.then(d=>(y===n.current&&(f.current&&f.current(d),i({data:d,isLoading:!1})),d),O))},[f,l,c,s,i,H,p,$,g,T]);H.current=P;let M=(0,h.useCallback)(()=>{$.current={page:0};let E=c.current||[];return P(...E)},[P,c]),Ue=(0,h.useCallback)(async(E,y)=>{let I;try{if(y?.optimisticUpdate){T(),typeof y?.rollbackOnError!="function"&&y?.rollbackOnError!==!1&&(I=structuredClone(x.current?.value));let O=y.optimisticUpdate;i(d=>({...d,data:O(d.data)}))}return await E}catch(O){if(typeof y?.rollbackOnError=="function"){let d=y.rollbackOnError;i(R=>({...R,data:d(R.data)}))}else y?.optimisticUpdate&&y?.rollbackOnError!==!1&&i(d=>({...d,data:I}));throw O}finally{y?.shouldRevalidateAfter!==!1&&(o.environment.launchType===o.LaunchType.Background||o.environment.commandMode==="menu-bar"?await M():M())}},[M,x,i,T]),Le=(0,h.useCallback)(()=>{$.current.page+=1;let E=c.current||[];P(...E)},[$,c,P]);(0,h.useEffect)(()=>{$.current={page:0},t?.execute!==!1?P(...r||[]):T()},[Je([r,t?.execute,P]),u,$]),(0,h.useEffect)(()=>()=>{T()},[T]);let De=t?.execute!==!1?a.isLoading:!1,Me={...a,isLoading:De},Ne=J.current?{pageSize:ie.current,hasMore:Z.current,onLoadMore:Le}:void 0;return{...Me,revalidate:M,mutate:Ue,pagination:Ne}}function Ze(e){return e===Promise.all||e===Promise.race||e===Promise.resolve||e===Promise.reject?e.bind(Promise):e}function ue(e){return typeof e!="function"?!1:/^function\s+\w*\s*\(\s*\)\s*{\s+\[native code\]\s+}$/i.exec(Function.prototype.toString.call(e))!==null}function Qe(e){return e instanceof URLSearchParams?e.toString():e}function $e(e,r=[]){function t(n){return"update"in e?e.update(n,"utf8"):e.write(n)}return{dispatch:function(n){n=Qe(n),n===null?this._null():this["_"+typeof n](n)},_object:function(n){let a=/\[object (.*)\]/i,i=Object.prototype.toString.call(n),s=a.exec(i)?.[1]??"unknown:["+i+"]";s=s.toLowerCase();let u=null;if((u=r.indexOf(n))>=0){this.dispatch("[CIRCULAR:"+u+"]");return}else r.push(n);if(Buffer.isBuffer(n))return t("buffer:"),t(n.toString("utf8"));if(s!=="object"&&s!=="function"&&s!=="asyncfunction")if(this["_"+s])this["_"+s](n);else throw new Error('Unknown object type "'+s+'"');else{let c=Object.keys(n);c=c.sort(),ue(n)||c.splice(0,0,"prototype","__proto__","constructor"),t("object:"+c.length+":");let l=this;return c.forEach(function(f){l.dispatch(f),t(":"),l.dispatch(n[f]),t(",")})}},_array:function(n,a){a=typeof a<"u"?a:!1;let i=this;if(t("array:"+n.length+":"),!a||n.length<=1){n.forEach(function(c){i.dispatch(c)});return}let s=[],u=n.map(function(c){let l=Ye(),f=r.slice();return $e(l,f).dispatch(c),s=s.concat(f.slice(r.length)),l.read().toString()});r=r.concat(s),u.sort(),this._array(u,!1)},_date:function(n){t("date:"+n.toJSON())},_symbol:function(n){t("symbol:"+n.toString())},_error:function(n){t("error:"+n.toString())},_boolean:function(n){t("bool:"+n.toString())},_string:function(n){t("string:"+n.length+":"),t(n.toString())},_function:function(n){t("fn:"),ue(n)?this.dispatch("[native]"):this.dispatch(n.toString()),this.dispatch("function-name:"+String(n.name)),this._object(n)},_number:function(n){t("number:"+n.toString())},_xml:function(n){t("xml:"+n.toString())},_null:function(){t("Null")},_undefined:function(){t("Undefined")},_regexp:function(n){t("regex:"+n.toString())},_uint8array:function(n){t("uint8array:"),this.dispatch(Array.prototype.slice.call(n))},_uint8clampedarray:function(n){t("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(n))},_int8array:function(n){t("int8array:"),this.dispatch(Array.prototype.slice.call(n))},_uint16array:function(n){t("uint16array:"),this.dispatch(Array.prototype.slice.call(n))},_int16array:function(n){t("int16array:"),this.dispatch(Array.prototype.slice.call(n))},_uint32array:function(n){t("uint32array:"),this.dispatch(Array.prototype.slice.call(n))},_int32array:function(n){t("int32array:"),this.dispatch(Array.prototype.slice.call(n))},_float32array:function(n){t("float32array:"),this.dispatch(Array.prototype.slice.call(n))},_float64array:function(n){t("float64array:"),this.dispatch(Array.prototype.slice.call(n))},_arraybuffer:function(n){t("arraybuffer:"),this.dispatch(new Uint8Array(n))},_url:function(n){t("url:"+n.toString())},_map:function(n){t("map:");let a=Array.from(n);this._array(a,!0)},_set:function(n){t("set:");let a=Array.from(n);this._array(a,!0)},_file:function(n){t("file:"),this.dispatch([n.name,n.size,n.type,n.lastModified])},_blob:function(){throw Error(`Hashing Blob objects is currently not supported
(see https://github.com/puleos/object-hash/issues/26)
Use "options.replacer" or "options.ignoreUnknown"
`)},_domwindow:function(){t("domwindow")},_bigint:function(n){t("bigint:"+n.toString())},_process:function(){t("process")},_timer:function(){t("timer")},_pipe:function(){t("pipe")},_tcp:function(){t("tcp")},_udp:function(){t("udp")},_tty:function(){t("tty")},_statwatcher:function(){t("statwatcher")},_securecontext:function(){t("securecontext")},_connection:function(){t("connection")},_zlib:function(){t("zlib")},_context:function(){t("context")},_nodescript:function(){t("nodescript")},_httpparser:function(){t("httpparser")},_dataview:function(){t("dataview")},_signal:function(){t("signal")},_fsevent:function(){t("fsevent")},_tlswrap:function(){t("tlswrap")}}}function Ye(){return{buf:"",write:function(e){this.buf+=e},end:function(e){this.buf+=e},read:function(){return this.buf}}}function ke(e){let r=me.default.createHash("sha1");return $e(r).dispatch(e),r.digest("hex")}var W=e=>!!e&&typeof e=="object"&&typeof e.removeListener=="function"&&typeof e.emit=="function"&&typeof e.reallyExit=="function"&&typeof e.listeners=="function"&&typeof e.kill=="function"&&typeof e.pid=="number"&&typeof e.on=="function",Y=Symbol.for("signal-exit emitter"),ee=class{constructor(){if(this.emitted={afterExit:!1,exit:!1},this.listeners={afterExit:[],exit:[]},this.count=0,this.id=Math.random(),Q[Y])return Q[Y];Object.defineProperty(Q,Y,{value:this,writable:!1,enumerable:!1,configurable:!1})}on(r,t){this.listeners[r].push(t)}removeListener(r,t){let n=this.listeners[r],a=n.indexOf(t);a!==-1&&(a===0&&n.length===1?n.length=0:n.splice(a,1))}emit(r,t,n){if(this.emitted[r])return!1;this.emitted[r]=!0;let a=!1;for(let i of this.listeners[r])a=i(t,n)===!0||a;return r==="exit"&&(a=this.emit("afterExit",t,n)||a),a}},te=class{onExit(){return()=>{}}load(){}unload(){}},re=class{#o;#t;#e;#s;#i;#a;#n;#r;constructor(r){this.#o=process.platform==="win32"?"SIGINT":"SIGHUP",this.#t=new ee,this.#a={},this.#n=!1,this.#r=[],this.#r.push("SIGHUP","SIGINT","SIGTERM"),globalThis.process.platform!=="win32"&&this.#r.push("SIGALRM","SIGABRT","SIGVTALRM","SIGXCPU","SIGXFSZ","SIGUSR2","SIGTRAP","SIGSYS","SIGQUIT","SIGIOT"),globalThis.process.platform==="linux"&&this.#r.push("SIGIO","SIGPOLL","SIGPWR","SIGSTKFLT"),this.#e=r,this.#a={};for(let t of this.#r)this.#a[t]=()=>{let n=this.#e.listeners(t),{count:a}=this.#t,i=r;if(typeof i.__signal_exit_emitter__=="object"&&typeof i.__signal_exit_emitter__.count=="number"&&(a+=i.__signal_exit_emitter__.count),n.length===a){this.unload();let s=this.#t.emit("exit",null,t),u=t==="SIGHUP"?this.#o:t;s||r.kill(r.pid,u)}};this.#i=r.reallyExit,this.#s=r.emit}onExit(r,t){if(!W(this.#e))return()=>{};this.#n===!1&&this.load();let n=t?.alwaysLast?"afterExit":"exit";return this.#t.on(n,r),()=>{this.#t.removeListener(n,r),this.#t.listeners.exit.length===0&&this.#t.listeners.afterExit.length===0&&this.unload()}}load(){if(!this.#n){this.#n=!0,this.#t.count+=1;for(let r of this.#r)try{let t=this.#a[r];t&&this.#e.on(r,t)}catch{}this.#e.emit=(r,...t)=>this.#l(r,...t),this.#e.reallyExit=r=>this.#c(r)}}unload(){this.#n&&(this.#n=!1,this.#r.forEach(r=>{let t=this.#a[r];if(!t)throw new Error("Listener not defined for signal: "+r);try{this.#e.removeListener(r,t)}catch{}}),this.#e.emit=this.#s,this.#e.reallyExit=this.#i,this.#t.count-=1)}#c(r){return W(this.#e)?(this.#e.exitCode=r||0,this.#t.emit("exit",this.#e.exitCode,null),this.#i.call(this.#e,this.#e.exitCode)):0}#l(r,...t){let n=this.#s;if(r==="exit"&&W(this.#e)){typeof t[0]=="number"&&(this.#e.exitCode=t[0]);let a=n.call(this.#e,r,...t);return this.#t.emit("exit",this.#e.exitCode,null),a}else return n.call(this.#e,r,...t)}},q=null,qe=(e,r)=>(q||(q=W(process)?new re(process):new te),q.onExit(e,r));function fe(e,{timeout:r}={}){let t=new Promise((u,c)=>{e.on("exit",(l,f)=>{u({exitCode:l,signal:f,timedOut:!1})}),e.on("error",l=>{c(l)}),e.stdin&&e.stdin.on("error",l=>{c(l)})}),n=qe(()=>{e.kill()});if(r===0||r===void 0)return t.finally(()=>n());let a,i=new Promise((u,c)=>{a=setTimeout(()=>{e.kill("SIGTERM"),c(Object.assign(new Error("Timed out"),{timedOut:!0,signal:"SIGTERM"}))},r)}),s=t.finally(()=>{clearTimeout(a)});return Promise.race([i,s]).finally(()=>n())}var ne=class extends Error{constructor(){super("The output is too big"),this.name="MaxBufferError"}};function Xe(e){let{encoding:r}=e,t=r==="buffer",n=new U.default.PassThrough({objectMode:!1});r&&r!=="buffer"&&n.setEncoding(r);let a=0,i=[];return n.on("data",s=>{i.push(s),a+=s.length}),n.getBufferedValue=()=>t?Buffer.concat(i,a):i.join(""),n.getBufferedLength=()=>a,n}async function de(e,r){let t=Xe(r);return await new Promise((n,a)=>{let i=s=>{s&&t.getBufferedLength()<=ge.constants.MAX_LENGTH&&(s.bufferedData=t.getBufferedValue()),a(s)};(async()=>{try{await(0,be.promisify)(U.default.pipeline)(e,t),n()}catch(s){i(s)}})(),t.on("data",()=>{t.getBufferedLength()>8e7&&i(new ne)})}),t.getBufferedValue()}async function he(e,r){e.destroy();try{return await r}catch(t){return t.bufferedData}}async function pe({stdout:e,stderr:r},{encoding:t},n){let a=de(e,{encoding:t}),i=de(r,{encoding:t});try{return await Promise.all([n,a,i])}catch(s){return Promise.all([{error:s,exitCode:null,signal:s.signal,timedOut:s.timedOut||!1},he(e,a),he(r,i)])}}var V=class extends Error{constructor(r){super(r),this.name="PermissionError"}};function et(e){return e instanceof Error&&e.name==="PermissionError"}async function tt(e,r,t){if(!(0,v.existsSync)(e))throw new Error("The database does not exist");let n;try{n=await(l=>import(l))("node:sqlite")}catch{return rt(e,r,t)}let a=new n.DatabaseSync(e,{open:!1,readOnly:!0}),i=t?.signal;try{a.open()}catch(c){if(console.log(c),c.message.match("(5)")||c.message.match("(14)")){let l;if(!l){let f=_.default.join(F.default.tmpdir(),"useSQL",ke(e));await(0,w.mkdir)(f,{recursive:!0}),A(i),l=_.default.join(f,"db.db"),await(0,w.copyFile)(e,l),await(0,w.writeFile)(l+"-shm",""),await(0,w.writeFile)(l+"-wal",""),A(i)}a=new n.DatabaseSync(l,{open:!1,readOnly:!0}),a.open(),A(i)}}let s=a.prepare(r);A(i);let u=s.all();return a.close(),u}async function rt(e,r,t){let n=t?.signal,a=X.default.spawn("sqlite3",["--json","--readonly",e,r],{signal:n}),i=fe(a),[{error:s,exitCode:u,signal:c},l,f]=await pe(a,{encoding:"utf-8"},i);if(A(n),f.match("(5)")||f.match("(14)")){let p;if(!p){let g=_.default.join(F.default.tmpdir(),"useSQL",ke(e));await(0,w.mkdir)(g,{recursive:!0}),A(n),p=_.default.join(g,"db.db"),await(0,w.copyFile)(e,p),await(0,w.writeFile)(p+"-shm",""),await(0,w.writeFile)(p+"-wal",""),A(n)}a=X.default.spawn("sqlite3",["--json","--readonly","--vfs","unix-none",p,r],{signal:n}),i=fe(a),[{error:s,exitCode:u,signal:c},l,f]=await pe(a,{encoding:"utf-8"},i),A(n)}if(s||u!==0||c!==null)throw f.includes("authorization denied")?new V("You do not have permission to access the database."):new Error(f||"Unknown error");return JSON.parse(l.trim()||"[]")}function A(e){if(e?.aborted){let r=new Error("aborted");throw r.name="AbortError",r}}function we(e,r,t){let{permissionPriming:n,...a}=t||{},[i,s]=(0,h.useState)(null),u=S(t||{}),c=(0,h.useRef)(null),l=(0,h.useCallback)(p=>{console.error(p);let g=p instanceof Error&&p.message.includes("authorization denied")?new V("You do not have permission to access the database."):p;et(g)?s((0,k.jsx)(nt,{priming:u.current.permissionPriming})):u.current.onError?u.current.onError(g):o.environment.launchType!==o.LaunchType.Background&&z(g,{title:"Cannot query the data"})},[u]),f=(0,h.useMemo)(()=>{if(!(0,v.existsSync)(e))throw new Error("The database does not exist");return async(p,g)=>{let x=c.current?.signal;return tt(p,g,{signal:x})}},[e]);return{...ae(f,[e,r],{...a,onError:l}),permissionView:i}}function nt(e){let r=parseInt(F.default.release().split(".")[0])>=22,t=r?"Settings":"Preferences",n=r?{title:"Open System Settings -> Privacy",target:"x-apple.systempreferences:com.apple.preference.security?Privacy_AllFiles"}:{title:"Open System Preferences -> Security",target:"x-apple.systempreferences:com.apple.preference.security?Privacy_AllFiles"};return o.environment.commandMode==="menu-bar"?(0,k.jsxs)(o.MenuBarExtra,{icon:o.Icon.Warning,title:o.environment.commandName,children:[(0,k.jsx)(o.MenuBarExtra.Item,{title:"Raycast needs full disk access",tooltip:`You can revert this access in ${t} whenever you want`}),e.priming?(0,k.jsx)(o.MenuBarExtra.Item,{title:e.priming,tooltip:`You can revert this access in ${t} whenever you want`}):null,(0,k.jsx)(o.MenuBarExtra.Separator,{}),(0,k.jsx)(o.MenuBarExtra.Item,{title:n.title,onAction:()=>(0,o.open)(n.target)})]}):(0,k.jsx)(o.List,{children:(0,k.jsx)(o.List.EmptyView,{icon:{source:{light:"https://raycast.com/uploads/extensions-utils-security-permissions-light.png",dark:"https://raycast.com/uploads/extensions-utils-security-permissions-dark.png"}},title:"Raycast needs full disk access.",description:`${e.priming?e.priming+`
`:""}You can revert this access in ${t} whenever you want.`,actions:(0,k.jsx)(o.ActionPanel,{children:(0,k.jsx)(o.Action.Open,{...n})})})})}function se(e,r){try{let t=s=>s.startsWith("http")?s:`https://${s}`,a=(typeof e=="string"?new ye.URL(t(e)):e).hostname;switch(process.env.FAVICON_PROVIDER??"raycast"){case"none":return{source:r?.fallback??o.Icon.Link,mask:r?.mask};case"apple":return{source:r?.fallback??o.Icon.Link,mask:r?.mask};case"duckduckgo":case"duckDuckGo":return{source:`https://icons.duckduckgo.com/ip3/${a}.ico`,fallback:r?.fallback??o.Icon.Link,mask:r?.mask};case"google":return{source:`https://www.google.com/s2/favicons?sz=${r?.size??64}&domain=${a}`,fallback:r?.fallback??o.Icon.Link,mask:r?.mask};case"legacy":case"raycast":default:return{source:`https://api.ray.so/favicon?url=${a}&size=${r?.size??64}`,fallback:r?.fallback??o.Icon.Link,mask:r?.mask}}}catch(t){return console.error(t),o.Icon.Link}}var xe=require("@raycast/api");function Se(e){return e.replace(/\\/g,"\\\\").replace(/%/g,"\\%").replace(/_/g,"\\_").replace(/"/g,'""')}function ve(e){try{let{hostname:r}=new URL(e);return r.replace(/^www\./,"")}catch{return e}}var b=require("react/jsx-runtime");function Ee({item:e,searchText:r,onHistoryAction:t}){return(0,b.jsx)(m.List.Item,{icon:se(e.url,{mask:m.Image.Mask.Circle}),title:e.title??"Untitled",subtitle:{value:ve(e.url),tooltip:e.url},accessories:[{date:new Date(e.lastVisitedAt)}],actions:(0,b.jsxs)(m.ActionPanel,{children:[(0,b.jsxs)(m.ActionPanel.Section,{children:[(0,b.jsx)(m.Action.Open,{icon:m.Icon.Globe,title:"Open Tab",target:e.url,application:"company.thebrowser.dia",onOpen:()=>{t?.()}}),(0,b.jsx)(m.Action.OpenWith,{icon:m.Icon.AppWindow,path:e.url,onOpen:()=>{t?.()}}),r&&(0,b.jsx)(m.Action.OpenInBrowser,{title:"Search Google",url:`https://www.google.com/search?q=${encodeURIComponent(r)}`,icon:m.Icon.MagnifyingGlass,shortcut:{modifiers:["cmd","shift"],key:"return"},onOpen:()=>{t?.()}})]}),(0,b.jsxs)(m.ActionPanel.Section,{children:[(0,b.jsx)(m.Action.CopyToClipboard,{content:e.url,title:"Copy URL",shortcut:m.Keyboard.Shortcut.Common.Copy}),(0,b.jsx)(m.Action.CopyToClipboard,{content:{html:`<a href="${e.url}">${e.title}</a>`},title:"Copy Formatted URL",shortcut:m.Keyboard.Shortcut.Common.CopyPath}),e.title&&(0,b.jsx)(m.Action.CopyToClipboard,{content:e.title,title:"Copy Title",shortcut:m.Keyboard.Shortcut.Common.CopyName}),(0,b.jsx)(m.Action.CopyToClipboard,{content:`[${e.title??"Untitled"}](${e.url})`,title:"Copy as Markdown"})]}),(0,b.jsx)(m.ActionPanel.Section,{children:(0,b.jsx)(m.Action.CreateQuicklink,{quicklink:{link:e.url,name:e.title},shortcut:{modifiers:["cmd"],key:"s"}})})]})})}var L=require("path"),j=require("os"),K=require("fs");function Ae(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function _e(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?Ae(Object(t),!0).forEach(function(n){at(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Ae(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function at(e,r,t){return r=st(r),r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function st(e){var r=it(e,"string");return typeof r=="symbol"?r:String(r)}function it(e,r){if(typeof e!="object"||e===null)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var It=Te({});function Te(e){return r.withOptions=t=>Te(_e(_e({},e),t)),r;function r(t,...n){let a=typeof t=="string"?[t]:t.raw,{alignValues:i=!1,escapeSpecialCharacters:s=Array.isArray(t),trimWhitespace:u=!0}=e,c="";for(let p=0;p<a.length;p++){let g=a[p];if(s&&(g=g.replace(/\\\n[ \t]*/g,"").replace(/\\`/g,"`").replace(/\\\$/g,"$").replace(/\\\{/g,"{")),c+=g,p<n.length){let x=i?ot(n[p],c):n[p];c+=x}}let l=c.split(`
`),f=null;for(let p of l){let g=p.match(/^(\s+)\S+/);if(g){let x=g[1].length;f?f=Math.min(f,x):f=x}}if(f!==null){let p=f;c=l.map(g=>g[0]===" "||g[0]==="	"?g.slice(p):g).join(`
`)}return u&&(c=c.trim()),s&&(c=c.replace(/\\n/g,`
`)),c}}function ot(e,r){if(typeof e!="string"||!e.includes(`
`))return e;let n=r.slice(r.lastIndexOf(`
`)+1).match(/^(\s+)/);if(n){let a=n[1];return e.replace(/\n/g,`
${a}`)}return e}var Re=require("react"),gt=require("@raycast/api");var bt=require("react/jsx-runtime");function yt(){let e=(0,L.resolve)((0,j.homedir)(),"Library/Application Support/Dia/User Data/Local State");try{let r=(0,K.readFileSync)(e,"utf-8"),n=JSON.parse(r).profile.last_used||"Default";return(0,L.resolve)((0,j.homedir)(),`Library/Application Support/Dia/User Data/${n}`)}catch(r){return console.error("Error reading Local State:",r),(0,L.resolve)((0,j.homedir)(),"Library/Application Support/Dia/User Data/Default")}}function $t(){return(0,L.resolve)(yt(),"History")}function kt(e,r=100){let t=e?e.split(" ").filter(n=>n.length>0).map(n=>{let a=Se(n);return`(url LIKE "%${a}%" ESCAPE '\\' OR title LIKE "%${a}%" ESCAPE '\\')`}).join(" AND "):void 0;return`
    SELECT id,
          url,
          title,
          datetime(last_visit_time / 1000000 + (strftime('%s', '1601-01-01')), 'unixepoch', 'localtime') AS lastVisitedAt
    FROM urls
    ${t?`WHERE ${t}`:""}
    GROUP BY url
    ORDER BY last_visit_time DESC
    LIMIT ${r};
  `}function Ce(e,r={}){let t=$t(),n=kt(e,r?.limit),a=(0,K.existsSync)(t),i=we(a?t:__filename,n,{permissionPriming:"This extension needs access to read your Dia browser history.",execute:a});if(!a){let s=new Error("The database does not exist");return z(s),{isLoading:!1,error:s,data:[],permissionView:null,revalidate:()=>{}}}return i}var D=require("react/jsx-runtime");function Oe(){let[e,r]=(0,Ie.useState)(""),{isLoading:t,data:n,permissionView:a,revalidate:i,error:s}=Ce(e);return a||(s?(0,D.jsx)(G.List,{children:(0,D.jsx)(G.List.EmptyView,{title:"Error",description:s.message})}):(0,D.jsx)(G.List,{isLoading:t,searchBarPlaceholder:"Search history...",searchText:e,onSearchTextChange:r,children:n?.map(u=>(0,D.jsx)(Ee,{item:u,onHistoryAction:i},u.id))}))}
