"use strict";var ga=Object.create;var Pr=Object.defineProperty;var ya=Object.getOwnPropertyDescriptor;var Sa=Object.getOwnPropertyNames;var _a=Object.getPrototypeOf,wa=Object.prototype.hasOwnProperty;var Bt=(o,n)=>()=>(o&&(n=o(o=0)),n);var _n=(o,n)=>()=>(n||o((n={exports:{}}).exports,n),n.exports),Ko=(o,n)=>{for(var i in n)Pr(o,i,{get:n[i],enumerable:!0})},Xo=(o,n,i,a)=>{if(n&&typeof n=="object"||typeof n=="function")for(let l of Sa(n))!wa.call(o,l)&&l!==i&&Pr(o,l,{get:()=>n[l],enumerable:!(a=ya(n,l))||a.enumerable});return o};var Le=(o,n,i)=>(i=o!=null?ga(_a(o)):{},Xo(n||!o||!o.__esModule?Pr(i,"default",{value:o,enumerable:!0}):i,o)),Ra=o=>Xo(Pr({},"__esModule",{value:!0}),o);var oi=_n((Ar,ni)=>{(function(o,n){typeof Ar=="object"&&typeof ni<"u"?n(Ar):typeof define=="function"&&define.amd?define(["exports"],n):(o=typeof globalThis<"u"?globalThis:o||self,n(o.WebStreamsPolyfill={}))})(Ar,(function(o){"use strict";let n=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol:e=>`Symbol(${e})`;function i(){}function a(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global}let l=a();function u(e){return typeof e=="object"&&e!==null||typeof e=="function"}let d=i,g=Promise,h=Promise.prototype.then,y=Promise.resolve.bind(g),k=Promise.reject.bind(g);function A(e){return new g(e)}function S(e){return y(e)}function p(e){return k(e)}function b(e,t,r){return h.call(e,t,r)}function C(e,t,r){b(b(e,t,r),void 0,d)}function P(e,t){C(e,t)}function E(e,t){C(e,void 0,t)}function F(e,t,r){return b(e,t,r)}function v(e){b(e,void 0,d)}let w=(()=>{let e=l&&l.queueMicrotask;if(typeof e=="function")return e;let t=S(void 0);return r=>b(t,r)})();function z(e,t,r){if(typeof e!="function")throw new TypeError("Argument is not a function");return Function.prototype.apply.call(e,t,r)}function B(e,t,r){try{return S(z(e,t,r))}catch(s){return p(s)}}let x=16384;class Q{constructor(){this._cursor=0,this._size=0,this._front={_elements:[],_next:void 0},this._back=this._front,this._cursor=0,this._size=0}get length(){return this._size}push(t){let r=this._back,s=r;r._elements.length===x-1&&(s={_elements:[],_next:void 0}),r._elements.push(t),s!==r&&(this._back=s,r._next=s),++this._size}shift(){let t=this._front,r=t,s=this._cursor,f=s+1,c=t._elements,m=c[s];return f===x&&(r=t._next,f=0),--this._size,this._cursor=f,t!==r&&(this._front=r),c[s]=void 0,m}forEach(t){let r=this._cursor,s=this._front,f=s._elements;for(;(r!==f.length||s._next!==void 0)&&!(r===f.length&&(s=s._next,f=s._elements,r=0,f.length===0));)t(f[r]),++r}peek(){let t=this._front,r=this._cursor;return t._elements[r]}}function Ln(e,t){e._ownerReadableStream=t,t._reader=e,t._state==="readable"?jr(e):t._state==="closed"?Vi(e):qn(e,t._storedError)}function Mr(e,t){let r=e._ownerReadableStream;return ce(r,t)}function _e(e){e._ownerReadableStream._state==="readable"?Nr(e,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")):Yi(e,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")),e._ownerReadableStream._reader=void 0,e._ownerReadableStream=void 0}function Ke(e){return new TypeError("Cannot "+e+" a stream using a released reader")}function jr(e){e._closedPromise=A((t,r)=>{e._closedPromise_resolve=t,e._closedPromise_reject=r})}function qn(e,t){jr(e),Nr(e,t)}function Vi(e){jr(e),$n(e)}function Nr(e,t){e._closedPromise_reject!==void 0&&(v(e._closedPromise),e._closedPromise_reject(t),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0)}function Yi(e,t){qn(e,t)}function $n(e){e._closedPromise_resolve!==void 0&&(e._closedPromise_resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0)}let zn=n("[[AbortSteps]]"),Un=n("[[ErrorSteps]]"),Hr=n("[[CancelSteps]]"),xr=n("[[PullSteps]]"),Mn=Number.isFinite||function(e){return typeof e=="number"&&isFinite(e)},Gi=Math.trunc||function(e){return e<0?Math.ceil(e):Math.floor(e)};function Qi(e){return typeof e=="object"||typeof e=="function"}function we(e,t){if(e!==void 0&&!Qi(e))throw new TypeError(`${t} is not an object.`)}function fe(e,t){if(typeof e!="function")throw new TypeError(`${t} is not a function.`)}function Zi(e){return typeof e=="object"&&e!==null||typeof e=="function"}function jn(e,t){if(!Zi(e))throw new TypeError(`${t} is not an object.`)}function Re(e,t,r){if(e===void 0)throw new TypeError(`Parameter ${t} is required in '${r}'.`)}function Vr(e,t,r){if(e===void 0)throw new TypeError(`${t} is required in '${r}'.`)}function Yr(e){return Number(e)}function Nn(e){return e===0?0:e}function Ji(e){return Nn(Gi(e))}function Hn(e,t){let s=Number.MAX_SAFE_INTEGER,f=Number(e);if(f=Nn(f),!Mn(f))throw new TypeError(`${t} is not a finite number`);if(f=Ji(f),f<0||f>s)throw new TypeError(`${t} is outside the accepted range of 0 to ${s}, inclusive`);return!Mn(f)||f===0?0:f}function Gr(e,t){if(!Fe(e))throw new TypeError(`${t} is not a ReadableStream.`)}function Xe(e){return new bt(e)}function xn(e,t){e._reader._readRequests.push(t)}function Qr(e,t,r){let f=e._reader._readRequests.shift();r?f._closeSteps():f._chunkSteps(t)}function Vt(e){return e._reader._readRequests.length}function Vn(e){let t=e._reader;return!(t===void 0||!De(t))}class bt{constructor(t){if(Re(t,1,"ReadableStreamDefaultReader"),Gr(t,"First parameter"),We(t))throw new TypeError("This stream has already been locked for exclusive reading by another reader");Ln(this,t),this._readRequests=new Q}get closed(){return De(this)?this._closedPromise:p(Yt("closed"))}cancel(t=void 0){return De(this)?this._ownerReadableStream===void 0?p(Ke("cancel")):Mr(this,t):p(Yt("cancel"))}read(){if(!De(this))return p(Yt("read"));if(this._ownerReadableStream===void 0)return p(Ke("read from"));let t,r,s=A((c,m)=>{t=c,r=m});return pt(this,{_chunkSteps:c=>t({value:c,done:!1}),_closeSteps:()=>t({value:void 0,done:!0}),_errorSteps:c=>r(c)}),s}releaseLock(){if(!De(this))throw Yt("releaseLock");if(this._ownerReadableStream!==void 0){if(this._readRequests.length>0)throw new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");_e(this)}}}Object.defineProperties(bt.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),typeof n.toStringTag=="symbol"&&Object.defineProperty(bt.prototype,n.toStringTag,{value:"ReadableStreamDefaultReader",configurable:!0});function De(e){return!u(e)||!Object.prototype.hasOwnProperty.call(e,"_readRequests")?!1:e instanceof bt}function pt(e,t){let r=e._ownerReadableStream;r._disturbed=!0,r._state==="closed"?t._closeSteps():r._state==="errored"?t._errorSteps(r._storedError):r._readableStreamController[xr](t)}function Yt(e){return new TypeError(`ReadableStreamDefaultReader.prototype.${e} can only be used on a ReadableStreamDefaultReader`)}let Yn=Object.getPrototypeOf(Object.getPrototypeOf(async function*(){}).prototype);class Gn{constructor(t,r){this._ongoingPromise=void 0,this._isFinished=!1,this._reader=t,this._preventCancel=r}next(){let t=()=>this._nextSteps();return this._ongoingPromise=this._ongoingPromise?F(this._ongoingPromise,t,t):t(),this._ongoingPromise}return(t){let r=()=>this._returnSteps(t);return this._ongoingPromise?F(this._ongoingPromise,r,r):r()}_nextSteps(){if(this._isFinished)return Promise.resolve({value:void 0,done:!0});let t=this._reader;if(t._ownerReadableStream===void 0)return p(Ke("iterate"));let r,s,f=A((m,_)=>{r=m,s=_});return pt(t,{_chunkSteps:m=>{this._ongoingPromise=void 0,w(()=>r({value:m,done:!1}))},_closeSteps:()=>{this._ongoingPromise=void 0,this._isFinished=!0,_e(t),r({value:void 0,done:!0})},_errorSteps:m=>{this._ongoingPromise=void 0,this._isFinished=!0,_e(t),s(m)}}),f}_returnSteps(t){if(this._isFinished)return Promise.resolve({value:t,done:!0});this._isFinished=!0;let r=this._reader;if(r._ownerReadableStream===void 0)return p(Ke("finish iterating"));if(!this._preventCancel){let s=Mr(r,t);return _e(r),F(s,()=>({value:t,done:!0}))}return _e(r),S({value:t,done:!0})}}let Qn={next(){return Zn(this)?this._asyncIteratorImpl.next():p(Jn("next"))},return(e){return Zn(this)?this._asyncIteratorImpl.return(e):p(Jn("return"))}};Yn!==void 0&&Object.setPrototypeOf(Qn,Yn);function Ki(e,t){let r=Xe(e),s=new Gn(r,t),f=Object.create(Qn);return f._asyncIteratorImpl=s,f}function Zn(e){if(!u(e)||!Object.prototype.hasOwnProperty.call(e,"_asyncIteratorImpl"))return!1;try{return e._asyncIteratorImpl instanceof Gn}catch{return!1}}function Jn(e){return new TypeError(`ReadableStreamAsyncIterator.${e} can only be used on a ReadableSteamAsyncIterator`)}let Kn=Number.isNaN||function(e){return e!==e};function gt(e){return e.slice()}function Xn(e,t,r,s,f){new Uint8Array(e).set(new Uint8Array(r,s,f),t)}function Qa(e){return e}function Gt(e){return!1}function eo(e,t,r){if(e.slice)return e.slice(t,r);let s=r-t,f=new ArrayBuffer(s);return Xn(f,0,e,t,s),f}function Xi(e){return!(typeof e!="number"||Kn(e)||e<0)}function to(e){let t=eo(e.buffer,e.byteOffset,e.byteOffset+e.byteLength);return new Uint8Array(t)}function Zr(e){let t=e._queue.shift();return e._queueTotalSize-=t.size,e._queueTotalSize<0&&(e._queueTotalSize=0),t.value}function Jr(e,t,r){if(!Xi(r)||r===1/0)throw new RangeError("Size must be a finite, non-NaN, non-negative number.");e._queue.push({value:t,size:r}),e._queueTotalSize+=r}function es(e){return e._queue.peek().value}function Be(e){e._queue=new Q,e._queueTotalSize=0}class yt{constructor(){throw new TypeError("Illegal constructor")}get view(){if(!Kr(this))throw rn("view");return this._view}respond(t){if(!Kr(this))throw rn("respond");if(Re(t,1,"respond"),t=Hn(t,"First parameter"),this._associatedReadableByteStreamController===void 0)throw new TypeError("This BYOB request has been invalidated");Gt(this._view.buffer),Xt(this._associatedReadableByteStreamController,t)}respondWithNewView(t){if(!Kr(this))throw rn("respondWithNewView");if(Re(t,1,"respondWithNewView"),!ArrayBuffer.isView(t))throw new TypeError("You can only respond with array buffer views");if(this._associatedReadableByteStreamController===void 0)throw new TypeError("This BYOB request has been invalidated");Gt(t.buffer),er(this._associatedReadableByteStreamController,t)}}Object.defineProperties(yt.prototype,{respond:{enumerable:!0},respondWithNewView:{enumerable:!0},view:{enumerable:!0}}),typeof n.toStringTag=="symbol"&&Object.defineProperty(yt.prototype,n.toStringTag,{value:"ReadableStreamBYOBRequest",configurable:!0});class et{constructor(){throw new TypeError("Illegal constructor")}get byobRequest(){if(!ze(this))throw _t("byobRequest");return tn(this)}get desiredSize(){if(!ze(this))throw _t("desiredSize");return uo(this)}close(){if(!ze(this))throw _t("close");if(this._closeRequested)throw new TypeError("The stream has already been closed; do not close it again!");let t=this._controlledReadableByteStream._state;if(t!=="readable")throw new TypeError(`The stream (in ${t} state) is not in the readable state and cannot be closed`);St(this)}enqueue(t){if(!ze(this))throw _t("enqueue");if(Re(t,1,"enqueue"),!ArrayBuffer.isView(t))throw new TypeError("chunk must be an array buffer view");if(t.byteLength===0)throw new TypeError("chunk must have non-zero byteLength");if(t.buffer.byteLength===0)throw new TypeError("chunk's buffer must have non-zero byteLength");if(this._closeRequested)throw new TypeError("stream is closed or draining");let r=this._controlledReadableByteStream._state;if(r!=="readable")throw new TypeError(`The stream (in ${r} state) is not in the readable state and cannot be enqueued to`);Kt(this,t)}error(t=void 0){if(!ze(this))throw _t("error");de(this,t)}[Hr](t){ro(this),Be(this);let r=this._cancelAlgorithm(t);return Jt(this),r}[xr](t){let r=this._controlledReadableByteStream;if(this._queueTotalSize>0){let f=this._queue.shift();this._queueTotalSize-=f.byteLength,so(this);let c=new Uint8Array(f.buffer,f.byteOffset,f.byteLength);t._chunkSteps(c);return}let s=this._autoAllocateChunkSize;if(s!==void 0){let f;try{f=new ArrayBuffer(s)}catch(m){t._errorSteps(m);return}let c={buffer:f,bufferByteLength:s,byteOffset:0,byteLength:s,bytesFilled:0,elementSize:1,viewConstructor:Uint8Array,readerType:"default"};this._pendingPullIntos.push(c)}xn(r,t),Ue(this)}}Object.defineProperties(et.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},byobRequest:{enumerable:!0},desiredSize:{enumerable:!0}}),typeof n.toStringTag=="symbol"&&Object.defineProperty(et.prototype,n.toStringTag,{value:"ReadableByteStreamController",configurable:!0});function ze(e){return!u(e)||!Object.prototype.hasOwnProperty.call(e,"_controlledReadableByteStream")?!1:e instanceof et}function Kr(e){return!u(e)||!Object.prototype.hasOwnProperty.call(e,"_associatedReadableByteStreamController")?!1:e instanceof yt}function Ue(e){if(!os(e))return;if(e._pulling){e._pullAgain=!0;return}e._pulling=!0;let r=e._pullAlgorithm();C(r,()=>{e._pulling=!1,e._pullAgain&&(e._pullAgain=!1,Ue(e))},s=>{de(e,s)})}function ro(e){en(e),e._pendingPullIntos=new Q}function Xr(e,t){let r=!1;e._state==="closed"&&(r=!0);let s=no(t);t.readerType==="default"?Qr(e,s,r):as(e,s,r)}function no(e){let t=e.bytesFilled,r=e.elementSize;return new e.viewConstructor(e.buffer,e.byteOffset,t/r)}function Qt(e,t,r,s){e._queue.push({buffer:t,byteOffset:r,byteLength:s}),e._queueTotalSize+=s}function oo(e,t){let r=t.elementSize,s=t.bytesFilled-t.bytesFilled%r,f=Math.min(e._queueTotalSize,t.byteLength-t.bytesFilled),c=t.bytesFilled+f,m=c-c%r,_=f,D=!1;m>s&&(_=m-t.bytesFilled,D=!0);let W=e._queue;for(;_>0;){let I=W.peek(),L=Math.min(_,I.byteLength),N=t.byteOffset+t.bytesFilled;Xn(t.buffer,N,I.buffer,I.byteOffset,L),I.byteLength===L?W.shift():(I.byteOffset+=L,I.byteLength-=L),e._queueTotalSize-=L,io(e,L,t),_-=L}return D}function io(e,t,r){r.bytesFilled+=t}function so(e){e._queueTotalSize===0&&e._closeRequested?(Jt(e),vt(e._controlledReadableByteStream)):Ue(e)}function en(e){e._byobRequest!==null&&(e._byobRequest._associatedReadableByteStreamController=void 0,e._byobRequest._view=null,e._byobRequest=null)}function ao(e){for(;e._pendingPullIntos.length>0;){if(e._queueTotalSize===0)return;let t=e._pendingPullIntos.peek();oo(e,t)&&(Zt(e),Xr(e._controlledReadableByteStream,t))}}function ts(e,t,r){let s=e._controlledReadableByteStream,f=1;t.constructor!==DataView&&(f=t.constructor.BYTES_PER_ELEMENT);let c=t.constructor,m=t.buffer,_={buffer:m,bufferByteLength:m.byteLength,byteOffset:t.byteOffset,byteLength:t.byteLength,bytesFilled:0,elementSize:f,viewConstructor:c,readerType:"byob"};if(e._pendingPullIntos.length>0){e._pendingPullIntos.push(_),ho(s,r);return}if(s._state==="closed"){let D=new c(_.buffer,_.byteOffset,0);r._closeSteps(D);return}if(e._queueTotalSize>0){if(oo(e,_)){let D=no(_);so(e),r._chunkSteps(D);return}if(e._closeRequested){let D=new TypeError("Insufficient bytes to fill elements in the given buffer");de(e,D),r._errorSteps(D);return}}e._pendingPullIntos.push(_),ho(s,r),Ue(e)}function rs(e,t){let r=e._controlledReadableByteStream;if(nn(r))for(;mo(r)>0;){let s=Zt(e);Xr(r,s)}}function ns(e,t,r){if(io(e,t,r),r.bytesFilled<r.elementSize)return;Zt(e);let s=r.bytesFilled%r.elementSize;if(s>0){let f=r.byteOffset+r.bytesFilled,c=eo(r.buffer,f-s,f);Qt(e,c,0,c.byteLength)}r.bytesFilled-=s,Xr(e._controlledReadableByteStream,r),ao(e)}function lo(e,t){let r=e._pendingPullIntos.peek();en(e),e._controlledReadableByteStream._state==="closed"?rs(e):ns(e,t,r),Ue(e)}function Zt(e){return e._pendingPullIntos.shift()}function os(e){let t=e._controlledReadableByteStream;return t._state!=="readable"||e._closeRequested||!e._started?!1:!!(Vn(t)&&Vt(t)>0||nn(t)&&mo(t)>0||uo(e)>0)}function Jt(e){e._pullAlgorithm=void 0,e._cancelAlgorithm=void 0}function St(e){let t=e._controlledReadableByteStream;if(!(e._closeRequested||t._state!=="readable")){if(e._queueTotalSize>0){e._closeRequested=!0;return}if(e._pendingPullIntos.length>0&&e._pendingPullIntos.peek().bytesFilled>0){let s=new TypeError("Insufficient bytes to fill elements in the given buffer");throw de(e,s),s}Jt(e),vt(t)}}function Kt(e,t){let r=e._controlledReadableByteStream;if(e._closeRequested||r._state!=="readable")return;let s=t.buffer,f=t.byteOffset,c=t.byteLength,m=s;if(e._pendingPullIntos.length>0){let _=e._pendingPullIntos.peek();Gt(_.buffer),_.buffer=_.buffer}if(en(e),Vn(r))if(Vt(r)===0)Qt(e,m,f,c);else{e._pendingPullIntos.length>0&&Zt(e);let _=new Uint8Array(m,f,c);Qr(r,_,!1)}else nn(r)?(Qt(e,m,f,c),ao(e)):Qt(e,m,f,c);Ue(e)}function de(e,t){let r=e._controlledReadableByteStream;r._state==="readable"&&(ro(e),Be(e),Jt(e),$o(r,t))}function tn(e){if(e._byobRequest===null&&e._pendingPullIntos.length>0){let t=e._pendingPullIntos.peek(),r=new Uint8Array(t.buffer,t.byteOffset+t.bytesFilled,t.byteLength-t.bytesFilled),s=Object.create(yt.prototype);ss(s,e,r),e._byobRequest=s}return e._byobRequest}function uo(e){let t=e._controlledReadableByteStream._state;return t==="errored"?null:t==="closed"?0:e._strategyHWM-e._queueTotalSize}function Xt(e,t){let r=e._pendingPullIntos.peek();if(e._controlledReadableByteStream._state==="closed"){if(t!==0)throw new TypeError("bytesWritten must be 0 when calling respond() on a closed stream")}else{if(t===0)throw new TypeError("bytesWritten must be greater than 0 when calling respond() on a readable stream");if(r.bytesFilled+t>r.byteLength)throw new RangeError("bytesWritten out of range")}r.buffer=r.buffer,lo(e,t)}function er(e,t){let r=e._pendingPullIntos.peek();if(e._controlledReadableByteStream._state==="closed"){if(t.byteLength!==0)throw new TypeError("The view's length must be 0 when calling respondWithNewView() on a closed stream")}else if(t.byteLength===0)throw new TypeError("The view's length must be greater than 0 when calling respondWithNewView() on a readable stream");if(r.byteOffset+r.bytesFilled!==t.byteOffset)throw new RangeError("The region specified by view does not match byobRequest");if(r.bufferByteLength!==t.buffer.byteLength)throw new RangeError("The buffer of view has different capacity than byobRequest");if(r.bytesFilled+t.byteLength>r.byteLength)throw new RangeError("The region specified by view is larger than byobRequest");let f=t.byteLength;r.buffer=t.buffer,lo(e,f)}function fo(e,t,r,s,f,c,m){t._controlledReadableByteStream=e,t._pullAgain=!1,t._pulling=!1,t._byobRequest=null,t._queue=t._queueTotalSize=void 0,Be(t),t._closeRequested=!1,t._started=!1,t._strategyHWM=c,t._pullAlgorithm=s,t._cancelAlgorithm=f,t._autoAllocateChunkSize=m,t._pendingPullIntos=new Q,e._readableStreamController=t;let _=r();C(S(_),()=>{t._started=!0,Ue(t)},D=>{de(t,D)})}function is(e,t,r){let s=Object.create(et.prototype),f=()=>{},c=()=>S(void 0),m=()=>S(void 0);t.start!==void 0&&(f=()=>t.start(s)),t.pull!==void 0&&(c=()=>t.pull(s)),t.cancel!==void 0&&(m=D=>t.cancel(D));let _=t.autoAllocateChunkSize;if(_===0)throw new TypeError("autoAllocateChunkSize must be greater than 0");fo(e,s,f,c,m,r,_)}function ss(e,t,r){e._associatedReadableByteStreamController=t,e._view=r}function rn(e){return new TypeError(`ReadableStreamBYOBRequest.prototype.${e} can only be used on a ReadableStreamBYOBRequest`)}function _t(e){return new TypeError(`ReadableByteStreamController.prototype.${e} can only be used on a ReadableByteStreamController`)}function co(e){return new wt(e)}function ho(e,t){e._reader._readIntoRequests.push(t)}function as(e,t,r){let f=e._reader._readIntoRequests.shift();r?f._closeSteps(t):f._chunkSteps(t)}function mo(e){return e._reader._readIntoRequests.length}function nn(e){let t=e._reader;return!(t===void 0||!Me(t))}class wt{constructor(t){if(Re(t,1,"ReadableStreamBYOBReader"),Gr(t,"First parameter"),We(t))throw new TypeError("This stream has already been locked for exclusive reading by another reader");if(!ze(t._readableStreamController))throw new TypeError("Cannot construct a ReadableStreamBYOBReader for a stream not constructed with a byte source");Ln(this,t),this._readIntoRequests=new Q}get closed(){return Me(this)?this._closedPromise:p(tr("closed"))}cancel(t=void 0){return Me(this)?this._ownerReadableStream===void 0?p(Ke("cancel")):Mr(this,t):p(tr("cancel"))}read(t){if(!Me(this))return p(tr("read"));if(!ArrayBuffer.isView(t))return p(new TypeError("view must be an array buffer view"));if(t.byteLength===0)return p(new TypeError("view must have non-zero byteLength"));if(t.buffer.byteLength===0)return p(new TypeError("view's buffer must have non-zero byteLength"));if(Gt(t.buffer),this._ownerReadableStream===void 0)return p(Ke("read from"));let r,s,f=A((m,_)=>{r=m,s=_});return bo(this,t,{_chunkSteps:m=>r({value:m,done:!1}),_closeSteps:m=>r({value:m,done:!0}),_errorSteps:m=>s(m)}),f}releaseLock(){if(!Me(this))throw tr("releaseLock");if(this._ownerReadableStream!==void 0){if(this._readIntoRequests.length>0)throw new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");_e(this)}}}Object.defineProperties(wt.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),typeof n.toStringTag=="symbol"&&Object.defineProperty(wt.prototype,n.toStringTag,{value:"ReadableStreamBYOBReader",configurable:!0});function Me(e){return!u(e)||!Object.prototype.hasOwnProperty.call(e,"_readIntoRequests")?!1:e instanceof wt}function bo(e,t,r){let s=e._ownerReadableStream;s._disturbed=!0,s._state==="errored"?r._errorSteps(s._storedError):ts(s._readableStreamController,t,r)}function tr(e){return new TypeError(`ReadableStreamBYOBReader.prototype.${e} can only be used on a ReadableStreamBYOBReader`)}function Rt(e,t){let{highWaterMark:r}=e;if(r===void 0)return t;if(Kn(r)||r<0)throw new RangeError("Invalid highWaterMark");return r}function rr(e){let{size:t}=e;return t||(()=>1)}function nr(e,t){we(e,t);let r=e?.highWaterMark,s=e?.size;return{highWaterMark:r===void 0?void 0:Yr(r),size:s===void 0?void 0:ls(s,`${t} has member 'size' that`)}}function ls(e,t){return fe(e,t),r=>Yr(e(r))}function us(e,t){we(e,t);let r=e?.abort,s=e?.close,f=e?.start,c=e?.type,m=e?.write;return{abort:r===void 0?void 0:fs(r,e,`${t} has member 'abort' that`),close:s===void 0?void 0:ds(s,e,`${t} has member 'close' that`),start:f===void 0?void 0:cs(f,e,`${t} has member 'start' that`),write:m===void 0?void 0:hs(m,e,`${t} has member 'write' that`),type:c}}function fs(e,t,r){return fe(e,r),s=>B(e,t,[s])}function ds(e,t,r){return fe(e,r),()=>B(e,t,[])}function cs(e,t,r){return fe(e,r),s=>z(e,t,[s])}function hs(e,t,r){return fe(e,r),(s,f)=>B(e,t,[s,f])}function po(e,t){if(!tt(e))throw new TypeError(`${t} is not a WritableStream.`)}function ms(e){if(typeof e!="object"||e===null)return!1;try{return typeof e.aborted=="boolean"}catch{return!1}}let bs=typeof AbortController=="function";function ps(){if(bs)return new AbortController}class Tt{constructor(t={},r={}){t===void 0?t=null:jn(t,"First parameter");let s=nr(r,"Second parameter"),f=us(t,"First parameter");if(yo(this),f.type!==void 0)throw new RangeError("Invalid type is specified");let m=rr(s),_=Rt(s,1);Bs(this,f,_,m)}get locked(){if(!tt(this))throw lr("locked");return rt(this)}abort(t=void 0){return tt(this)?rt(this)?p(new TypeError("Cannot abort a stream that already has a writer")):or(this,t):p(lr("abort"))}close(){return tt(this)?rt(this)?p(new TypeError("Cannot close a stream that already has a writer")):pe(this)?p(new TypeError("Cannot close an already-closing stream")):So(this):p(lr("close"))}getWriter(){if(!tt(this))throw lr("getWriter");return go(this)}}Object.defineProperties(Tt.prototype,{abort:{enumerable:!0},close:{enumerable:!0},getWriter:{enumerable:!0},locked:{enumerable:!0}}),typeof n.toStringTag=="symbol"&&Object.defineProperty(Tt.prototype,n.toStringTag,{value:"WritableStream",configurable:!0});function go(e){return new Pt(e)}function gs(e,t,r,s,f=1,c=()=>1){let m=Object.create(Tt.prototype);yo(m);let _=Object.create(nt.prototype);return Co(m,_,e,t,r,s,f,c),m}function yo(e){e._state="writable",e._storedError=void 0,e._writer=void 0,e._writableStreamController=void 0,e._writeRequests=new Q,e._inFlightWriteRequest=void 0,e._closeRequest=void 0,e._inFlightCloseRequest=void 0,e._pendingAbortRequest=void 0,e._backpressure=!1}function tt(e){return!u(e)||!Object.prototype.hasOwnProperty.call(e,"_writableStreamController")?!1:e instanceof Tt}function rt(e){return e._writer!==void 0}function or(e,t){var r;if(e._state==="closed"||e._state==="errored")return S(void 0);e._writableStreamController._abortReason=t,(r=e._writableStreamController._abortController)===null||r===void 0||r.abort();let s=e._state;if(s==="closed"||s==="errored")return S(void 0);if(e._pendingAbortRequest!==void 0)return e._pendingAbortRequest._promise;let f=!1;s==="erroring"&&(f=!0,t=void 0);let c=A((m,_)=>{e._pendingAbortRequest={_promise:void 0,_resolve:m,_reject:_,_reason:t,_wasAlreadyErroring:f}});return e._pendingAbortRequest._promise=c,f||sn(e,t),c}function So(e){let t=e._state;if(t==="closed"||t==="errored")return p(new TypeError(`The stream (in ${t} state) is not in the writable state and cannot be closed`));let r=A((f,c)=>{let m={_resolve:f,_reject:c};e._closeRequest=m}),s=e._writer;return s!==void 0&&e._backpressure&&t==="writable"&&bn(s),ks(e._writableStreamController),r}function ys(e){return A((r,s)=>{let f={_resolve:r,_reject:s};e._writeRequests.push(f)})}function on(e,t){if(e._state==="writable"){sn(e,t);return}an(e)}function sn(e,t){let r=e._writableStreamController;e._state="erroring",e._storedError=t;let s=e._writer;s!==void 0&&wo(s,t),!Ts(e)&&r._started&&an(e)}function an(e){e._state="errored",e._writableStreamController[Un]();let t=e._storedError;if(e._writeRequests.forEach(f=>{f._reject(t)}),e._writeRequests=new Q,e._pendingAbortRequest===void 0){ir(e);return}let r=e._pendingAbortRequest;if(e._pendingAbortRequest=void 0,r._wasAlreadyErroring){r._reject(t),ir(e);return}let s=e._writableStreamController[zn](r._reason);C(s,()=>{r._resolve(),ir(e)},f=>{r._reject(f),ir(e)})}function Ss(e){e._inFlightWriteRequest._resolve(void 0),e._inFlightWriteRequest=void 0}function _s(e,t){e._inFlightWriteRequest._reject(t),e._inFlightWriteRequest=void 0,on(e,t)}function ws(e){e._inFlightCloseRequest._resolve(void 0),e._inFlightCloseRequest=void 0,e._state==="erroring"&&(e._storedError=void 0,e._pendingAbortRequest!==void 0&&(e._pendingAbortRequest._resolve(),e._pendingAbortRequest=void 0)),e._state="closed";let r=e._writer;r!==void 0&&Do(r)}function Rs(e,t){e._inFlightCloseRequest._reject(t),e._inFlightCloseRequest=void 0,e._pendingAbortRequest!==void 0&&(e._pendingAbortRequest._reject(t),e._pendingAbortRequest=void 0),on(e,t)}function pe(e){return!(e._closeRequest===void 0&&e._inFlightCloseRequest===void 0)}function Ts(e){return!(e._inFlightWriteRequest===void 0&&e._inFlightCloseRequest===void 0)}function Ps(e){e._inFlightCloseRequest=e._closeRequest,e._closeRequest=void 0}function Cs(e){e._inFlightWriteRequest=e._writeRequests.shift()}function ir(e){e._closeRequest!==void 0&&(e._closeRequest._reject(e._storedError),e._closeRequest=void 0);let t=e._writer;t!==void 0&&hn(t,e._storedError)}function ln(e,t){let r=e._writer;r!==void 0&&t!==e._backpressure&&(t?$s(r):bn(r)),e._backpressure=t}class Pt{constructor(t){if(Re(t,1,"WritableStreamDefaultWriter"),po(t,"First parameter"),rt(t))throw new TypeError("This stream has already been locked for exclusive writing by another writer");this._ownerWritableStream=t,t._writer=this;let r=t._state;if(r==="writable")!pe(t)&&t._backpressure?fr(this):Bo(this),ur(this);else if(r==="erroring")mn(this,t._storedError),ur(this);else if(r==="closed")Bo(this),Ls(this);else{let s=t._storedError;mn(this,s),vo(this,s)}}get closed(){return je(this)?this._closedPromise:p(Ne("closed"))}get desiredSize(){if(!je(this))throw Ne("desiredSize");if(this._ownerWritableStream===void 0)throw Ct("desiredSize");return Ds(this)}get ready(){return je(this)?this._readyPromise:p(Ne("ready"))}abort(t=void 0){return je(this)?this._ownerWritableStream===void 0?p(Ct("abort")):As(this,t):p(Ne("abort"))}close(){if(!je(this))return p(Ne("close"));let t=this._ownerWritableStream;return t===void 0?p(Ct("close")):pe(t)?p(new TypeError("Cannot close an already-closing stream")):_o(this)}releaseLock(){if(!je(this))throw Ne("releaseLock");this._ownerWritableStream!==void 0&&Ro(this)}write(t=void 0){return je(this)?this._ownerWritableStream===void 0?p(Ct("write to")):To(this,t):p(Ne("write"))}}Object.defineProperties(Pt.prototype,{abort:{enumerable:!0},close:{enumerable:!0},releaseLock:{enumerable:!0},write:{enumerable:!0},closed:{enumerable:!0},desiredSize:{enumerable:!0},ready:{enumerable:!0}}),typeof n.toStringTag=="symbol"&&Object.defineProperty(Pt.prototype,n.toStringTag,{value:"WritableStreamDefaultWriter",configurable:!0});function je(e){return!u(e)||!Object.prototype.hasOwnProperty.call(e,"_ownerWritableStream")?!1:e instanceof Pt}function As(e,t){let r=e._ownerWritableStream;return or(r,t)}function _o(e){let t=e._ownerWritableStream;return So(t)}function Es(e){let t=e._ownerWritableStream,r=t._state;return pe(t)||r==="closed"?S(void 0):r==="errored"?p(t._storedError):_o(e)}function vs(e,t){e._closedPromiseState==="pending"?hn(e,t):qs(e,t)}function wo(e,t){e._readyPromiseState==="pending"?ko(e,t):zs(e,t)}function Ds(e){let t=e._ownerWritableStream,r=t._state;return r==="errored"||r==="erroring"?null:r==="closed"?0:Ao(t._writableStreamController)}function Ro(e){let t=e._ownerWritableStream,r=new TypeError("Writer was released and can no longer be used to monitor the stream's closedness");wo(e,r),vs(e,r),t._writer=void 0,e._ownerWritableStream=void 0}function To(e,t){let r=e._ownerWritableStream,s=r._writableStreamController,f=Os(s,t);if(r!==e._ownerWritableStream)return p(Ct("write to"));let c=r._state;if(c==="errored")return p(r._storedError);if(pe(r)||c==="closed")return p(new TypeError("The stream is closing or closed and cannot be written to"));if(c==="erroring")return p(r._storedError);let m=ys(r);return Fs(s,t,f),m}let Po={};class nt{constructor(){throw new TypeError("Illegal constructor")}get abortReason(){if(!un(this))throw cn("abortReason");return this._abortReason}get signal(){if(!un(this))throw cn("signal");if(this._abortController===void 0)throw new TypeError("WritableStreamDefaultController.prototype.signal is not supported");return this._abortController.signal}error(t=void 0){if(!un(this))throw cn("error");this._controlledWritableStream._state==="writable"&&Eo(this,t)}[zn](t){let r=this._abortAlgorithm(t);return sr(this),r}[Un](){Be(this)}}Object.defineProperties(nt.prototype,{abortReason:{enumerable:!0},signal:{enumerable:!0},error:{enumerable:!0}}),typeof n.toStringTag=="symbol"&&Object.defineProperty(nt.prototype,n.toStringTag,{value:"WritableStreamDefaultController",configurable:!0});function un(e){return!u(e)||!Object.prototype.hasOwnProperty.call(e,"_controlledWritableStream")?!1:e instanceof nt}function Co(e,t,r,s,f,c,m,_){t._controlledWritableStream=e,e._writableStreamController=t,t._queue=void 0,t._queueTotalSize=void 0,Be(t),t._abortReason=void 0,t._abortController=ps(),t._started=!1,t._strategySizeAlgorithm=_,t._strategyHWM=m,t._writeAlgorithm=s,t._closeAlgorithm=f,t._abortAlgorithm=c;let D=dn(t);ln(e,D);let W=r(),I=S(W);C(I,()=>{t._started=!0,ar(t)},L=>{t._started=!0,on(e,L)})}function Bs(e,t,r,s){let f=Object.create(nt.prototype),c=()=>{},m=()=>S(void 0),_=()=>S(void 0),D=()=>S(void 0);t.start!==void 0&&(c=()=>t.start(f)),t.write!==void 0&&(m=W=>t.write(W,f)),t.close!==void 0&&(_=()=>t.close()),t.abort!==void 0&&(D=W=>t.abort(W)),Co(e,f,c,m,_,D,r,s)}function sr(e){e._writeAlgorithm=void 0,e._closeAlgorithm=void 0,e._abortAlgorithm=void 0,e._strategySizeAlgorithm=void 0}function ks(e){Jr(e,Po,0),ar(e)}function Os(e,t){try{return e._strategySizeAlgorithm(t)}catch(r){return fn(e,r),1}}function Ao(e){return e._strategyHWM-e._queueTotalSize}function Fs(e,t,r){try{Jr(e,t,r)}catch(f){fn(e,f);return}let s=e._controlledWritableStream;if(!pe(s)&&s._state==="writable"){let f=dn(e);ln(s,f)}ar(e)}function ar(e){let t=e._controlledWritableStream;if(!e._started||t._inFlightWriteRequest!==void 0)return;if(t._state==="erroring"){an(t);return}if(e._queue.length===0)return;let s=es(e);s===Po?Ws(e):Is(e,s)}function fn(e,t){e._controlledWritableStream._state==="writable"&&Eo(e,t)}function Ws(e){let t=e._controlledWritableStream;Ps(t),Zr(e);let r=e._closeAlgorithm();sr(e),C(r,()=>{ws(t)},s=>{Rs(t,s)})}function Is(e,t){let r=e._controlledWritableStream;Cs(r);let s=e._writeAlgorithm(t);C(s,()=>{Ss(r);let f=r._state;if(Zr(e),!pe(r)&&f==="writable"){let c=dn(e);ln(r,c)}ar(e)},f=>{r._state==="writable"&&sr(e),_s(r,f)})}function dn(e){return Ao(e)<=0}function Eo(e,t){let r=e._controlledWritableStream;sr(e),sn(r,t)}function lr(e){return new TypeError(`WritableStream.prototype.${e} can only be used on a WritableStream`)}function cn(e){return new TypeError(`WritableStreamDefaultController.prototype.${e} can only be used on a WritableStreamDefaultController`)}function Ne(e){return new TypeError(`WritableStreamDefaultWriter.prototype.${e} can only be used on a WritableStreamDefaultWriter`)}function Ct(e){return new TypeError("Cannot "+e+" a stream using a released writer")}function ur(e){e._closedPromise=A((t,r)=>{e._closedPromise_resolve=t,e._closedPromise_reject=r,e._closedPromiseState="pending"})}function vo(e,t){ur(e),hn(e,t)}function Ls(e){ur(e),Do(e)}function hn(e,t){e._closedPromise_reject!==void 0&&(v(e._closedPromise),e._closedPromise_reject(t),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="rejected")}function qs(e,t){vo(e,t)}function Do(e){e._closedPromise_resolve!==void 0&&(e._closedPromise_resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="resolved")}function fr(e){e._readyPromise=A((t,r)=>{e._readyPromise_resolve=t,e._readyPromise_reject=r}),e._readyPromiseState="pending"}function mn(e,t){fr(e),ko(e,t)}function Bo(e){fr(e),bn(e)}function ko(e,t){e._readyPromise_reject!==void 0&&(v(e._readyPromise),e._readyPromise_reject(t),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="rejected")}function $s(e){fr(e)}function zs(e,t){mn(e,t)}function bn(e){e._readyPromise_resolve!==void 0&&(e._readyPromise_resolve(void 0),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="fulfilled")}let Oo=typeof DOMException<"u"?DOMException:void 0;function Us(e){if(!(typeof e=="function"||typeof e=="object"))return!1;try{return new e,!0}catch{return!1}}function Ms(){let e=function(r,s){this.message=r||"",this.name=s||"Error",Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)};return e.prototype=Object.create(Error.prototype),Object.defineProperty(e.prototype,"constructor",{value:e,writable:!0,configurable:!0}),e}let js=Us(Oo)?Oo:Ms();function Fo(e,t,r,s,f,c){let m=Xe(e),_=go(t);e._disturbed=!0;let D=!1,W=S(void 0);return A((I,L)=>{let N;if(c!==void 0){if(N=()=>{let R=new js("Aborted","AbortError"),O=[];s||O.push(()=>t._state==="writable"?or(t,R):S(void 0)),f||O.push(()=>e._state==="readable"?ce(e,R):S(void 0)),X(()=>Promise.all(O.map(U=>U())),!0,R)},c.aborted){N();return}c.addEventListener("abort",N)}function he(){return A((R,O)=>{function U(re){re?R():b(st(),U,O)}U(!1)})}function st(){return D?S(!0):b(_._readyPromise,()=>A((R,O)=>{pt(m,{_chunkSteps:U=>{W=b(To(_,U),void 0,i),R(!1)},_closeSteps:()=>R(!0),_errorSteps:O})}))}if(Te(e,m._closedPromise,R=>{s?ie(!0,R):X(()=>or(t,R),!0,R)}),Te(t,_._closedPromise,R=>{f?ie(!0,R):X(()=>ce(e,R),!0,R)}),K(e,m._closedPromise,()=>{r?ie():X(()=>Es(_))}),pe(t)||t._state==="closed"){let R=new TypeError("the destination writable stream closed before all data could be piped to it");f?ie(!0,R):X(()=>ce(e,R),!0,R)}v(he());function Ie(){let R=W;return b(W,()=>R!==W?Ie():void 0)}function Te(R,O,U){R._state==="errored"?U(R._storedError):E(O,U)}function K(R,O,U){R._state==="closed"?U():P(O,U)}function X(R,O,U){if(D)return;D=!0,t._state==="writable"&&!pe(t)?P(Ie(),re):re();function re(){C(R(),()=>Pe(O,U),at=>Pe(!0,at))}}function ie(R,O){D||(D=!0,t._state==="writable"&&!pe(t)?P(Ie(),()=>Pe(R,O)):Pe(R,O))}function Pe(R,O){Ro(_),_e(m),c!==void 0&&c.removeEventListener("abort",N),R?L(O):I(void 0)}})}class ot{constructor(){throw new TypeError("Illegal constructor")}get desiredSize(){if(!dr(this))throw mr("desiredSize");return pn(this)}close(){if(!dr(this))throw mr("close");if(!it(this))throw new TypeError("The stream is not in a state that permits close");Et(this)}enqueue(t=void 0){if(!dr(this))throw mr("enqueue");if(!it(this))throw new TypeError("The stream is not in a state that permits enqueue");return hr(this,t)}error(t=void 0){if(!dr(this))throw mr("error");ke(this,t)}[Hr](t){Be(this);let r=this._cancelAlgorithm(t);return cr(this),r}[xr](t){let r=this._controlledReadableStream;if(this._queue.length>0){let s=Zr(this);this._closeRequested&&this._queue.length===0?(cr(this),vt(r)):At(this),t._chunkSteps(s)}else xn(r,t),At(this)}}Object.defineProperties(ot.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},desiredSize:{enumerable:!0}}),typeof n.toStringTag=="symbol"&&Object.defineProperty(ot.prototype,n.toStringTag,{value:"ReadableStreamDefaultController",configurable:!0});function dr(e){return!u(e)||!Object.prototype.hasOwnProperty.call(e,"_controlledReadableStream")?!1:e instanceof ot}function At(e){if(!Wo(e))return;if(e._pulling){e._pullAgain=!0;return}e._pulling=!0;let r=e._pullAlgorithm();C(r,()=>{e._pulling=!1,e._pullAgain&&(e._pullAgain=!1,At(e))},s=>{ke(e,s)})}function Wo(e){let t=e._controlledReadableStream;return!it(e)||!e._started?!1:!!(We(t)&&Vt(t)>0||pn(e)>0)}function cr(e){e._pullAlgorithm=void 0,e._cancelAlgorithm=void 0,e._strategySizeAlgorithm=void 0}function Et(e){if(!it(e))return;let t=e._controlledReadableStream;e._closeRequested=!0,e._queue.length===0&&(cr(e),vt(t))}function hr(e,t){if(!it(e))return;let r=e._controlledReadableStream;if(We(r)&&Vt(r)>0)Qr(r,t,!1);else{let s;try{s=e._strategySizeAlgorithm(t)}catch(f){throw ke(e,f),f}try{Jr(e,t,s)}catch(f){throw ke(e,f),f}}At(e)}function ke(e,t){let r=e._controlledReadableStream;r._state==="readable"&&(Be(e),cr(e),$o(r,t))}function pn(e){let t=e._controlledReadableStream._state;return t==="errored"?null:t==="closed"?0:e._strategyHWM-e._queueTotalSize}function Ns(e){return!Wo(e)}function it(e){let t=e._controlledReadableStream._state;return!e._closeRequested&&t==="readable"}function Io(e,t,r,s,f,c,m){t._controlledReadableStream=e,t._queue=void 0,t._queueTotalSize=void 0,Be(t),t._started=!1,t._closeRequested=!1,t._pullAgain=!1,t._pulling=!1,t._strategySizeAlgorithm=m,t._strategyHWM=c,t._pullAlgorithm=s,t._cancelAlgorithm=f,e._readableStreamController=t;let _=r();C(S(_),()=>{t._started=!0,At(t)},D=>{ke(t,D)})}function Hs(e,t,r,s){let f=Object.create(ot.prototype),c=()=>{},m=()=>S(void 0),_=()=>S(void 0);t.start!==void 0&&(c=()=>t.start(f)),t.pull!==void 0&&(m=()=>t.pull(f)),t.cancel!==void 0&&(_=D=>t.cancel(D)),Io(e,f,c,m,_,r,s)}function mr(e){return new TypeError(`ReadableStreamDefaultController.prototype.${e} can only be used on a ReadableStreamDefaultController`)}function xs(e,t){return ze(e._readableStreamController)?Ys(e):Vs(e)}function Vs(e,t){let r=Xe(e),s=!1,f=!1,c=!1,m=!1,_,D,W,I,L,N=A(K=>{L=K});function he(){return s?(f=!0,S(void 0)):(s=!0,pt(r,{_chunkSteps:X=>{w(()=>{f=!1;let ie=X,Pe=X;c||hr(W._readableStreamController,ie),m||hr(I._readableStreamController,Pe),s=!1,f&&he()})},_closeSteps:()=>{s=!1,c||Et(W._readableStreamController),m||Et(I._readableStreamController),(!c||!m)&&L(void 0)},_errorSteps:()=>{s=!1}}),S(void 0))}function st(K){if(c=!0,_=K,m){let X=gt([_,D]),ie=ce(e,X);L(ie)}return N}function Ie(K){if(m=!0,D=K,c){let X=gt([_,D]),ie=ce(e,X);L(ie)}return N}function Te(){}return W=gn(Te,he,st),I=gn(Te,he,Ie),E(r._closedPromise,K=>{ke(W._readableStreamController,K),ke(I._readableStreamController,K),(!c||!m)&&L(void 0)}),[W,I]}function Ys(e){let t=Xe(e),r=!1,s=!1,f=!1,c=!1,m=!1,_,D,W,I,L,N=A(R=>{L=R});function he(R){E(R._closedPromise,O=>{R===t&&(de(W._readableStreamController,O),de(I._readableStreamController,O),(!c||!m)&&L(void 0))})}function st(){Me(t)&&(_e(t),t=Xe(e),he(t)),pt(t,{_chunkSteps:O=>{w(()=>{s=!1,f=!1;let U=O,re=O;if(!c&&!m)try{re=to(O)}catch(at){de(W._readableStreamController,at),de(I._readableStreamController,at),L(ce(e,at));return}c||Kt(W._readableStreamController,U),m||Kt(I._readableStreamController,re),r=!1,s?Te():f&&K()})},_closeSteps:()=>{r=!1,c||St(W._readableStreamController),m||St(I._readableStreamController),W._readableStreamController._pendingPullIntos.length>0&&Xt(W._readableStreamController,0),I._readableStreamController._pendingPullIntos.length>0&&Xt(I._readableStreamController,0),(!c||!m)&&L(void 0)},_errorSteps:()=>{r=!1}})}function Ie(R,O){De(t)&&(_e(t),t=co(e),he(t));let U=O?I:W,re=O?W:I;bo(t,R,{_chunkSteps:lt=>{w(()=>{s=!1,f=!1;let ut=O?m:c;if(O?c:m)ut||er(U._readableStreamController,lt);else{let Jo;try{Jo=to(lt)}catch(Sn){de(U._readableStreamController,Sn),de(re._readableStreamController,Sn),L(ce(e,Sn));return}ut||er(U._readableStreamController,lt),Kt(re._readableStreamController,Jo)}r=!1,s?Te():f&&K()})},_closeSteps:lt=>{r=!1;let ut=O?m:c,Tr=O?c:m;ut||St(U._readableStreamController),Tr||St(re._readableStreamController),lt!==void 0&&(ut||er(U._readableStreamController,lt),!Tr&&re._readableStreamController._pendingPullIntos.length>0&&Xt(re._readableStreamController,0)),(!ut||!Tr)&&L(void 0)},_errorSteps:()=>{r=!1}})}function Te(){if(r)return s=!0,S(void 0);r=!0;let R=tn(W._readableStreamController);return R===null?st():Ie(R._view,!1),S(void 0)}function K(){if(r)return f=!0,S(void 0);r=!0;let R=tn(I._readableStreamController);return R===null?st():Ie(R._view,!0),S(void 0)}function X(R){if(c=!0,_=R,m){let O=gt([_,D]),U=ce(e,O);L(U)}return N}function ie(R){if(m=!0,D=R,c){let O=gt([_,D]),U=ce(e,O);L(U)}return N}function Pe(){}return W=qo(Pe,Te,X),I=qo(Pe,K,ie),he(t),[W,I]}function Gs(e,t){we(e,t);let r=e,s=r?.autoAllocateChunkSize,f=r?.cancel,c=r?.pull,m=r?.start,_=r?.type;return{autoAllocateChunkSize:s===void 0?void 0:Hn(s,`${t} has member 'autoAllocateChunkSize' that`),cancel:f===void 0?void 0:Qs(f,r,`${t} has member 'cancel' that`),pull:c===void 0?void 0:Zs(c,r,`${t} has member 'pull' that`),start:m===void 0?void 0:Js(m,r,`${t} has member 'start' that`),type:_===void 0?void 0:Ks(_,`${t} has member 'type' that`)}}function Qs(e,t,r){return fe(e,r),s=>B(e,t,[s])}function Zs(e,t,r){return fe(e,r),s=>B(e,t,[s])}function Js(e,t,r){return fe(e,r),s=>z(e,t,[s])}function Ks(e,t){if(e=`${e}`,e!=="bytes")throw new TypeError(`${t} '${e}' is not a valid enumeration value for ReadableStreamType`);return e}function Xs(e,t){we(e,t);let r=e?.mode;return{mode:r===void 0?void 0:ea(r,`${t} has member 'mode' that`)}}function ea(e,t){if(e=`${e}`,e!=="byob")throw new TypeError(`${t} '${e}' is not a valid enumeration value for ReadableStreamReaderMode`);return e}function ta(e,t){return we(e,t),{preventCancel:!!e?.preventCancel}}function Lo(e,t){we(e,t);let r=e?.preventAbort,s=e?.preventCancel,f=e?.preventClose,c=e?.signal;return c!==void 0&&ra(c,`${t} has member 'signal' that`),{preventAbort:!!r,preventCancel:!!s,preventClose:!!f,signal:c}}function ra(e,t){if(!ms(e))throw new TypeError(`${t} is not an AbortSignal.`)}function na(e,t){we(e,t);let r=e?.readable;Vr(r,"readable","ReadableWritablePair"),Gr(r,`${t} has member 'readable' that`);let s=e?.writable;return Vr(s,"writable","ReadableWritablePair"),po(s,`${t} has member 'writable' that`),{readable:r,writable:s}}class Oe{constructor(t={},r={}){t===void 0?t=null:jn(t,"First parameter");let s=nr(r,"Second parameter"),f=Gs(t,"First parameter");if(yn(this),f.type==="bytes"){if(s.size!==void 0)throw new RangeError("The strategy for a byte stream cannot have a size function");let c=Rt(s,0);is(this,f,c)}else{let c=rr(s),m=Rt(s,1);Hs(this,f,m,c)}}get locked(){if(!Fe(this))throw He("locked");return We(this)}cancel(t=void 0){return Fe(this)?We(this)?p(new TypeError("Cannot cancel a stream that already has a reader")):ce(this,t):p(He("cancel"))}getReader(t=void 0){if(!Fe(this))throw He("getReader");return Xs(t,"First parameter").mode===void 0?Xe(this):co(this)}pipeThrough(t,r={}){if(!Fe(this))throw He("pipeThrough");Re(t,1,"pipeThrough");let s=na(t,"First parameter"),f=Lo(r,"Second parameter");if(We(this))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked ReadableStream");if(rt(s.writable))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked WritableStream");let c=Fo(this,s.writable,f.preventClose,f.preventAbort,f.preventCancel,f.signal);return v(c),s.readable}pipeTo(t,r={}){if(!Fe(this))return p(He("pipeTo"));if(t===void 0)return p("Parameter 1 is required in 'pipeTo'.");if(!tt(t))return p(new TypeError("ReadableStream.prototype.pipeTo's first argument must be a WritableStream"));let s;try{s=Lo(r,"Second parameter")}catch(f){return p(f)}return We(this)?p(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked ReadableStream")):rt(t)?p(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked WritableStream")):Fo(this,t,s.preventClose,s.preventAbort,s.preventCancel,s.signal)}tee(){if(!Fe(this))throw He("tee");let t=xs(this);return gt(t)}values(t=void 0){if(!Fe(this))throw He("values");let r=ta(t,"First parameter");return Ki(this,r.preventCancel)}}Object.defineProperties(Oe.prototype,{cancel:{enumerable:!0},getReader:{enumerable:!0},pipeThrough:{enumerable:!0},pipeTo:{enumerable:!0},tee:{enumerable:!0},values:{enumerable:!0},locked:{enumerable:!0}}),typeof n.toStringTag=="symbol"&&Object.defineProperty(Oe.prototype,n.toStringTag,{value:"ReadableStream",configurable:!0}),typeof n.asyncIterator=="symbol"&&Object.defineProperty(Oe.prototype,n.asyncIterator,{value:Oe.prototype.values,writable:!0,configurable:!0});function gn(e,t,r,s=1,f=()=>1){let c=Object.create(Oe.prototype);yn(c);let m=Object.create(ot.prototype);return Io(c,m,e,t,r,s,f),c}function qo(e,t,r){let s=Object.create(Oe.prototype);yn(s);let f=Object.create(et.prototype);return fo(s,f,e,t,r,0,void 0),s}function yn(e){e._state="readable",e._reader=void 0,e._storedError=void 0,e._disturbed=!1}function Fe(e){return!u(e)||!Object.prototype.hasOwnProperty.call(e,"_readableStreamController")?!1:e instanceof Oe}function We(e){return e._reader!==void 0}function ce(e,t){if(e._disturbed=!0,e._state==="closed")return S(void 0);if(e._state==="errored")return p(e._storedError);vt(e);let r=e._reader;r!==void 0&&Me(r)&&(r._readIntoRequests.forEach(f=>{f._closeSteps(void 0)}),r._readIntoRequests=new Q);let s=e._readableStreamController[Hr](t);return F(s,i)}function vt(e){e._state="closed";let t=e._reader;t!==void 0&&($n(t),De(t)&&(t._readRequests.forEach(r=>{r._closeSteps()}),t._readRequests=new Q))}function $o(e,t){e._state="errored",e._storedError=t;let r=e._reader;r!==void 0&&(Nr(r,t),De(r)?(r._readRequests.forEach(s=>{s._errorSteps(t)}),r._readRequests=new Q):(r._readIntoRequests.forEach(s=>{s._errorSteps(t)}),r._readIntoRequests=new Q))}function He(e){return new TypeError(`ReadableStream.prototype.${e} can only be used on a ReadableStream`)}function zo(e,t){we(e,t);let r=e?.highWaterMark;return Vr(r,"highWaterMark","QueuingStrategyInit"),{highWaterMark:Yr(r)}}let Uo=e=>e.byteLength;Object.defineProperty(Uo,"name",{value:"size",configurable:!0});class br{constructor(t){Re(t,1,"ByteLengthQueuingStrategy"),t=zo(t,"First parameter"),this._byteLengthQueuingStrategyHighWaterMark=t.highWaterMark}get highWaterMark(){if(!jo(this))throw Mo("highWaterMark");return this._byteLengthQueuingStrategyHighWaterMark}get size(){if(!jo(this))throw Mo("size");return Uo}}Object.defineProperties(br.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),typeof n.toStringTag=="symbol"&&Object.defineProperty(br.prototype,n.toStringTag,{value:"ByteLengthQueuingStrategy",configurable:!0});function Mo(e){return new TypeError(`ByteLengthQueuingStrategy.prototype.${e} can only be used on a ByteLengthQueuingStrategy`)}function jo(e){return!u(e)||!Object.prototype.hasOwnProperty.call(e,"_byteLengthQueuingStrategyHighWaterMark")?!1:e instanceof br}let No=()=>1;Object.defineProperty(No,"name",{value:"size",configurable:!0});class pr{constructor(t){Re(t,1,"CountQueuingStrategy"),t=zo(t,"First parameter"),this._countQueuingStrategyHighWaterMark=t.highWaterMark}get highWaterMark(){if(!xo(this))throw Ho("highWaterMark");return this._countQueuingStrategyHighWaterMark}get size(){if(!xo(this))throw Ho("size");return No}}Object.defineProperties(pr.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),typeof n.toStringTag=="symbol"&&Object.defineProperty(pr.prototype,n.toStringTag,{value:"CountQueuingStrategy",configurable:!0});function Ho(e){return new TypeError(`CountQueuingStrategy.prototype.${e} can only be used on a CountQueuingStrategy`)}function xo(e){return!u(e)||!Object.prototype.hasOwnProperty.call(e,"_countQueuingStrategyHighWaterMark")?!1:e instanceof pr}function oa(e,t){we(e,t);let r=e?.flush,s=e?.readableType,f=e?.start,c=e?.transform,m=e?.writableType;return{flush:r===void 0?void 0:ia(r,e,`${t} has member 'flush' that`),readableType:s,start:f===void 0?void 0:sa(f,e,`${t} has member 'start' that`),transform:c===void 0?void 0:aa(c,e,`${t} has member 'transform' that`),writableType:m}}function ia(e,t,r){return fe(e,r),s=>B(e,t,[s])}function sa(e,t,r){return fe(e,r),s=>z(e,t,[s])}function aa(e,t,r){return fe(e,r),(s,f)=>B(e,t,[s,f])}class gr{constructor(t={},r={},s={}){t===void 0&&(t=null);let f=nr(r,"Second parameter"),c=nr(s,"Third parameter"),m=oa(t,"First parameter");if(m.readableType!==void 0)throw new RangeError("Invalid readableType specified");if(m.writableType!==void 0)throw new RangeError("Invalid writableType specified");let _=Rt(c,0),D=rr(c),W=Rt(f,1),I=rr(f),L,N=A(he=>{L=he});la(this,N,W,I,_,D),fa(this,m),m.start!==void 0?L(m.start(this._transformStreamController)):L(void 0)}get readable(){if(!Vo(this))throw Zo("readable");return this._readable}get writable(){if(!Vo(this))throw Zo("writable");return this._writable}}Object.defineProperties(gr.prototype,{readable:{enumerable:!0},writable:{enumerable:!0}}),typeof n.toStringTag=="symbol"&&Object.defineProperty(gr.prototype,n.toStringTag,{value:"TransformStream",configurable:!0});function la(e,t,r,s,f,c){function m(){return t}function _(N){return ha(e,N)}function D(N){return ma(e,N)}function W(){return ba(e)}e._writable=gs(m,_,W,D,r,s);function I(){return pa(e)}function L(N){return Sr(e,N),S(void 0)}e._readable=gn(m,I,L,f,c),e._backpressure=void 0,e._backpressureChangePromise=void 0,e._backpressureChangePromise_resolve=void 0,_r(e,!0),e._transformStreamController=void 0}function Vo(e){return!u(e)||!Object.prototype.hasOwnProperty.call(e,"_transformStreamController")?!1:e instanceof gr}function yr(e,t){ke(e._readable._readableStreamController,t),Sr(e,t)}function Sr(e,t){Yo(e._transformStreamController),fn(e._writable._writableStreamController,t),e._backpressure&&_r(e,!1)}function _r(e,t){e._backpressureChangePromise!==void 0&&e._backpressureChangePromise_resolve(),e._backpressureChangePromise=A(r=>{e._backpressureChangePromise_resolve=r}),e._backpressure=t}class Dt{constructor(){throw new TypeError("Illegal constructor")}get desiredSize(){if(!wr(this))throw Rr("desiredSize");let t=this._controlledTransformStream._readable._readableStreamController;return pn(t)}enqueue(t=void 0){if(!wr(this))throw Rr("enqueue");Go(this,t)}error(t=void 0){if(!wr(this))throw Rr("error");da(this,t)}terminate(){if(!wr(this))throw Rr("terminate");ca(this)}}Object.defineProperties(Dt.prototype,{enqueue:{enumerable:!0},error:{enumerable:!0},terminate:{enumerable:!0},desiredSize:{enumerable:!0}}),typeof n.toStringTag=="symbol"&&Object.defineProperty(Dt.prototype,n.toStringTag,{value:"TransformStreamDefaultController",configurable:!0});function wr(e){return!u(e)||!Object.prototype.hasOwnProperty.call(e,"_controlledTransformStream")?!1:e instanceof Dt}function ua(e,t,r,s){t._controlledTransformStream=e,e._transformStreamController=t,t._transformAlgorithm=r,t._flushAlgorithm=s}function fa(e,t){let r=Object.create(Dt.prototype),s=c=>{try{return Go(r,c),S(void 0)}catch(m){return p(m)}},f=()=>S(void 0);t.transform!==void 0&&(s=c=>t.transform(c,r)),t.flush!==void 0&&(f=()=>t.flush(r)),ua(e,r,s,f)}function Yo(e){e._transformAlgorithm=void 0,e._flushAlgorithm=void 0}function Go(e,t){let r=e._controlledTransformStream,s=r._readable._readableStreamController;if(!it(s))throw new TypeError("Readable side is not in a state that permits enqueue");try{hr(s,t)}catch(c){throw Sr(r,c),r._readable._storedError}Ns(s)!==r._backpressure&&_r(r,!0)}function da(e,t){yr(e._controlledTransformStream,t)}function Qo(e,t){let r=e._transformAlgorithm(t);return F(r,void 0,s=>{throw yr(e._controlledTransformStream,s),s})}function ca(e){let t=e._controlledTransformStream,r=t._readable._readableStreamController;Et(r);let s=new TypeError("TransformStream terminated");Sr(t,s)}function ha(e,t){let r=e._transformStreamController;if(e._backpressure){let s=e._backpressureChangePromise;return F(s,()=>{let f=e._writable;if(f._state==="erroring")throw f._storedError;return Qo(r,t)})}return Qo(r,t)}function ma(e,t){return yr(e,t),S(void 0)}function ba(e){let t=e._readable,r=e._transformStreamController,s=r._flushAlgorithm();return Yo(r),F(s,()=>{if(t._state==="errored")throw t._storedError;Et(t._readableStreamController)},f=>{throw yr(e,f),t._storedError})}function pa(e){return _r(e,!1),e._backpressureChangePromise}function Rr(e){return new TypeError(`TransformStreamDefaultController.prototype.${e} can only be used on a TransformStreamDefaultController`)}function Zo(e){return new TypeError(`TransformStream.prototype.${e} can only be used on a TransformStream`)}o.ByteLengthQueuingStrategy=br,o.CountQueuingStrategy=pr,o.ReadableByteStreamController=et,o.ReadableStream=Oe,o.ReadableStreamBYOBReader=wt,o.ReadableStreamBYOBRequest=yt,o.ReadableStreamDefaultController=ot,o.ReadableStreamDefaultReader=bt,o.TransformStream=gr,o.TransformStreamDefaultController=Dt,o.WritableStream=Tt,o.WritableStreamDefaultController=nt,o.WritableStreamDefaultWriter=Pt,Object.defineProperty(o,"__esModule",{value:!0})}))});var ii=_n(()=>{if(!globalThis.ReadableStream)try{let o=require("node:process"),{emitWarning:n}=o;try{o.emitWarning=()=>{},Object.assign(globalThis,require("node:stream/web")),o.emitWarning=n}catch(i){throw o.emitWarning=n,i}}catch{Object.assign(globalThis,oi())}try{let{Blob:o}=require("buffer");o&&!o.prototype.stream&&(o.prototype.stream=function(i){let a=0,l=this;return new ReadableStream({type:"bytes",async pull(u){let g=await l.slice(a,Math.min(l.size,a+65536)).arrayBuffer();a+=g.byteLength,u.enqueue(new Uint8Array(g)),a===l.size&&u.close()}})})}catch{}});async function*Rn(o,n=!0){for(let i of o)if("stream"in i)yield*i.stream();else if(ArrayBuffer.isView(i))if(n){let a=i.byteOffset,l=i.byteOffset+i.byteLength;for(;a!==l;){let u=Math.min(l-a,si),d=i.buffer.slice(a,a+u);a+=d.byteLength,yield new Uint8Array(d)}}else yield i;else{let a=0,l=i;for(;a!==l.size;){let d=await l.slice(a,Math.min(l.size,a+si)).arrayBuffer();a+=d.byteLength,yield new Uint8Array(d)}}}var rl,si,ai,Ca,Ce,Wt=Bt(()=>{rl=Le(ii(),1);si=65536;ai=class Tn{#e=[];#t="";#r=0;#n="transparent";constructor(n=[],i={}){if(typeof n!="object"||n===null)throw new TypeError("Failed to construct 'Blob': The provided value cannot be converted to a sequence.");if(typeof n[Symbol.iterator]!="function")throw new TypeError("Failed to construct 'Blob': The object must have a callable @@iterator property.");if(typeof i!="object"&&typeof i!="function")throw new TypeError("Failed to construct 'Blob': parameter 2 cannot convert to dictionary.");i===null&&(i={});let a=new TextEncoder;for(let u of n){let d;ArrayBuffer.isView(u)?d=new Uint8Array(u.buffer.slice(u.byteOffset,u.byteOffset+u.byteLength)):u instanceof ArrayBuffer?d=new Uint8Array(u.slice(0)):u instanceof Tn?d=u:d=a.encode(`${u}`),this.#r+=ArrayBuffer.isView(d)?d.byteLength:d.size,this.#e.push(d)}this.#n=`${i.endings===void 0?"transparent":i.endings}`;let l=i.type===void 0?"":String(i.type);this.#t=/^[\x20-\x7E]*$/.test(l)?l:""}get size(){return this.#r}get type(){return this.#t}async text(){let n=new TextDecoder,i="";for await(let a of Rn(this.#e,!1))i+=n.decode(a,{stream:!0});return i+=n.decode(),i}async arrayBuffer(){let n=new Uint8Array(this.size),i=0;for await(let a of Rn(this.#e,!1))n.set(a,i),i+=a.length;return n.buffer}stream(){let n=Rn(this.#e,!0);return new globalThis.ReadableStream({type:"bytes",async pull(i){let a=await n.next();a.done?i.close():i.enqueue(a.value)},async cancel(){await n.return()}})}slice(n=0,i=this.size,a=""){let{size:l}=this,u=n<0?Math.max(l+n,0):Math.min(n,l),d=i<0?Math.max(l+i,0):Math.min(i,l),g=Math.max(d-u,0),h=this.#e,y=[],k=0;for(let S of h){if(k>=g)break;let p=ArrayBuffer.isView(S)?S.byteLength:S.size;if(u&&p<=u)u-=p,d-=p;else{let b;ArrayBuffer.isView(S)?(b=S.subarray(u,Math.min(p,d)),k+=b.byteLength):(b=S.slice(u,Math.min(p,d)),k+=b.size),d-=p,y.push(b),u=0}}let A=new Tn([],{type:String(a).toLowerCase()});return A.#r=g,A.#e=y,A}get[Symbol.toStringTag](){return"Blob"}static[Symbol.hasInstance](n){return n&&typeof n=="object"&&typeof n.constructor=="function"&&(typeof n.stream=="function"||typeof n.arrayBuffer=="function")&&/^(Blob|File)$/.test(n[Symbol.toStringTag])}};Object.defineProperties(ai.prototype,{size:{enumerable:!0},type:{enumerable:!0},slice:{enumerable:!0}});Ca=ai,Ce=Ca});var Aa,Ea,dt,Pn=Bt(()=>{Wt();Aa=class extends Ce{#e=0;#t="";constructor(n,i,a={}){if(arguments.length<2)throw new TypeError(`Failed to construct 'File': 2 arguments required, but only ${arguments.length} present.`);super(n,a),a===null&&(a={});let l=a.lastModified===void 0?Date.now():Number(a.lastModified);Number.isNaN(l)||(this.#e=l),this.#t=String(i)}get name(){return this.#t}get lastModified(){return this.#e}get[Symbol.toStringTag](){return"File"}static[Symbol.hasInstance](n){return!!n&&n instanceof Ce&&/^(File)$/.test(n[Symbol.toStringTag])}},Ea=Aa,dt=Ea});function fi(o,n=Ce){var i=`${li()}${li()}`.replace(/\./g,"").slice(-28).padStart(32,"-"),a=[],l=`--${i}\r
Content-Disposition: form-data; name="`;return o.forEach((u,d)=>typeof u=="string"?a.push(l+Cn(d)+`"\r
\r
${u.replace(/\r(?!\n)|(?<!\r)\n/g,`\r
`)}\r
`):a.push(l+Cn(d)+`"; filename="${Cn(u.name,1)}"\r
Content-Type: ${u.type||"application/octet-stream"}\r
\r
`,u,`\r
`)),a.push(`--${i}--`),new n(a,{type:"multipart/form-data; boundary="+i})}var It,va,Da,li,Ba,ui,Cn,xe,Ve,Er=Bt(()=>{Wt();Pn();({toStringTag:It,iterator:va,hasInstance:Da}=Symbol),li=Math.random,Ba="append,set,get,getAll,delete,keys,values,entries,forEach,constructor".split(","),ui=(o,n,i)=>(o+="",/^(Blob|File)$/.test(n&&n[It])?[(i=i!==void 0?i+"":n[It]=="File"?n.name:"blob",o),n.name!==i||n[It]=="blob"?new dt([n],i,n):n]:[o,n+""]),Cn=(o,n)=>(n?o:o.replace(/\r?\n|\r/g,`\r
`)).replace(/\n/g,"%0A").replace(/\r/g,"%0D").replace(/"/g,"%22"),xe=(o,n,i)=>{if(n.length<i)throw new TypeError(`Failed to execute '${o}' on 'FormData': ${i} arguments required, but only ${n.length} present.`)},Ve=class{#e=[];constructor(...n){if(n.length)throw new TypeError("Failed to construct 'FormData': parameter 1 is not of type 'HTMLFormElement'.")}get[It](){return"FormData"}[va](){return this.entries()}static[Da](n){return n&&typeof n=="object"&&n[It]==="FormData"&&!Ba.some(i=>typeof n[i]!="function")}append(...n){xe("append",arguments,2),this.#e.push(ui(...n))}delete(n){xe("delete",arguments,1),n+="",this.#e=this.#e.filter(([i])=>i!==n)}get(n){xe("get",arguments,1),n+="";for(var i=this.#e,a=i.length,l=0;l<a;l++)if(i[l][0]===n)return i[l][1];return null}getAll(n,i){return xe("getAll",arguments,1),i=[],n+="",this.#e.forEach(a=>a[0]===n&&i.push(a[1])),i}has(n){return xe("has",arguments,1),n+="",this.#e.some(i=>i[0]===n)}forEach(n,i){xe("forEach",arguments,1);for(var[a,l]of this)n.call(i,l,a,this)}set(...n){xe("set",arguments,2);var i=[],a=!0;n=ui(...n),this.#e.forEach(l=>{l[0]===n[0]?a&&(a=!i.push(n)):i.push(l)}),a&&i.push(n),this.#e=i}*entries(){yield*this.#e}*keys(){for(var[n]of this)yield n}*values(){for(var[,n]of this)yield n}}});var mi=_n((bl,hi)=>{if(!globalThis.DOMException)try{let{MessageChannel:o}=require("worker_threads"),n=new o().port1,i=new ArrayBuffer;n.postMessage(i,[i,i])}catch(o){o.constructor.name==="DOMException"&&(globalThis.DOMException=o.constructor)}hi.exports=globalThis.DOMException});var Dr,ka,yl,En=Bt(()=>{Dr=require("node:fs"),ka=Le(mi(),1);Pn();Wt();({stat:yl}=Dr.promises)});var pi={};Ko(pi,{toFormData:()=>$a});function qa(o){let n=o.match(/\bfilename=("(.*?)"|([^()<>@,;:\\"/[\]?={}\s\t]+))($|;\s)/i);if(!n)return;let i=n[2]||n[3]||"",a=i.slice(i.lastIndexOf("\\")+1);return a=a.replace(/%22/g,'"'),a=a.replace(/&#(\d{4});/g,(l,u)=>String.fromCharCode(u)),a}async function $a(o,n){if(!/multipart/i.test(n))throw new TypeError("Failed to fetch");let i=n.match(/boundary=(?:"([^"]+)"|([^;]+))/i);if(!i)throw new TypeError("no or bad content-type header, no multipart boundary");let a=new vn(i[1]||i[2]),l,u,d,g,h,y,k=[],A=new Ve,S=E=>{d+=P.decode(E,{stream:!0})},p=E=>{k.push(E)},b=()=>{let E=new dt(k,y,{type:h});A.append(g,E)},C=()=>{A.append(g,d)},P=new TextDecoder("utf-8");P.decode(),a.onPartBegin=function(){a.onPartData=S,a.onPartEnd=C,l="",u="",d="",g="",h="",y=null,k.length=0},a.onHeaderField=function(E){l+=P.decode(E,{stream:!0})},a.onHeaderValue=function(E){u+=P.decode(E,{stream:!0})},a.onHeaderEnd=function(){if(u+=P.decode(),l=l.toLowerCase(),l==="content-disposition"){let E=u.match(/\bname=("([^"]*)"|([^()<>@,;:\\"/[\]?={}\s\t]+))/i);E&&(g=E[2]||E[3]||""),y=qa(u),y&&(a.onPartData=p,a.onPartEnd=b)}else l==="content-type"&&(h=u);u="",l=""};for await(let E of o)a.write(E);return a.end(),A}var ge,M,bi,qe,Br,kr,Oa,qt,Fa,Wa,Ia,La,Ye,vn,gi=Bt(()=>{En();Er();ge=0,M={START_BOUNDARY:ge++,HEADER_FIELD_START:ge++,HEADER_FIELD:ge++,HEADER_VALUE_START:ge++,HEADER_VALUE:ge++,HEADER_VALUE_ALMOST_DONE:ge++,HEADERS_ALMOST_DONE:ge++,PART_DATA_START:ge++,PART_DATA:ge++,END:ge++},bi=1,qe={PART_BOUNDARY:bi,LAST_BOUNDARY:bi*=2},Br=10,kr=13,Oa=32,qt=45,Fa=58,Wa=97,Ia=122,La=o=>o|32,Ye=()=>{},vn=class{constructor(n){this.index=0,this.flags=0,this.onHeaderEnd=Ye,this.onHeaderField=Ye,this.onHeadersEnd=Ye,this.onHeaderValue=Ye,this.onPartBegin=Ye,this.onPartData=Ye,this.onPartEnd=Ye,this.boundaryChars={},n=`\r
--`+n;let i=new Uint8Array(n.length);for(let a=0;a<n.length;a++)i[a]=n.charCodeAt(a),this.boundaryChars[i[a]]=!0;this.boundary=i,this.lookbehind=new Uint8Array(this.boundary.length+8),this.state=M.START_BOUNDARY}write(n){let i=0,a=n.length,l=this.index,{lookbehind:u,boundary:d,boundaryChars:g,index:h,state:y,flags:k}=this,A=this.boundary.length,S=A-1,p=n.length,b,C,P=w=>{this[w+"Mark"]=i},E=w=>{delete this[w+"Mark"]},F=(w,z,B,x)=>{(z===void 0||z!==B)&&this[w](x&&x.subarray(z,B))},v=(w,z)=>{let B=w+"Mark";B in this&&(z?(F(w,this[B],i,n),delete this[B]):(F(w,this[B],n.length,n),this[B]=0))};for(i=0;i<a;i++)switch(b=n[i],y){case M.START_BOUNDARY:if(h===d.length-2){if(b===qt)k|=qe.LAST_BOUNDARY;else if(b!==kr)return;h++;break}else if(h-1===d.length-2){if(k&qe.LAST_BOUNDARY&&b===qt)y=M.END,k=0;else if(!(k&qe.LAST_BOUNDARY)&&b===Br)h=0,F("onPartBegin"),y=M.HEADER_FIELD_START;else return;break}b!==d[h+2]&&(h=-2),b===d[h+2]&&h++;break;case M.HEADER_FIELD_START:y=M.HEADER_FIELD,P("onHeaderField"),h=0;case M.HEADER_FIELD:if(b===kr){E("onHeaderField"),y=M.HEADERS_ALMOST_DONE;break}if(h++,b===qt)break;if(b===Fa){if(h===1)return;v("onHeaderField",!0),y=M.HEADER_VALUE_START;break}if(C=La(b),C<Wa||C>Ia)return;break;case M.HEADER_VALUE_START:if(b===Oa)break;P("onHeaderValue"),y=M.HEADER_VALUE;case M.HEADER_VALUE:b===kr&&(v("onHeaderValue",!0),F("onHeaderEnd"),y=M.HEADER_VALUE_ALMOST_DONE);break;case M.HEADER_VALUE_ALMOST_DONE:if(b!==Br)return;y=M.HEADER_FIELD_START;break;case M.HEADERS_ALMOST_DONE:if(b!==Br)return;F("onHeadersEnd"),y=M.PART_DATA_START;break;case M.PART_DATA_START:y=M.PART_DATA,P("onPartData");case M.PART_DATA:if(l=h,h===0){for(i+=S;i<p&&!(n[i]in g);)i+=A;i-=S,b=n[i]}if(h<d.length)d[h]===b?(h===0&&v("onPartData",!0),h++):h=0;else if(h===d.length)h++,b===kr?k|=qe.PART_BOUNDARY:b===qt?k|=qe.LAST_BOUNDARY:h=0;else if(h-1===d.length)if(k&qe.PART_BOUNDARY){if(h=0,b===Br){k&=~qe.PART_BOUNDARY,F("onPartEnd"),F("onPartBegin"),y=M.HEADER_FIELD_START;break}}else k&qe.LAST_BOUNDARY&&b===qt?(F("onPartEnd"),y=M.END,k=0):h=0;if(h>0)u[h-1]=b;else if(l>0){let w=new Uint8Array(u.buffer,u.byteOffset,u.byteLength);F("onPartData",0,l,w),l=0,P("onPartData"),i--}break;case M.END:break;default:throw new Error(`Unexpected state entered: ${y}`)}v("onHeaderField"),v("onHeaderValue"),v("onPartData"),this.index=h,this.state=y,this.flags=k}end(){if(this.state===M.HEADER_FIELD_START&&this.index===0||this.state===M.PART_DATA&&this.index===this.boundary.length)this.onPartEnd();else if(this.state!==M.END)throw new Error("MultipartParser.end(): stream ended unexpectedly")}}});var Ga={};Ko(Ga,{default:()=>Hi});module.exports=Ra(Ga);var ft=require("@raycast/api"),Cr=require("react"),kt="favoriteSubreddits",Ta=()=>{let[o,n]=(0,Cr.useState)([]),i=async l=>{let u=await ft.LocalStorage.getItem(kt),d=u?JSON.parse(u.toString()):[];d.some(g=>g===l)||(d.push(l),await ft.LocalStorage.setItem(kt,JSON.stringify(d)),n(d))},a=async l=>{let u=await ft.LocalStorage.getItem(kt),d=u?JSON.parse(u.toString()):[];if(!d.some(y=>y===l))return;let g=d.indexOf(l),h=[...d.slice(0,g),...d.slice(g+1)];await ft.LocalStorage.setItem(kt,JSON.stringify(h)),n(h)};return(0,Cr.useEffect)(()=>{(async()=>{let u=await ft.LocalStorage.getItem(kt);if(!u){n([]);return}let d=JSON.parse(u.toString());n(d)})()},[]),[o,i,a]},ei=Ta;var j=require("@raycast/api"),be=require("react");var ti="https://www.reddit.com",wn=(o,n)=>{let i=o.endsWith("/")?o.substring(0,o.length-1):o,a=n.startsWith("/")?n.substring(1):n;return i+"/"+a},Ot=o=>wn(ti,o),Ft=(o="",n=!1,i="",a="",l=0,u="",d="")=>{let g=ti;if(o&&(g=wn(g,o)),i?g=wn(g,n?"search.json":"search"):g=g+(n?".json":""),o||i||a||l||u){let h=new URLSearchParams;o&&h.append("restrict_sr","true"),i&&h.append("q",i),a&&h.append("type",a),l&&h.append("limit",l.toString()),u&&h.append("sort",u),d&&h.append("after",d),g=g+"?"+h.toString()}return g};var $=require("@raycast/api");var Oi=Le(require("node:http"),1),Fi=Le(require("node:https"),1),Qe=Le(require("node:zlib"),1),oe=Le(require("node:stream"),1),zt=require("node:buffer");function Pa(o){if(!/^data:/i.test(o))throw new TypeError('`uri` does not appear to be a Data URI (must begin with "data:")');o=o.replace(/\r?\n/g,"");let n=o.indexOf(",");if(n===-1||n<=4)throw new TypeError("malformed data: URI");let i=o.substring(5,n).split(";"),a="",l=!1,u=i[0]||"text/plain",d=u;for(let k=1;k<i.length;k++)i[k]==="base64"?l=!0:(d+=`;${i[k]}`,i[k].indexOf("charset=")===0&&(a=i[k].substring(8)));!i[0]&&!a.length&&(d+=";charset=US-ASCII",a="US-ASCII");let g=l?"base64":"ascii",h=unescape(o.substring(n+1)),y=Buffer.from(h,g);return y.type=u,y.typeFull=d,y.charset=a,y}var ri=Pa;var se=Le(require("node:stream"),1),Ee=require("node:util"),ne=require("node:buffer");Wt();Er();var Ae=class extends Error{constructor(n,i){super(n),Error.captureStackTrace(this,this.constructor),this.type=i}get name(){return this.constructor.name}get[Symbol.toStringTag](){return this.constructor.name}};var ee=class extends Ae{constructor(n,i,a){super(n,i),a&&(this.code=this.errno=a.code,this.erroredSysCall=a.syscall)}};var vr=Symbol.toStringTag,An=o=>typeof o=="object"&&typeof o.append=="function"&&typeof o.delete=="function"&&typeof o.get=="function"&&typeof o.getAll=="function"&&typeof o.has=="function"&&typeof o.set=="function"&&typeof o.sort=="function"&&o[vr]==="URLSearchParams",Lt=o=>o&&typeof o=="object"&&typeof o.arrayBuffer=="function"&&typeof o.type=="string"&&typeof o.stream=="function"&&typeof o.constructor=="function"&&/^(Blob|File)$/.test(o[vr]),di=o=>typeof o=="object"&&(o[vr]==="AbortSignal"||o[vr]==="EventTarget"),ci=(o,n)=>{let i=new URL(n).hostname,a=new URL(o).hostname;return i===a||i.endsWith(`.${a}`)};var za=(0,Ee.promisify)(se.default.pipeline),te=Symbol("Body internals"),ye=class{constructor(n,{size:i=0}={}){let a=null;n===null?n=null:An(n)?n=ne.Buffer.from(n.toString()):Lt(n)||ne.Buffer.isBuffer(n)||(Ee.types.isAnyArrayBuffer(n)?n=ne.Buffer.from(n):ArrayBuffer.isView(n)?n=ne.Buffer.from(n.buffer,n.byteOffset,n.byteLength):n instanceof se.default||(n instanceof Ve?(n=fi(n),a=n.type.split("=")[1]):n=ne.Buffer.from(String(n))));let l=n;ne.Buffer.isBuffer(n)?l=se.default.Readable.from(n):Lt(n)&&(l=se.default.Readable.from(n.stream())),this[te]={body:n,stream:l,boundary:a,disturbed:!1,error:null},this.size=i,n instanceof se.default&&n.on("error",u=>{let d=u instanceof Ae?u:new ee(`Invalid response body while trying to fetch ${this.url}: ${u.message}`,"system",u);this[te].error=d})}get body(){return this[te].stream}get bodyUsed(){return this[te].disturbed}async arrayBuffer(){let{buffer:n,byteOffset:i,byteLength:a}=await Or(this);return n.slice(i,i+a)}async formData(){let n=this.headers.get("content-type");if(n.startsWith("application/x-www-form-urlencoded")){let a=new Ve,l=new URLSearchParams(await this.text());for(let[u,d]of l)a.append(u,d);return a}let{toFormData:i}=await Promise.resolve().then(()=>(gi(),pi));return i(this.body,n)}async blob(){let n=this.headers&&this.headers.get("content-type")||this[te].body&&this[te].body.type||"",i=await this.arrayBuffer();return new Ce([i],{type:n})}async json(){let n=await Or(this);return JSON.parse(n.toString())}async text(){return(await Or(this)).toString()}buffer(){return Or(this)}};ye.prototype.buffer=(0,Ee.deprecate)(ye.prototype.buffer,"Please use 'response.arrayBuffer()' instead of 'response.buffer()'","node-fetch#buffer");Object.defineProperties(ye.prototype,{body:{enumerable:!0},bodyUsed:{enumerable:!0},arrayBuffer:{enumerable:!0},blob:{enumerable:!0},json:{enumerable:!0},text:{enumerable:!0},data:{get:(0,Ee.deprecate)(()=>{},"data doesn't exist, use json(), text(), arrayBuffer(), or body instead","https://github.com/node-fetch/node-fetch/issues/1000 (response)")}});async function Or(o){if(o[te].disturbed)throw new TypeError(`body used already for: ${o.url}`);if(o[te].disturbed=!0,o[te].error)throw o[te].error;let{body:n}=o;if(n===null)return ne.Buffer.alloc(0);if(!(n instanceof se.default))return ne.Buffer.alloc(0);let i=[],a=0;try{for await(let l of n){if(o.size>0&&a+l.length>o.size){let u=new ee(`content size at ${o.url} over limit: ${o.size}`,"max-size");throw n.destroy(u),u}a+=l.length,i.push(l)}}catch(l){throw l instanceof Ae?l:new ee(`Invalid response body while trying to fetch ${o.url}: ${l.message}`,"system",l)}if(n.readableEnded===!0||n._readableState.ended===!0)try{return i.every(l=>typeof l=="string")?ne.Buffer.from(i.join("")):ne.Buffer.concat(i,a)}catch(l){throw new ee(`Could not create Buffer from response body for ${o.url}: ${l.message}`,"system",l)}else throw new ee(`Premature close of server response while trying to fetch ${o.url}`)}var ct=(o,n)=>{let i,a,{body:l}=o[te];if(o.bodyUsed)throw new Error("cannot clone body after it is used");return l instanceof se.default&&typeof l.getBoundary!="function"&&(i=new se.PassThrough({highWaterMark:n}),a=new se.PassThrough({highWaterMark:n}),l.pipe(i),l.pipe(a),o[te].stream=i,l=a),l},Ua=(0,Ee.deprecate)(o=>o.getBoundary(),"form-data doesn't follow the spec and requires special treatment. Use alternative package","https://github.com/node-fetch/node-fetch/issues/1167"),Fr=(o,n)=>o===null?null:typeof o=="string"?"text/plain;charset=UTF-8":An(o)?"application/x-www-form-urlencoded;charset=UTF-8":Lt(o)?o.type||null:ne.Buffer.isBuffer(o)||Ee.types.isAnyArrayBuffer(o)||ArrayBuffer.isView(o)?null:o instanceof Ve?`multipart/form-data; boundary=${n[te].boundary}`:o&&typeof o.getBoundary=="function"?`multipart/form-data;boundary=${Ua(o)}`:o instanceof se.default?null:"text/plain;charset=UTF-8",yi=o=>{let{body:n}=o[te];return n===null?0:Lt(n)?n.size:ne.Buffer.isBuffer(n)?n.length:n&&typeof n.getLengthSync=="function"&&n.hasKnownLength&&n.hasKnownLength()?n.getLengthSync():null},Si=async(o,{body:n})=>{n===null?o.end():await za(n,o)};var Dn=require("node:util"),$t=Le(require("node:http"),1),Wr=typeof $t.default.validateHeaderName=="function"?$t.default.validateHeaderName:o=>{if(!/^[\^`\-\w!#$%&'*+.|~]+$/.test(o)){let n=new TypeError(`Header name must be a valid HTTP token [${o}]`);throw Object.defineProperty(n,"code",{value:"ERR_INVALID_HTTP_TOKEN"}),n}},Bn=typeof $t.default.validateHeaderValue=="function"?$t.default.validateHeaderValue:(o,n)=>{if(/[^\t\u0020-\u007E\u0080-\u00FF]/.test(n)){let i=new TypeError(`Invalid character in header content ["${o}"]`);throw Object.defineProperty(i,"code",{value:"ERR_INVALID_CHAR"}),i}},ae=class o extends URLSearchParams{constructor(n){let i=[];if(n instanceof o){let a=n.raw();for(let[l,u]of Object.entries(a))i.push(...u.map(d=>[l,d]))}else if(n!=null)if(typeof n=="object"&&!Dn.types.isBoxedPrimitive(n)){let a=n[Symbol.iterator];if(a==null)i.push(...Object.entries(n));else{if(typeof a!="function")throw new TypeError("Header pairs must be iterable");i=[...n].map(l=>{if(typeof l!="object"||Dn.types.isBoxedPrimitive(l))throw new TypeError("Each header pair must be an iterable object");return[...l]}).map(l=>{if(l.length!==2)throw new TypeError("Each header pair must be a name/value tuple");return[...l]})}}else throw new TypeError("Failed to construct 'Headers': The provided value is not of type '(sequence<sequence<ByteString>> or record<ByteString, ByteString>)");return i=i.length>0?i.map(([a,l])=>(Wr(a),Bn(a,String(l)),[String(a).toLowerCase(),String(l)])):void 0,super(i),new Proxy(this,{get(a,l,u){switch(l){case"append":case"set":return(d,g)=>(Wr(d),Bn(d,String(g)),URLSearchParams.prototype[l].call(a,String(d).toLowerCase(),String(g)));case"delete":case"has":case"getAll":return d=>(Wr(d),URLSearchParams.prototype[l].call(a,String(d).toLowerCase()));case"keys":return()=>(a.sort(),new Set(URLSearchParams.prototype.keys.call(a)).keys());default:return Reflect.get(a,l,u)}}})}get[Symbol.toStringTag](){return this.constructor.name}toString(){return Object.prototype.toString.call(this)}get(n){let i=this.getAll(n);if(i.length===0)return null;let a=i.join(", ");return/^content-encoding$/i.test(n)&&(a=a.toLowerCase()),a}forEach(n,i=void 0){for(let a of this.keys())Reflect.apply(n,i,[this.get(a),a,this])}*values(){for(let n of this.keys())yield this.get(n)}*entries(){for(let n of this.keys())yield[n,this.get(n)]}[Symbol.iterator](){return this.entries()}raw(){return[...this.keys()].reduce((n,i)=>(n[i]=this.getAll(i),n),{})}[Symbol.for("nodejs.util.inspect.custom")](){return[...this.keys()].reduce((n,i)=>{let a=this.getAll(i);return i==="host"?n[i]=a[0]:n[i]=a.length>1?a:a[0],n},{})}};Object.defineProperties(ae.prototype,["get","entries","forEach","values"].reduce((o,n)=>(o[n]={enumerable:!0},o),{}));function _i(o=[]){return new ae(o.reduce((n,i,a,l)=>(a%2===0&&n.push(l.slice(a,a+2)),n),[]).filter(([n,i])=>{try{return Wr(n),Bn(n,String(i)),!0}catch{return!1}}))}var Ma=new Set([301,302,303,307,308]),Ir=o=>Ma.has(o);var me=Symbol("Response internals"),le=class o extends ye{constructor(n=null,i={}){super(n,i);let a=i.status!=null?i.status:200,l=new ae(i.headers);if(n!==null&&!l.has("Content-Type")){let u=Fr(n,this);u&&l.append("Content-Type",u)}this[me]={type:"default",url:i.url,status:a,statusText:i.statusText||"",headers:l,counter:i.counter,highWaterMark:i.highWaterMark}}get type(){return this[me].type}get url(){return this[me].url||""}get status(){return this[me].status}get ok(){return this[me].status>=200&&this[me].status<300}get redirected(){return this[me].counter>0}get statusText(){return this[me].statusText}get headers(){return this[me].headers}get highWaterMark(){return this[me].highWaterMark}clone(){return new o(ct(this,this.highWaterMark),{type:this.type,url:this.url,status:this.status,statusText:this.statusText,headers:this.headers,ok:this.ok,redirected:this.redirected,size:this.size,highWaterMark:this.highWaterMark})}static redirect(n,i=302){if(!Ir(i))throw new RangeError('Failed to execute "redirect" on "response": Invalid status code');return new o(null,{headers:{location:new URL(n).toString()},status:i})}static error(){let n=new o(null,{status:0,statusText:""});return n[me].type="error",n}get[Symbol.toStringTag](){return"Response"}};Object.defineProperties(le.prototype,{type:{enumerable:!0},url:{enumerable:!0},status:{enumerable:!0},ok:{enumerable:!0},redirected:{enumerable:!0},statusText:{enumerable:!0},headers:{enumerable:!0},clone:{enumerable:!0}});var Di=require("node:url"),Bi=require("node:util");var wi=o=>{if(o.search)return o.search;let n=o.href.length-1,i=o.hash||(o.href[n]==="#"?"#":"");return o.href[n-i.length]==="?"?"?":""};var Ti=require("node:net");function Ri(o,n=!1){return o==null||(o=new URL(o),/^(about|blob|data):$/.test(o.protocol))?"no-referrer":(o.username="",o.password="",o.hash="",n&&(o.pathname="",o.search=""),o)}var Pi=new Set(["","no-referrer","no-referrer-when-downgrade","same-origin","origin","strict-origin","origin-when-cross-origin","strict-origin-when-cross-origin","unsafe-url"]),Ci="strict-origin-when-cross-origin";function Ai(o){if(!Pi.has(o))throw new TypeError(`Invalid referrerPolicy: ${o}`);return o}function ja(o){if(/^(http|ws)s:$/.test(o.protocol))return!0;let n=o.host.replace(/(^\[)|(]$)/g,""),i=(0,Ti.isIP)(n);return i===4&&/^127\./.test(n)||i===6&&/^(((0+:){7})|(::(0+:){0,6}))0*1$/.test(n)?!0:/^(.+\.)*localhost$/.test(o.host)?!1:o.protocol==="file:"}function ht(o){return/^about:(blank|srcdoc)$/.test(o)||o.protocol==="data:"||/^(blob|filesystem):$/.test(o.protocol)?!0:ja(o)}function Ei(o,{referrerURLCallback:n,referrerOriginCallback:i}={}){if(o.referrer==="no-referrer"||o.referrerPolicy==="")return null;let a=o.referrerPolicy;if(o.referrer==="about:client")return"no-referrer";let l=o.referrer,u=Ri(l),d=Ri(l,!0);u.toString().length>4096&&(u=d),n&&(u=n(u)),i&&(d=i(d));let g=new URL(o.url);switch(a){case"no-referrer":return"no-referrer";case"origin":return d;case"unsafe-url":return u;case"strict-origin":return ht(u)&&!ht(g)?"no-referrer":d.toString();case"strict-origin-when-cross-origin":return u.origin===g.origin?u:ht(u)&&!ht(g)?"no-referrer":d;case"same-origin":return u.origin===g.origin?u:"no-referrer";case"origin-when-cross-origin":return u.origin===g.origin?u:d;case"no-referrer-when-downgrade":return ht(u)&&!ht(g)?"no-referrer":u;default:throw new TypeError(`Invalid referrerPolicy: ${a}`)}}function vi(o){let n=(o.get("referrer-policy")||"").split(/[,\s]+/),i="";for(let a of n)a&&Pi.has(a)&&(i=a);return i}var V=Symbol("Request internals"),Lr=o=>typeof o=="object"&&typeof o[V]=="object",Na=(0,Bi.deprecate)(()=>{},".data is not a valid RequestInit property, use .body instead","https://github.com/node-fetch/node-fetch/issues/1000 (request)"),Ge=class o extends ye{constructor(n,i={}){let a;if(Lr(n)?a=new URL(n.url):(a=new URL(n),n={}),a.username!==""||a.password!=="")throw new TypeError(`${a} is an url with embedded credentials.`);let l=i.method||n.method||"GET";if(l=l.toUpperCase(),"data"in i&&Na(),(i.body!=null||Lr(n)&&n.body!==null)&&(l==="GET"||l==="HEAD"))throw new TypeError("Request with GET/HEAD method cannot have body");let u=i.body?i.body:Lr(n)&&n.body!==null?ct(n):null;super(u,{size:i.size||n.size||0});let d=new ae(i.headers||n.headers||{});if(u!==null&&!d.has("Content-Type")){let y=Fr(u,this);y&&d.set("Content-Type",y)}let g=Lr(n)?n.signal:null;if("signal"in i&&(g=i.signal),g!=null&&!di(g))throw new TypeError("Expected signal to be an instanceof AbortSignal or EventTarget");let h=i.referrer==null?n.referrer:i.referrer;if(h==="")h="no-referrer";else if(h){let y=new URL(h);h=/^about:(\/\/)?client$/.test(y)?"client":y}else h=void 0;this[V]={method:l,redirect:i.redirect||n.redirect||"follow",headers:d,parsedURL:a,signal:g,referrer:h},this.follow=i.follow===void 0?n.follow===void 0?20:n.follow:i.follow,this.compress=i.compress===void 0?n.compress===void 0?!0:n.compress:i.compress,this.counter=i.counter||n.counter||0,this.agent=i.agent||n.agent,this.highWaterMark=i.highWaterMark||n.highWaterMark||16384,this.insecureHTTPParser=i.insecureHTTPParser||n.insecureHTTPParser||!1,this.referrerPolicy=i.referrerPolicy||n.referrerPolicy||""}get method(){return this[V].method}get url(){return(0,Di.format)(this[V].parsedURL)}get headers(){return this[V].headers}get redirect(){return this[V].redirect}get signal(){return this[V].signal}get referrer(){if(this[V].referrer==="no-referrer")return"";if(this[V].referrer==="client")return"about:client";if(this[V].referrer)return this[V].referrer.toString()}get referrerPolicy(){return this[V].referrerPolicy}set referrerPolicy(n){this[V].referrerPolicy=Ai(n)}clone(){return new o(this)}get[Symbol.toStringTag](){return"Request"}};Object.defineProperties(Ge.prototype,{method:{enumerable:!0},url:{enumerable:!0},headers:{enumerable:!0},redirect:{enumerable:!0},clone:{enumerable:!0},signal:{enumerable:!0},referrer:{enumerable:!0},referrerPolicy:{enumerable:!0}});var ki=o=>{let{parsedURL:n}=o[V],i=new ae(o[V].headers);i.has("Accept")||i.set("Accept","*/*");let a=null;if(o.body===null&&/^(post|put)$/i.test(o.method)&&(a="0"),o.body!==null){let g=yi(o);typeof g=="number"&&!Number.isNaN(g)&&(a=String(g))}a&&i.set("Content-Length",a),o.referrerPolicy===""&&(o.referrerPolicy=Ci),o.referrer&&o.referrer!=="no-referrer"?o[V].referrer=Ei(o):o[V].referrer="no-referrer",o[V].referrer instanceof URL&&i.set("Referer",o.referrer),i.has("User-Agent")||i.set("User-Agent","node-fetch"),o.compress&&!i.has("Accept-Encoding")&&i.set("Accept-Encoding","gzip,deflate,br");let{agent:l}=o;typeof l=="function"&&(l=l(n)),!i.has("Connection")&&!l&&i.set("Connection","close");let u=wi(n),d={path:n.pathname+u,method:o.method,headers:i[Symbol.for("nodejs.util.inspect.custom")](),insecureHTTPParser:o.insecureHTTPParser,agent:l};return{parsedURL:n,options:d}};var Se=class extends Ae{constructor(n,i="aborted"){super(n,i)}};Er();En();var Ha=new Set(["data:","http:","https:"]);async function Ut(o,n){return new Promise((i,a)=>{let l=new Ge(o,n),{parsedURL:u,options:d}=ki(l);if(!Ha.has(u.protocol))throw new TypeError(`node-fetch cannot load ${o}. URL scheme "${u.protocol.replace(/:$/,"")}" is not supported.`);if(u.protocol==="data:"){let b=ri(l.url),C=new le(b,{headers:{"Content-Type":b.typeFull}});i(C);return}let g=(u.protocol==="https:"?Fi.default:Oi.default).request,{signal:h}=l,y=null,k=()=>{let b=new Se("The operation was aborted.");a(b),l.body&&l.body instanceof oe.default.Readable&&l.body.destroy(b),!(!y||!y.body)&&y.body.emit("error",b)};if(h&&h.aborted){k();return}let A=()=>{k(),p()},S=g(u.toString(),d);h&&h.addEventListener("abort",A);let p=()=>{S.abort(),h&&h.removeEventListener("abort",A)};S.on("error",b=>{a(new ee(`request to ${l.url} failed, reason: ${b.message}`,"system",b)),p()}),xa(S,b=>{y.body.destroy(b)}),process.version<"v14"&&S.on("socket",b=>{let C;b.prependListener("end",()=>{C=b._eventsCount}),b.prependListener("close",P=>{if(y&&C<b._eventsCount&&!P){let E=new Error("Premature close");E.code="ERR_STREAM_PREMATURE_CLOSE",y.body.emit("error",E)}})}),S.on("response",b=>{S.setTimeout(0);let C=_i(b.rawHeaders);if(Ir(b.statusCode)){let w=C.get("Location"),z=null;try{z=w===null?null:new URL(w,l.url)}catch{if(l.redirect!=="manual"){a(new ee(`uri requested responds with an invalid redirect URL: ${w}`,"invalid-redirect")),p();return}}switch(l.redirect){case"error":a(new ee(`uri requested responds with a redirect, redirect mode is set to error: ${l.url}`,"no-redirect")),p();return;case"manual":break;case"follow":{if(z===null)break;if(l.counter>=l.follow){a(new ee(`maximum redirect reached at: ${l.url}`,"max-redirect")),p();return}let B={headers:new ae(l.headers),follow:l.follow,counter:l.counter+1,agent:l.agent,compress:l.compress,method:l.method,body:ct(l),signal:l.signal,size:l.size,referrer:l.referrer,referrerPolicy:l.referrerPolicy};if(!ci(l.url,z))for(let Q of["authorization","www-authenticate","cookie","cookie2"])B.headers.delete(Q);if(b.statusCode!==303&&l.body&&n.body instanceof oe.default.Readable){a(new ee("Cannot follow redirect with body being a readable stream","unsupported-redirect")),p();return}(b.statusCode===303||(b.statusCode===301||b.statusCode===302)&&l.method==="POST")&&(B.method="GET",B.body=void 0,B.headers.delete("content-length"));let x=vi(C);x&&(B.referrerPolicy=x),i(Ut(new Ge(z,B))),p();return}default:return a(new TypeError(`Redirect option '${l.redirect}' is not a valid value of RequestRedirect`))}}h&&b.once("end",()=>{h.removeEventListener("abort",A)});let P=(0,oe.pipeline)(b,new oe.PassThrough,w=>{w&&a(w)});process.version<"v12.10"&&b.on("aborted",A);let E={url:l.url,status:b.statusCode,statusText:b.statusMessage,headers:C,size:l.size,counter:l.counter,highWaterMark:l.highWaterMark},F=C.get("Content-Encoding");if(!l.compress||l.method==="HEAD"||F===null||b.statusCode===204||b.statusCode===304){y=new le(P,E),i(y);return}let v={flush:Qe.default.Z_SYNC_FLUSH,finishFlush:Qe.default.Z_SYNC_FLUSH};if(F==="gzip"||F==="x-gzip"){P=(0,oe.pipeline)(P,Qe.default.createGunzip(v),w=>{w&&a(w)}),y=new le(P,E),i(y);return}if(F==="deflate"||F==="x-deflate"){let w=(0,oe.pipeline)(b,new oe.PassThrough,z=>{z&&a(z)});w.once("data",z=>{(z[0]&15)===8?P=(0,oe.pipeline)(P,Qe.default.createInflate(),B=>{B&&a(B)}):P=(0,oe.pipeline)(P,Qe.default.createInflateRaw(),B=>{B&&a(B)}),y=new le(P,E),i(y)}),w.once("end",()=>{y||(y=new le(P,E),i(y))});return}if(F==="br"){P=(0,oe.pipeline)(P,Qe.default.createBrotliDecompress(),w=>{w&&a(w)}),y=new le(P,E),i(y);return}y=new le(P,E),i(y)}),Si(S,l).catch(a)})}function xa(o,n){let i=zt.Buffer.from(`0\r
\r
`),a=!1,l=!1,u;o.on("response",d=>{let{headers:g}=d;a=g["transfer-encoding"]==="chunked"&&!g["content-length"]}),o.on("socket",d=>{let g=()=>{if(a&&!l){let h=new Error("Premature close");h.code="ERR_STREAM_PREMATURE_CLOSE",n(h)}};d.prependListener("close",g),o.on("abort",()=>{d.removeListener("close",g)}),d.on("data",h=>{l=zt.Buffer.compare(h.slice(-5),i)===0,!l&&u&&(l=zt.Buffer.compare(u.slice(-3),i.slice(0,3))===0&&zt.Buffer.compare(h.slice(-2),i.slice(3))===0),u=h})})}var ve=require("react");var qr=async(o,n,i,a,l,u)=>{let d=await Ut(Ft(o,!0,n,"",i,a,l),{method:"get",signal:u?.signal});if(!d.ok)throw new Error(d.statusText);let g=await d.json();return{url:Ft(o,!1,n,"",0,a),items:g.data&&g.data.children?g.data.children.map(h=>({id:h.data.id,title:h.data.title,url:Ot(h.data.permalink),contentUrl:h.data.url.indexOf(h.data.permalink)>-1?"":h.data.url,description:h.data.selftext,imageUrl:h.data.is_video||h.data.url_overridden_by_dest&&!h.data.url_overridden_by_dest.endsWith(".jpg")&&!h.data.url_overridden_by_dest.endsWith(".gif")&&!h.data.url_overridden_by_dest.endsWith(".png")?"":h.data.url_overridden_by_dest,created:new Date(h.data.created_utc*1e3).toLocaleString(),thumbnail:h.data.thumbnail,subreddit:h.data.subreddit,afterId:`${h.kind}_${h.data.id}`})):[]}},Wi=async(o,n,i,a)=>{let l=await Ut(Ft("",!0,o,"sr",n,"",i),{method:"get",signal:a?.signal});if(!l.ok)throw new Error(l.statusText);let u=await l.json();return{url:Ft("",!1,o,"sr",0),subreddits:u.data&&u.data.children?u.data.children.map(d=>({id:d.data.id,title:d.data.title,url:Ot(d.data.url),subreddit:d.data.url,created:new Date(d.data.created_utc*1e3).toLocaleString(),subredditName:d.data.display_name_prefixed.substring(2),afterId:`${d.kind}_${d.data.id}`})):[]}};var mt=require("@raycast/api");var ue=require("react");var Z=require("@raycast/api");var T=require("@raycast/api"),q=require("react/jsx-runtime");function kn({data:o,showDetail:n,toggleDetail:i}){if(o.description){let a=(0,q.jsx)(T.Action.OpenInBrowser,{url:o.url,icon:T.Icon.Globe},"browser"),l=(0,q.jsx)(T.Action.Push,{title:"Show Full Details",icon:T.Icon.TextDocument,target:(0,q.jsx)(T.Detail,{navigationTitle:o.title,markdown:`# ${o.title}
*Posted ${o.created}, r/${o.subreddit}*
        
${o.description}`,actions:(0,q.jsx)(T.ActionPanel,{children:(0,q.jsx)(T.Action.OpenInBrowser,{url:o.url,icon:T.Icon.Globe})})})},"showFullDetails"),u=[];return n?(u.push(a),u.push(l)):(u.push(l),u.push(a)),(0,q.jsxs)(T.ActionPanel,{children:[...u,(0,q.jsx)(T.Action,{title:"Toggle Details",icon:T.Icon.Sidebar,shortcut:{modifiers:["cmd","shift"],key:"d"},onAction:()=>i()})]})}else if(o.imageUrl){let a=(0,q.jsx)(T.Action.OpenInBrowser,{url:o.url,icon:T.Icon.Globe},"browser"),l=(0,q.jsx)(T.Action.Push,{title:"Show Full Details",icon:T.Icon.TextDocument,target:(0,q.jsx)(T.Detail,{navigationTitle:o.title,markdown:`# ${o.title}
*Posted ${o.created}, r/${o.subreddit}*
        
![${o.title}](${o.imageUrl} "${o.title}}")`,actions:(0,q.jsx)(T.ActionPanel,{children:(0,q.jsx)(T.Action.OpenInBrowser,{url:o.url,icon:T.Icon.Globe})})})},"showFullDetails"),u=[];return n?(u.push(a),u.push(l)):(u.push(l),u.push(a)),(0,q.jsxs)(T.ActionPanel,{children:[...u,(0,q.jsx)(T.Action,{title:"Toggle Details",icon:T.Icon.Sidebar,shortcut:{modifiers:["cmd","shift"],key:"d"},onAction:()=>i()})]})}else if(o.contentUrl){let a=(0,q.jsx)(T.Action.OpenInBrowser,{url:o.url,icon:T.Icon.Globe},"browser"),l=(0,q.jsx)(T.Action.Push,{title:"Show Full Details",icon:T.Icon.TextDocument,target:(0,q.jsx)(T.Detail,{navigationTitle:o.title,markdown:`# ${o.title}
*Posted ${o.created}, r/${o.subreddit}*
        
${o.contentUrl}`,actions:(0,q.jsxs)(T.ActionPanel,{children:[(0,q.jsx)(T.Action.OpenInBrowser,{url:o.contentUrl,icon:T.Icon.Globe}),(0,q.jsx)(T.Action.OpenInBrowser,{title:"Open reddit post",url:o.contentUrl,icon:T.Icon.Globe})]})})},"showFullDetails"),u=[];return n?(u.push(a),u.push(l)):(u.push(l),u.push(a)),(0,q.jsxs)(T.ActionPanel,{children:[...u,(0,q.jsx)(T.Action,{title:"Toggle Details",icon:T.Icon.Sidebar,shortcut:{modifiers:["cmd","shift"],key:"d"},onAction:()=>i()})]})}else{let a=(0,q.jsx)(T.Action.OpenInBrowser,{url:o.url,icon:T.Icon.Globe},"browser"),l=(0,q.jsx)(T.Action.Push,{title:"Show Full Details",icon:T.Icon.TextDocument,target:(0,q.jsx)(T.Detail,{navigationTitle:o.title,markdown:`# ${o.title}
*Posted ${o.created}, r/${o.subreddit}*
        
${o.url}`,actions:(0,q.jsx)(T.ActionPanel,{children:(0,q.jsx)(T.Action.OpenInBrowser,{url:o.url,icon:T.Icon.Globe})})})},"showFullDetails"),u=[];return n?(u.push(a),u.push(l)):(u.push(l),u.push(a)),(0,q.jsxs)(T.ActionPanel,{children:[...u,(0,q.jsx)(T.Action,{title:"Toggle Details",icon:T.Icon.Sidebar,shortcut:{modifiers:["cmd","shift"],key:"d"},onAction:()=>i()})]})}}var Mt=require("@raycast/api"),jt=require("react/jsx-runtime");function On({data:o}){return o.description?(0,jt.jsx)(Mt.List.Item.Detail,{markdown:`# ${o.title}
  *Posted ${o.created}, r/${o.subreddit}*
                
  ${o.description}`}):o.imageUrl?(0,jt.jsx)(Mt.List.Item.Detail,{markdown:`# ${o.title}
  *Posted ${o.created}, r/${o.subreddit}*
                
  ![${o.title}](${o.imageUrl} "${o.title}}")`}):o.contentUrl?(0,jt.jsx)(Mt.List.Item.Detail,{markdown:`# ${o.title}
  *Posted ${o.created}, r/${o.subreddit}*
                
  ${o.contentUrl}`}):(0,jt.jsx)(Mt.List.Item.Detail,{markdown:`# ${o.title}
  *Posted ${o.created}, r/${o.subreddit}*
                
  ${o.url}`})}var J=require("react/jsx-runtime");function Nt({posts:o,subreddit:n="",sort:i,doSearch:a,searchRedditUrl:l,showDetail:u,toggleShowDetail:d}){if(!o.length)return null;let g=n?`Results in ${n.substring(1,n.length-1)}`:"Results";return(0,J.jsxs)(J.Fragment,{children:[(0,J.jsxs)(Z.List.Section,{title:g,children:[o.map(h=>{let y="";return u||(y=n?`Posted ${h.created}`:`Posted ${h.created} r/${h.subreddit}`),(0,J.jsx)(Z.List.Item,{icon:h.thumbnail&&(h.thumbnail.startsWith("http:")||h.thumbnail.startsWith("https:"))?{source:h.thumbnail}:Z.Icon.Text,title:h.title,accessoryTitle:y,actions:(0,J.jsx)(kn,{data:h,showDetail:u,toggleDetail:d}),detail:(0,J.jsx)(On,{data:h})},h.id)}),(0,J.jsx)(Z.List.Item,{id:"showMore",icon:Z.Icon.MagnifyingGlass,title:"Show more...",actions:(0,J.jsx)(Z.ActionPanel,{children:(0,J.jsx)(Z.Action,{title:"Show more...",onAction:()=>a(i,o[o.length-1].afterId)})})},"showMore")]}),(0,J.jsx)(Z.List.Section,{title:"Didn't find what you're looking for?",children:(0,J.jsx)(Z.List.Item,{id:"searchOnReddit",icon:Z.Icon.Globe,title:"Show all results on Reddit...",actions:(0,J.jsx)(Z.ActionPanel,{children:(0,J.jsx)(Z.Action.OpenInBrowser,{url:l,icon:Z.Icon.Globe})})},"searchOnReddit")})]})}var Ii=require("@raycast/api");function Ze(){let o=(0,Ii.getPreferenceValues)();return o.resultLimit<1?o.resultLimit=1:o.resultLimit>100&&(o.resultLimit=100),o}var Li={sortValue:"relevance",name:"Relevance"},qi={sortValue:"hot",name:"Hot"},$i={sortValue:"top",name:"Top"},zi={sortValue:"new",name:"Latest"},Ui={sortValue:"comments",name:"Comments"},Mi=[Li,qi,$i,zi,Ui],Va=o=>Mi.find(n=>n.sortValue===o),Y={relevance:Li,hot:qi,top:$i,latest:zi,comments:Ui,allSortOrders:Mi,getSortFromValue:Va};var ji=require("react"),Je=require("@raycast/api");var $e=require("react/jsx-runtime");function Ht({defaultSort:o,onSortChange:n}){let[i,a]=(0,ji.useState)(o);return(0,$e.jsxs)(Je.List.Dropdown,{tooltip:"Select Sort Order",value:i.sortValue,onChange:l=>{let u=Y.getSortFromValue(l);a(u),n(u)},children:[(0,$e.jsx)(Je.List.Dropdown.Item,{title:`Sorting by ${Y.relevance.name}`,value:Y.relevance.sortValue}),(0,$e.jsx)(Je.List.Dropdown.Item,{title:`Sorting by ${Y.hot.name}`,value:Y.hot.sortValue}),(0,$e.jsx)(Je.List.Dropdown.Item,{title:`Sorting by ${Y.top.name}`,value:Y.top.sortValue}),(0,$e.jsx)(Je.List.Dropdown.Item,{title:`Sorting by ${Y.latest.name}`,value:Y.latest.sortValue}),(0,$e.jsx)(Je.List.Dropdown.Item,{title:`Sorting by ${Y.comments.name}`,value:Y.comments.sortValue})]})}var $r=require("react/jsx-runtime");function xt({subreddit:o,subredditName:n,showDetailSetting:i,toggleShowDetailSetting:a}){let l=(0,ue.useRef)(null),[u,d]=(0,ue.useState)([]),[g,h]=(0,ue.useState)(Y.relevance),[y,k]=(0,ue.useState)(""),[A,S]=(0,ue.useState)(!0),p=(0,ue.useRef)(""),[b,C]=(0,ue.useState)(!1),[P,E]=(0,ue.useState)(i),F=async(w,z=Y.relevance,B="")=>{if(l.current?.abort(),l.current=new AbortController,S(!0),p.current=w,h(z),B||d([]),!w&&!o){S(!1);return}try{let x=Ze(),Q=await qr(o,w,x.resultLimit,z?.sortValue??"",B,l.current);k(Q.url),d(B?[...u,...Q.items]:Q.items)}catch(x){if(x instanceof Se)return;console.log(x),(0,mt.showToast)({style:mt.Toast.Style.Failure,title:"Something went wrong :(",message:String(x)})}finally{S(!1)}};return(0,ue.useEffect)(()=>(F(""),()=>{l?.current?.abort()}),[]),(0,$r.jsx)(mt.List,{isShowingDetail:P&&!b&&!A,isLoading:A,onSearchTextChange:w=>F(w,g),throttle:!0,searchBarPlaceholder:`Search r/${n}...`,searchBarAccessory:(0,$r.jsx)(Ht,{defaultSort:g,onSortChange:w=>{g!=w&&F(p.current,w)}}),onSelectionChange:w=>C(w==="showMore"||w==="searchOnReddit"),children:(0,$r.jsx)(Nt,{subreddit:o,posts:u,sort:g,doSearch:(w,z)=>F(p.current,w,z),searchRedditUrl:y,showDetail:P,toggleShowDetail:()=>{a(),E(!P)}})})}var G=require("react/jsx-runtime");function Fn({favorites:o,addFavoriteSubreddit:n,removeFavoriteSubreddit:i,showDetail:a,toggleShowDetail:l}){let[u,d]=(0,ve.useState)([]),[g,h]=(0,ve.useState)(!1),[y,k]=(0,ve.useState)(""),A=(0,ve.useRef)(null),S=(0,ve.useRef)(""),p=async(b,C="")=>{if(A.current?.abort(),A.current=new AbortController,h(!0),S.current=b,C||d([]),!b){h(!1);return}try{let P=Ze(),E=await Wi(b,P.resultLimit,C,A.current);for(let F=0;F<E.subreddits.length;F++){let v=E.subreddits[F];v.isFavorite=o.some(w=>w===v.subreddit)}k(E.url),d(C?[...u,...E.subreddits]:E.subreddits)}catch(P){if(P instanceof Se)return;console.log(P),(0,$.showToast)({style:$.Toast.Style.Failure,title:"Something went wrong :(",message:String(P)})}finally{h(!1)}};return(0,ve.useEffect)(()=>()=>{A?.current?.abort()},[]),(0,G.jsxs)($.List,{isLoading:g,onSearchTextChange:p,throttle:!0,searchBarPlaceholder:"Search Subreddits...",children:[(0,G.jsxs)($.List.Section,{title:"Subreddits",children:[u.map(b=>(0,G.jsx)($.List.Item,{icon:$.Icon.Text,title:b.title,accessoryTitle:`Posted ${b.created} r/${b.subredditName}${b.isFavorite?" \u2B50":""}`,actions:(0,G.jsxs)($.ActionPanel,{children:[(0,G.jsx)($.Action.Push,{title:`Search in r/${b.subredditName}`,target:(0,G.jsx)(xt,{subredditName:b.subredditName,subreddit:b.subreddit,showDetailSetting:a,toggleShowDetailSetting:l})}),(0,G.jsx)($.Action.OpenInBrowser,{url:b.url,icon:$.Icon.Globe}),!b.isFavorite&&(0,G.jsx)($.Action,{title:"Add to Favorites",icon:$.Icon.Star,shortcut:{modifiers:["cmd"],key:"f"},onAction:async()=>{await n(b.subreddit);let C=u.findIndex(P=>P.id===b.id);d([...u.slice(0,C),{...u[C],isFavorite:!u[C].isFavorite},...u.slice(C+1)])}}),b.isFavorite&&(0,G.jsx)($.Action,{title:"Remove from Favorites",icon:$.Icon.Trash,shortcut:{modifiers:["cmd"],key:"f"},onAction:async()=>{await i(b.subreddit);let C=u.findIndex(P=>P.id===b.id);d([...u.slice(0,C),{...u[C],isFavorite:!u[C].isFavorite},...u.slice(C+1)])}})]})},b.id)),u.length>0&&(0,G.jsx)($.List.Item,{icon:$.Icon.MagnifyingGlass,title:"Show more...",actions:(0,G.jsx)($.ActionPanel,{children:(0,G.jsx)($.Action,{title:"Show more...",onAction:()=>p(S.current,u[u.length-1].afterId)})})},"showMore")]}),u.length>0&&(0,G.jsx)($.List.Section,{title:"Didn't find what you're looking for?",children:(0,G.jsx)($.List.Item,{icon:$.Icon.Globe,title:"Show all results on Reddit...",actions:(0,G.jsx)($.ActionPanel,{children:(0,G.jsx)($.Action.OpenInBrowser,{url:y,icon:$.Icon.Globe})})},"searchOnReddit")})]})}var zr=require("@raycast/api"),Ur=require("react"),Wn="showDetail",Ya=()=>{let[o,n]=(0,Ur.useState)(!0),i=async()=>{let a=!(await zr.LocalStorage.getItem(Wn)??!0);await zr.LocalStorage.setItem(Wn,a),n(a)};return(0,Ur.useEffect)(()=>{(async()=>{let l=await zr.LocalStorage.getItem(Wn)??!0;n(!!l)})()},[]),[o,i]},Ni=Ya;var H=require("react/jsx-runtime");function In({favorites:o,addFavoriteSubreddit:n,removeFavoriteSubreddit:i}){let a=(0,be.useRef)(null),[l,u]=(0,be.useState)([]),[d,g]=(0,be.useState)(Y.relevance),[h,y]=(0,be.useState)(""),[k,A]=(0,be.useState)(!1),S=(0,be.useRef)(""),[p,b]=(0,be.useState)(!1),[C,P]=Ni(),E=async(v,w=Y.relevance,z="")=>{if(a.current?.abort(),a.current=new AbortController,A(!0),S.current=v,g(w),z||u([]),!v){A(!1);return}try{let B=Ze(),x=await qr("",v,B.resultLimit,w?.sortValue??"",z,a.current);y(x.url),u(z?[...l,...x.items]:x.items)}catch(B){if(B instanceof Se)return;console.log(B),(0,j.showToast)({style:j.Toast.Style.Failure,title:"Something went wrong :(",message:String(B)})}finally{A(!1)}};(0,be.useEffect)(()=>()=>{a?.current?.abort()},[]);let F=C&&!!S.current&&!p&&!k;return(0,H.jsxs)(j.List,{isShowingDetail:F,isLoading:k,onSearchTextChange:v=>E(v,d),throttle:!0,searchBarPlaceholder:"Search Reddit...",searchBarAccessory:(0,H.jsx)(Ht,{defaultSort:d,onSortChange:v=>{d!=v&&E(S.current,v)}}),onSelectionChange:v=>b(v==="showMore"||v==="searchOnReddit"),children:[!S.current&&(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(j.List.Section,{title:"More ways to search",children:(0,H.jsx)(j.List.Item,{icon:j.Icon.MagnifyingGlass,title:"Search Subreddits...",actions:(0,H.jsx)(j.ActionPanel,{children:(0,H.jsx)(j.Action.Push,{title:"Search Subreddits",icon:j.Icon.MagnifyingGlass,target:(0,H.jsx)(Fn,{favorites:o,addFavoriteSubreddit:n,removeFavoriteSubreddit:i,showDetail:C,toggleShowDetail:P})})})},"searchOnRedditForSubreddits")}),(0,H.jsx)(j.List.Section,{title:"Favorite subreddits",children:o.map(v=>(0,H.jsx)(j.List.Item,{title:v.substring(1,v.length-1),actions:(0,H.jsxs)(j.ActionPanel,{children:[(0,H.jsx)(j.Action.Push,{title:`Search in ${v.substring(1,v.length-1)}`,icon:j.Icon.MagnifyingGlass,target:(0,H.jsx)(xt,{subreddit:v,subredditName:v.substring(3,v.length-1),showDetailSetting:C,toggleShowDetailSetting:P})}),(0,H.jsx)(j.Action.OpenInBrowser,{url:Ot(v),icon:j.Icon.Globe}),(0,H.jsx)(j.Action,{title:"Remove from Favorites",icon:j.Icon.Trash,shortcut:{modifiers:["cmd"],key:"f"},onAction:async()=>{await i(v)}})]})},v))})]}),(0,H.jsx)(Nt,{subreddit:"",posts:l,sort:d,doSearch:(v,w)=>E(S.current,v,w),searchRedditUrl:h,showDetail:C,toggleShowDetail:P})]})}var xi=require("react/jsx-runtime");function Hi(){let[o,n,i]=ei();return(0,xi.jsx)(In,{favorites:o,addFavoriteSubreddit:n,removeFavoriteSubreddit:i})}
/*! Bundled license information:

fetch-blob/index.js:
  (*! fetch-blob. MIT License. Jimmy Wrting <https://jimmy.warting.se/opensource> *)

formdata-polyfill/esm.min.js:
  (*! formdata-polyfill. MIT License. Jimmy Wrting <https://jimmy.warting.se/opensource> *)

node-domexception/index.js:
  (*! node-domexception. MIT License. Jimmy Wrting <https://jimmy.warting.se/opensource> *)
*/
