"use strict";var w=Object.defineProperty;var P=Object.getOwnPropertyDescriptor;var T=Object.getOwnPropertyNames;var L=Object.prototype.hasOwnProperty;var O=(r,o)=>{for(var c in o)w(r,c,{get:o[c],enumerable:!0})},R=(r,o,c,p)=>{if(o&&typeof o=="object"||typeof o=="function")for(let l of T(o))!L.call(r,l)&&l!==c&&w(r,l,{get:()=>o[l],enumerable:!(p=P(o,l))||p.enumerable});return r};var E=r=>R(w({},"__esModule",{value:!0}),r);var U={};O(U,{CreateCategoryForm:()=>b,default:()=>B});module.exports=E(U);var e=require("@raycast/api"),n=require("react"),v=require("crypto"),i=require("react/jsx-runtime"),M={"\u{1F9D1}\u200D\u{1F4BB}":"Developer","\u{1F680}":"Rocket","\u{1F4A1}":"Idea","\u{1F4BC}":"Briefcase","\u{1F4DA}":"Books","\u{1F3AE}":"Gaming","\u{1F4AC}":"Chat","\u{1F4DD}":"Notes","\u{1F3A8}":"Art","\u{1F3B5}":"Music","\u{1F4B0}":"Money","\u{1F512}":"Security","\u2699\uFE0F":"Settings","\u{1F916}":"Bot","\u{1F4BB}":"Laptop","\u{1F5A5}\uFE0F":"Desktop","\u{1F5B1}\uFE0F":"Mouse","\u2328\uFE0F":"Keyboard","\u{1F4BE}":"Save","\u{1F4BF}":"Disc","\u{1F50C}":"Plugin","\u{1F50B}":"Battery","\u{1F4E1}":"Network","\u{1F9E0}":"Brain","\u{1F4B3}":"Card","\u{1F4B5}":"Dollar","\u{1F4C8}":"Chart","\u{1F3E6}":"Bank","\u{1F6E1}\uFE0F":"Shield","\u{1F9FE}":"Receipt","\u2705":"Done","\u274C":"Remove","\u2753":"Question","\u2757":"Alert","\u{1F4CC}":"Pin","\u{1F4CD}":"Location","\u23F0":"Alarm","\u23F3":"Hourglass","\u{1F3C1}":"Finish","\u{1F3F3}\uFE0F":"Flag","\u2728":"Magic","\u{1F30D}":"Web"};function b({categoryId:r,onCategoryUpdated:o}){let{pop:c}=(0,e.useNavigation)(),[p,l]=(0,n.useState)(!0),C=(0,n.useRef)(!1),[m,D]=(0,n.useState)([]),[y,F]=(0,n.useState)(""),[d,S]=(0,n.useState)([]),[h,A]=(0,n.useState)("\u{1F9D1}\u200D\u{1F4BB}"),I=(0,n.useRef)([]);(0,n.useEffect)(()=>{async function t(){try{let a=await(0,e.getApplications)();D(a)}catch(a){await(0,e.showToast)({style:e.Toast.Style.Failure,title:"Failed to load applications",message:a instanceof Error?a.message:"An unknown error occurred"}),l(!1)}}t()},[]),(0,n.useEffect)(()=>{if(m.length===0&&r)return;if(!r){l(!1),C.current=!0;return}async function t(){try{let a=await e.LocalStorage.getItem("categories");if(a){let s=JSON.parse(a).find(u=>u.id===r);if(s){let u=new Set(m.map(f=>f.bundleId)),k=s.bundleIds.filter(f=>f&&u.has(f));F(s.name),S(k),I.current=k,A(s.icon),C.current=!0}}}catch(a){await(0,e.showToast)({style:e.Toast.Style.Failure,title:"Failed to load category details",message:a instanceof Error?a.message:"An unknown error occurred"})}finally{l(!1)}}t()},[r,m]);async function N(){if(!y){await(0,e.showToast)({style:e.Toast.Style.Failure,title:"Category name is required"});return}if(d.length===0){await(0,e.showToast)({style:e.Toast.Style.Failure,title:"Please select at least one application"});return}let t=await(0,e.showToast)({style:e.Toast.Style.Animated,title:r?"Saving...":"Creating..."});try{let a=await e.LocalStorage.getItem("categories"),g=a?JSON.parse(a):[];if(r){let s=g.findIndex(u=>u.id===r);s!==-1&&(g[s]={...g[s],name:y,icon:h,bundleIds:d})}else{let s={id:(0,v.randomUUID)(),name:y,bundleIds:d,icon:h};g.push(s)}await e.LocalStorage.setItem("categories",JSON.stringify(g)),t.style=e.Toast.Style.Success,t.title=r?"Category Updated":"Category Created",o(),c()}catch(a){t.style=e.Toast.Style.Failure,t.title="Failed to save category",t.message=a instanceof Error?a.message:"An unknown error occurred"}}return(0,n.useEffect)(()=>{C.current&&I.current.length>0&&d.length===0&&S(I.current)},[d]),(0,i.jsxs)(e.Form,{isLoading:p,actions:(0,i.jsx)(e.ActionPanel,{children:(0,i.jsx)(e.Action.SubmitForm,{title:r?"Save Changes":"Create Category",onSubmit:N,icon:e.Icon.CheckCircle})}),children:[(0,i.jsx)(e.Form.TextField,{id:"name",title:"Category Name",placeholder:"e.g., Work Apps",value:y,onChange:F}),(0,i.jsx)(e.Form.Dropdown,{id:"icon",title:"Icon",value:h,onChange:A,children:Object.entries(M).map(([t,a])=>(0,i.jsx)(e.Form.Dropdown.Item,{value:t,title:`${t} ${a}`},t))}),(0,i.jsx)(e.Form.TagPicker,{id:"apps",title:"Applications",placeholder:"Type to search for applications",value:d,onChange:S,children:m.filter(t=>!!t.bundleId).map(t=>(0,i.jsx)(e.Form.TagPicker.Item,{value:t.bundleId,title:t.name},t.bundleId))})]})}function B(){return(0,i.jsx)(b,{onCategoryUpdated:()=>{}})}0&&(module.exports={CreateCategoryForm});
