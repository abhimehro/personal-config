"use strict";var d=Object.defineProperty;var E=Object.getOwnPropertyDescriptor;var F=Object.getOwnPropertyNames;var N=Object.prototype.hasOwnProperty;var V=(t,e)=>{for(var n in e)d(t,n,{get:e[n],enumerable:!0})},P=(t,e,n,a)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of F(e))!N.call(t,s)&&s!==n&&d(t,s,{get:()=>e[s],enumerable:!(a=E(e,s))||a.enumerable});return t};var z=t=>P(d({},"__esModule",{value:!0}),t);var D={};V(D,{confirmation:()=>R,default:()=>y});module.exports=z(D);var c=require("fs"),m=require("os"),f=require("path");function w(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function g(){let t=(0,m.homedir)(),e=[".zshrc",".zsh_aliases",".aliases"],n=[],a=/^\s*alias\s+([^=]+)=(['"]?)(.+?)\2\s*$/;for(let s of e){let i=(0,f.join)(t,s);if((0,c.existsSync)(i))try{let u=(0,c.readFileSync)(i,"utf-8").split(`
`);for(let o of u){let l=o.match(a);l&&n.push({name:l[1].trim(),command:l[3].trim(),file:s})}}catch(r){console.error(`Error reading ${s}:`,r)}}return n.sort((s,i)=>s.name.localeCompare(i.name))}function p(t,e,n){let a=(0,m.homedir)(),s=[".zshrc",".zsh_aliases",".aliases"];for(let i of s){let r=(0,f.join)(a,i);if((0,c.existsSync)(r))try{let u=(0,c.readFileSync)(r,"utf-8");if(new RegExp(`^\\s*alias\\s+${w(t)}=`,"m").test(u)){if(e===i&&n===t)continue;return!0}}catch(u){console.error(`Error reading ${i}:`,u)}}return!1}function h(t,e,n,a){let s=(0,m.homedir)(),i=(0,f.join)(s,a);if(!(0,c.existsSync)(i))throw new Error(`Configuration file ${a} not found`);try{let u=(0,c.readFileSync)(i,"utf-8").split(`
`),o=new RegExp(`^\\s*alias\\s+${w(t)}=(.*)$`),l=!1,C=u.map($=>{if($.match(o)){l=!0;let v=n.replace(/'/g,"'\\''");return`alias ${e}='${v}'`}return $});if(!l)throw new Error(`Alias '${t}' not found in ${a}`);(0,c.writeFileSync)(i,C.join(`
`))}catch(r){throw r instanceof Error&&r.message.includes("not found")?r:new Error(`Failed to update alias in ${a}: ${r}`)}}function A(t){return!t||t.trim()===""?{isValid:!1,error:"Alias name is required"}:/^[a-zA-Z_][a-zA-Z0-9_]*$/.test(t)?{isValid:!0}:{isValid:!1,error:"Alias name must start with a letter or underscore and contain only letters, numbers, and underscores"}}function x(t){return!t||t.trim()===""?{isValid:!1,error:"Alias command is required"}:{isValid:!0}}var R=async t=>{let{currentName:e,newName:n,newCommand:a,configFile:s}=t,r=g().find(l=>l.name===e&&(!s||l.file===s));return r?{message:e!==n?`Are you sure you want to rename '${e}' to '${n}' and update its command?`:`Are you sure you want to update the command for '${e}'?`,info:[{name:"Current Name",value:r.name},{name:"New Name",value:n},{name:"Current Command",value:r.command},{name:"New Command",value:a},{name:"File",value:r.file}]}:{message:`Alias '${e}' not found${s?` in ${s}`:""}`}};function y(t){try{let{currentName:e,newName:n,newCommand:a,configFile:s}=t,i=A(n);if(!i.isValid)return{success:!1,message:i.error||"Invalid alias name"};let r=x(a);if(!r.isValid)return{success:!1,message:r.error||"Invalid alias command"};if(s)return e!==n&&p(n,s,e)?{success:!1,message:`Alias '${n}' already exists`}:(h(e,n,a,s),{success:!0,message:e!==n?`Alias '${e}' renamed to '${n}' and updated in ${s}`:`Alias '${e}' updated successfully in ${s}`,oldName:e,newName:n,configFile:s});let o=g().find(l=>l.name===e);return o?e!==n&&p(n,o.file,e)?{success:!1,message:`Alias '${n}' already exists`}:(h(e,n,a,o.file),{success:!0,message:e!==n?`Alias '${e}' renamed to '${n}' and updated in ${o.file}`:`Alias '${e}' updated successfully in ${o.file}`,oldName:e,newName:n,configFile:o.file}):{success:!1,message:`Alias '${e}' not found`}}catch(e){return{success:!1,message:`Failed to update alias: ${e instanceof Error?e.message:"Unknown error"}`}}}0&&(module.exports={confirmation});
