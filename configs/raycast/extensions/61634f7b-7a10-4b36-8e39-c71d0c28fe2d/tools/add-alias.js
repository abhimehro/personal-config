"use strict";var u=Object.defineProperty;var x=Object.getOwnPropertyDescriptor;var E=Object.getOwnPropertyNames;var y=Object.prototype.hasOwnProperty;var F=(e,s)=>{for(var t in s)u(e,t,{get:s[t],enumerable:!0})},v=(e,s,t,r)=>{if(s&&typeof s=="object"||typeof s=="function")for(let n of E(s))!y.call(e,n)&&n!==t&&u(e,n,{get:()=>s[n],enumerable:!(r=x(s,n))||r.enumerable});return e};var C=e=>v(u({},"__esModule",{value:!0}),e);var V={};F(V,{default:()=>$});module.exports=C(V);var i=require("fs"),c=require("os"),f=require("path");function z(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function d(){let e=(0,c.homedir)(),s=[".zshrc",".zsh_aliases",".aliases"],t=[];for(let r of s){let n=(0,f.join)(e,r);(0,i.existsSync)(n)&&t.push(r)}return t.length===0&&t.push(".zshrc"),t}function m(e,s,t){let r=(0,c.homedir)(),n=[".zshrc",".zsh_aliases",".aliases"];for(let l of n){let o=(0,f.join)(r,l);if((0,i.existsSync)(o))try{let a=(0,i.readFileSync)(o,"utf-8");if(new RegExp(`^\\s*alias\\s+${z(e)}=`,"m").test(a)){if(s===l&&t===e)continue;return!0}}catch(a){console.error(`Error reading ${l}:`,a)}}return!1}function g(e,s,t){let r=(0,c.homedir)(),n=(0,f.join)(r,t),l=s.replace(/'/g,"'\\''"),o=`alias ${e}='${l}'`;try{if((0,i.existsSync)(n)){let A=(0,i.readFileSync)(n,"utf-8").endsWith(`
`)?`${o}
`:`
${o}
`;(0,i.appendFileSync)(n,A)}else(0,i.writeFileSync)(n,`${o}
`)}catch(a){throw new Error(`Failed to write to ${t}: ${a}`)}}function h(e){return!e||e.trim()===""?{isValid:!1,error:"Alias name is required"}:/^[a-zA-Z_][a-zA-Z0-9_]*$/.test(e)?{isValid:!0}:{isValid:!1,error:"Alias name must start with a letter or underscore and contain only letters, numbers, and underscores"}}function p(e){return!e||e.trim()===""?{isValid:!1,error:"Alias command is required"}:{isValid:!0}}function $(e){try{let{name:s,command:t,configFile:r}=e,n=h(s);if(!n.isValid)return{success:!1,message:n.error||"Invalid alias name"};let l=p(t);if(!l.isValid)return{success:!1,message:l.error||"Invalid alias command"};if(m(s))return{success:!1,message:`Alias '${s}' already exists`};let o=d();if(r&&!o.includes(r)&&![".zshrc",".zsh_aliases",".aliases"].includes(r))return{success:!1,message:`Invalid config file '${r}'. Must be one of: .zshrc, .zsh_aliases, .aliases`};let a=r||o[0];return g(s,t,a),{success:!0,message:`Alias '${s}' added successfully to ${a}`,aliasName:s,configFile:a}}catch(s){return{success:!1,message:`Failed to add alias: ${s instanceof Error?s.message:"Unknown error"}`}}}
