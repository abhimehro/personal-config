{
  "version": 3,
  "sources": ["../../src/tools/remove-alias.ts", "../../src/utils/alias-utils.ts"],
  "sourcesContent": ["import { Tool } from \"@raycast/api\";\nimport { removeAlias, parseAliases } from \"../utils/alias-utils\";\n\n/**\n * Input parameters for removing an alias\n */\ntype Input = {\n  /** The name of the alias to remove */\n  name: string;\n  /** The configuration file containing the alias (.zshrc, .zsh_aliases, or .aliases). If not specified, searches all config files */\n  configFile?: string;\n};\n\n/**\n * Confirmation function for the remove alias tool\n * Shows a confirmation dialog before removing the alias\n */\nexport const confirmation: Tool.Confirmation<Input> = async (input) => {\n  const { name, configFile } = input;\n\n  // Find the alias to get details for confirmation\n  const aliases = parseAliases();\n  const aliasToRemove = aliases.find((alias) => alias.name === name && (!configFile || alias.file === configFile));\n\n  if (!aliasToRemove) {\n    return {\n      message: `Alias '${name}' not found${configFile ? ` in ${configFile}` : \"\"}`,\n    };\n  }\n\n  return {\n    message: `Are you sure you want to remove the alias '${name}'?`,\n    /**\n     * @type {Array<{name: string, value: string}>}\n     */\n    info: [\n      { name: \"Alias\", value: aliasToRemove.name },\n      { name: \"Command\", value: aliasToRemove.command },\n      { name: \"File\", value: aliasToRemove.file },\n    ],\n  };\n};\n\n/**\n * Remove an existing zsh alias\n *\n * This tool removes an alias from the specified configuration file.\n * If no config file is specified, it searches all config files to find\n * and remove the alias. Requires confirmation before deletion.\n *\n * @param input - The alias name and optional config file\n * @returns Response indicating success or failure with details\n */\nexport default function removeAliasCommand(input: Input) {\n  try {\n    const { name, configFile } = input;\n\n    // If config file is specified, try to remove from that file\n    if (configFile) {\n      const removed = removeAlias(name, configFile);\n\n      if (removed) {\n        return {\n          success: true,\n          message: `Alias '${name}' removed successfully from ${configFile}`,\n          aliasName: name,\n          configFile,\n        };\n      } else {\n        return {\n          success: false,\n          message: `Alias '${name}' not found in ${configFile}`,\n        };\n      }\n    }\n\n    // If no config file specified, search all files to find the alias\n    const aliases = parseAliases();\n    const aliasToRemove = aliases.find((alias) => alias.name === name);\n\n    if (!aliasToRemove) {\n      return {\n        success: false,\n        message: `Alias '${name}' not found`,\n      };\n    }\n\n    // Remove from the file where it was found\n    const removed = removeAlias(name, aliasToRemove.file);\n\n    if (removed) {\n      return {\n        success: true,\n        message: `Alias '${name}' removed successfully from ${aliasToRemove.file}`,\n        aliasName: name,\n        configFile: aliasToRemove.file,\n      };\n    } else {\n      return {\n        success: false,\n        message: `Failed to remove alias '${name}' from ${aliasToRemove.file}`,\n      };\n    }\n  } catch (error) {\n    return {\n      success: false,\n      message: `Failed to remove alias: ${error instanceof Error ? error.message : \"Unknown error\"}`,\n    };\n  }\n}\n", "import { appendFileSync, existsSync, readFileSync, writeFileSync } from \"fs\";\nimport { homedir } from \"os\";\nimport { join } from \"path\";\n\nexport interface Alias {\n  name: string;\n  command: string;\n  file: string;\n}\n\n/**\n * Escapes special regex characters in a string\n * @param str - The string to escape\n * @returns The escaped string safe for use in RegExp\n */\nfunction escapeRegExp(str: string): string {\n  return str.replace(/[.*+?^${}()|[\\]\\\\]/g, \"\\\\$&\");\n}\n\nexport interface ValidationResult {\n  isValid: boolean;\n  error?: string;\n}\n\n/**\n * Parse aliases from zsh configuration files\n * @returns Array of parsed aliases\n */\nexport function parseAliases(): Alias[] {\n  const homeDir = homedir();\n  const configFiles = [\".zshrc\", \".zsh_aliases\", \".aliases\"];\n  const aliases: Alias[] = [];\n  const aliasPattern = /^\\s*alias\\s+([^=]+)=(['\"]?)(.+?)\\2\\s*$/;\n\n  for (const configFile of configFiles) {\n    const filePath = join(homeDir, configFile);\n    if (existsSync(filePath)) {\n      try {\n        const content = readFileSync(filePath, \"utf-8\");\n        const lines = content.split(\"\\n\");\n\n        for (const line of lines) {\n          const match = line.match(aliasPattern);\n          if (match) {\n            aliases.push({\n              name: match[1].trim(),\n              command: match[3].trim(),\n              file: configFile,\n            });\n          }\n        }\n      } catch (error) {\n        console.error(`Error reading ${configFile}:`, error);\n      }\n    }\n  }\n\n  return aliases.sort((a, b) => a.name.localeCompare(b.name));\n}\n\n/**\n * Get available zsh configuration files\n * @returns Array of configuration file paths\n */\nexport function getConfigFiles(): string[] {\n  const homeDir = homedir();\n  const configFiles = [\".zshrc\", \".zsh_aliases\", \".aliases\"];\n  const availableFiles: string[] = [];\n\n  for (const configFile of configFiles) {\n    const filePath = join(homeDir, configFile);\n    if (existsSync(filePath)) {\n      availableFiles.push(configFile);\n    }\n  }\n\n  // If no config files exist, default to .zshrc\n  if (availableFiles.length === 0) {\n    availableFiles.push(\".zshrc\");\n  }\n\n  return availableFiles;\n}\n\n/**\n * Check if an alias name already exists in any configuration file\n * @param aliasName - Name to check\n * @param excludeFile - Optional file to exclude from check\n * @param excludeName - Optional name to exclude from check (for renaming)\n */\nexport function aliasExists(aliasName: string, excludeFile?: string, excludeName?: string): boolean {\n  const homeDir = homedir();\n  const configFiles = [\".zshrc\", \".zsh_aliases\", \".aliases\"];\n\n  for (const configFile of configFiles) {\n    const filePath = join(homeDir, configFile);\n    if (existsSync(filePath)) {\n      try {\n        const content = readFileSync(filePath, \"utf-8\");\n        const aliasPattern = new RegExp(`^\\\\s*alias\\\\s+${escapeRegExp(aliasName)}=`, \"m\");\n        if (aliasPattern.test(content)) {\n          // If we're checking the same file and name (for rename), don't count it as existing\n          if (excludeFile === configFile && excludeName === aliasName) {\n            continue;\n          }\n          return true;\n        }\n      } catch (error) {\n        console.error(`Error reading ${configFile}:`, error);\n      }\n    }\n  }\n  return false;\n}\n\n/**\n * Add an alias to the specified configuration file\n * @param aliasName - Name of the alias\n * @param aliasCommand - Command for the alias\n * @param configFile - Configuration file to add the alias to\n */\nexport function addAlias(aliasName: string, aliasCommand: string, configFile: string): void {\n  const homeDir = homedir();\n  const filePath = join(homeDir, configFile);\n\n  // Escape single quotes in the command\n  const escapedCommand = aliasCommand.replace(/'/g, \"'\\\\''\");\n  const aliasLine = `alias ${aliasName}='${escapedCommand}'`;\n\n  try {\n    if (existsSync(filePath)) {\n      // Read existing content\n      const content = readFileSync(filePath, \"utf-8\");\n\n      // Check if file ends with newline\n      const endsWithNewline = content.endsWith(\"\\n\");\n\n      // Append alias with proper newlines\n      const newContent = endsWithNewline ? `${aliasLine}\\n` : `\\n${aliasLine}\\n`;\n      appendFileSync(filePath, newContent);\n    } else {\n      // Create new file with the alias\n      writeFileSync(filePath, `${aliasLine}\\n`);\n    }\n  } catch (error) {\n    throw new Error(`Failed to write to ${configFile}: ${error}`);\n  }\n}\n\n/**\n * Update an alias in its configuration file (supports renaming)\n * @param oldName - Original name of the alias\n * @param newName - New name for the alias\n * @param newCommand - New command for the alias\n * @param configFile - Configuration file containing the alias\n */\nexport function updateAlias(oldName: string, newName: string, newCommand: string, configFile: string): void {\n  const homeDir = homedir();\n  const filePath = join(homeDir, configFile);\n\n  if (!existsSync(filePath)) {\n    throw new Error(`Configuration file ${configFile} not found`);\n  }\n\n  try {\n    const content = readFileSync(filePath, \"utf-8\");\n    const lines = content.split(\"\\n\");\n    const aliasPattern = new RegExp(`^\\\\s*alias\\\\s+${escapeRegExp(oldName)}=(.*)$`);\n    let updated = false;\n\n    const newLines = lines.map((line) => {\n      const match = line.match(aliasPattern);\n      if (match) {\n        updated = true;\n        // Escape single quotes in the command\n        const escapedCommand = newCommand.replace(/'/g, \"'\\\\''\");\n        return `alias ${newName}='${escapedCommand}'`;\n      }\n      return line;\n    });\n\n    if (!updated) {\n      throw new Error(`Alias '${oldName}' not found in ${configFile}`);\n    }\n\n    writeFileSync(filePath, newLines.join(\"\\n\"));\n  } catch (error) {\n    if (error instanceof Error && error.message.includes(\"not found\")) {\n      throw error;\n    }\n    throw new Error(`Failed to update alias in ${configFile}: ${error}`);\n  }\n}\n\n/**\n * Remove an alias from its configuration file\n * @param aliasName - Name of the alias to remove\n * @param configFile - Configuration file containing the alias\n * @returns True if removed successfully, false otherwise\n */\nexport function removeAlias(aliasName: string, configFile: string): boolean {\n  const homeDir = homedir();\n  const filePath = join(homeDir, configFile);\n\n  if (!existsSync(filePath)) {\n    throw new Error(`Configuration file ${configFile} not found`);\n  }\n\n  try {\n    const content = readFileSync(filePath, \"utf-8\");\n    const lines = content.split(\"\\n\");\n    const aliasPattern = new RegExp(`^\\\\s*alias\\\\s+${escapeRegExp(aliasName)}=`);\n    let removed = false;\n\n    const newLines = lines.filter((line) => {\n      if (aliasPattern.test(line)) {\n        removed = true;\n        return false;\n      }\n      return true;\n    });\n\n    if (removed) {\n      writeFileSync(filePath, newLines.join(\"\\n\"));\n      return true;\n    }\n\n    return false;\n  } catch (error) {\n    throw new Error(`Failed to remove alias from ${configFile}: ${error}`);\n  }\n}\n\n/**\n * Validate alias name format\n * @param name - Alias name to validate\n * @returns Validation result with error message if invalid\n */\nexport function validateAliasName(name: string): ValidationResult {\n  if (!name || name.trim() === \"\") {\n    return { isValid: false, error: \"Alias name is required\" };\n  }\n  if (!/^[a-zA-Z_][a-zA-Z0-9_]*$/.test(name)) {\n    return {\n      isValid: false,\n      error: \"Alias name must start with a letter or underscore and contain only letters, numbers, and underscores\",\n    };\n  }\n  return { isValid: true };\n}\n\n/**\n * Validate alias command format\n * @param command - Alias command to validate\n * @returns Validation result with error message if invalid\n */\nexport function validateAliasCommand(command: string): ValidationResult {\n  if (!command || command.trim() === \"\") {\n    return { isValid: false, error: \"Alias command is required\" };\n  }\n  return { isValid: true };\n}\n\n/**\n * Search aliases by name or command\n * @param query - Search query\n * @param aliases - Array of aliases to search through\n * @returns Array of matching aliases\n */\nexport function searchAliases(query: string, aliases?: Alias[]): Alias[] {\n  const aliasesToSearch = aliases || parseAliases();\n  const lowerQuery = query.toLowerCase();\n\n  return aliasesToSearch.filter(\n    (alias) => alias.name.toLowerCase().includes(lowerQuery) || alias.command.toLowerCase().includes(lowerQuery),\n  );\n}\n"],
  "mappings": "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",
  "names": ["remove_alias_exports", "__export", "confirmation", "removeAliasCommand", "__toCommonJS", "import_fs", "import_os", "import_path", "escapeRegExp", "str", "parseAliases", "homeDir", "configFiles", "aliases", "aliasPattern", "configFile", "filePath", "lines", "line", "match", "error", "a", "b", "removeAlias", "aliasName", "configFile", "homeDir", "filePath", "lines", "aliasPattern", "escapeRegExp", "removed", "newLines", "line", "error", "confirmation", "input", "name", "configFile", "aliasToRemove", "parseAliases", "alias", "removeAliasCommand", "removeAlias", "error"]
}
