"use strict";var j=Object.create;var S=Object.defineProperty;var B=Object.getOwnPropertyDescriptor;var G=Object.getOwnPropertyNames;var K=Object.getPrototypeOf,H=Object.prototype.hasOwnProperty;var Z=(r,a)=>{for(var n in a)S(r,n,{get:a[n],enumerable:!0})},O=(r,a,n,o)=>{if(a&&typeof a=="object"||typeof a=="function")for(let s of G(a))!H.call(r,s)&&s!==n&&S(r,s,{get:()=>a[s],enumerable:!(o=B(a,s))||o.enumerable});return r};var A=(r,a,n)=>(n=r!=null?j(K(r)):{},O(a||!r||!r.__esModule?S(n,"default",{value:r,enumerable:!0}):n,r)),J=r=>O(S({},"__esModule",{value:!0}),r);var Y={};Z(Y,{default:()=>W});module.exports=J(Y);var e=require("@raycast/api");var $=A(require("react")),u=require("@raycast/api");var y=A(require("node:fs")),E=A(require("node:path"));var V=require("react/jsx-runtime");function x(r,a){let n=r instanceof Error?r.message:String(r);return(0,u.showToast)({style:u.Toast.Style.Failure,title:a?.title??"Something went wrong",message:a?.message??n,primaryAction:a?.primaryAction??N(r),secondaryAction:a?.primaryAction?N(r):void 0})}var N=r=>{let a=!0,n="[Extension Name]...",o="";try{let t=JSON.parse((0,y.readFileSync)((0,E.join)(u.environment.assetsPath,"..","package.json"),"utf8"));n=`[${t.title}]...`,o=`https://raycast.com/${t.owner||t.author}/${t.name}`,(!t.owner||t.access==="public")&&(a=!1)}catch{}let s=u.environment.isDevelopment||a,l=r instanceof Error?r?.stack||r?.message||"":String(r);return{title:s?"Copy Logs":"Report Error",onAction(t){t.hide(),s?u.Clipboard.copy(l):(0,u.open)(`https://github.com/raycast/extensions/issues/new?&labels=extension%2Cbug&template=extension_bug_report.yml&title=${encodeURIComponent(n)}&extension-url=${encodeURI(o)}&description=${encodeURIComponent(`#### Error:
\`\`\`
${l}
\`\`\`
`)}`)}}};var g=require("react");var f=require("fs"),w=require("os"),k=require("path");function C(r){return r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function L(){let r=(0,w.homedir)(),a=[".zshrc",".zsh_aliases",".aliases"],n=[],o=/^\s*alias\s+([^=]+)=(['"]?)(.+?)\2\s*$/;for(let s of a){let l=(0,k.join)(r,s);if((0,f.existsSync)(l))try{let d=(0,f.readFileSync)(l,"utf-8").split(`
`);for(let h of d){let c=h.match(o);c&&n.push({name:c[1].trim(),command:c[3].trim(),file:s})}}catch(t){console.error(`Error reading ${s}:`,t)}}return n.sort((s,l)=>s.name.localeCompare(l.name))}function D(){let r=(0,w.homedir)(),a=[".zshrc",".zsh_aliases",".aliases"],n=[];for(let o of a){let s=(0,k.join)(r,o);(0,f.existsSync)(s)&&n.push(o)}return n.length===0&&n.push(".zshrc"),n}function R(r,a,n){let o=(0,w.homedir)(),s=[".zshrc",".zsh_aliases",".aliases"];for(let l of s){let t=(0,k.join)(o,l);if((0,f.existsSync)(t))try{let d=(0,f.readFileSync)(t,"utf-8");if(new RegExp(`^\\s*alias\\s+${C(r)}=`,"m").test(d)){if(a===l&&n===r)continue;return!0}}catch(d){console.error(`Error reading ${l}:`,d)}}return!1}function F(r,a,n){let o=(0,w.homedir)(),s=(0,k.join)(o,n),l=a.replace(/'/g,"'\\''"),t=`alias ${r}='${l}'`;try{if((0,f.existsSync)(s)){let c=(0,f.readFileSync)(s,"utf-8").endsWith(`
`)?`${t}
`:`
${t}
`;(0,f.appendFileSync)(s,c)}else(0,f.writeFileSync)(s,`${t}
`)}catch(d){throw new Error(`Failed to write to ${n}: ${d}`)}}function z(r,a,n,o){let s=(0,w.homedir)(),l=(0,k.join)(s,o);if(!(0,f.existsSync)(l))throw new Error(`Configuration file ${o} not found`);try{let d=(0,f.readFileSync)(l,"utf-8").split(`
`),h=new RegExp(`^\\s*alias\\s+${C(r)}=(.*)$`),c=!1,p=d.map(m=>{if(m.match(h)){c=!0;let v=n.replace(/'/g,"'\\''");return`alias ${a}='${v}'`}return m});if(!c)throw new Error(`Alias '${r}' not found in ${o}`);(0,f.writeFileSync)(l,p.join(`
`))}catch(t){throw t instanceof Error&&t.message.includes("not found")?t:new Error(`Failed to update alias in ${o}: ${t}`)}}function M(r,a){let n=(0,w.homedir)(),o=(0,k.join)(n,a);if(!(0,f.existsSync)(o))throw new Error(`Configuration file ${a} not found`);try{let l=(0,f.readFileSync)(o,"utf-8").split(`
`),t=new RegExp(`^\\s*alias\\s+${C(r)}=`),d=!1,h=l.filter(c=>t.test(c)?(d=!0,!1):!0);return d?((0,f.writeFileSync)(o,h.join(`
`)),!0):!1}catch(s){throw new Error(`Failed to remove alias from ${a}: ${s}`)}}function P(r){return!r||r.trim()===""?{isValid:!1,error:"Alias name is required"}:/^[a-zA-Z_][a-zA-Z0-9_]*$/.test(r)?{isValid:!0}:{isValid:!1,error:"Alias name must start with a letter or underscore and contain only letters, numbers, and underscores"}}function T(r){return!r||r.trim()===""?{isValid:!1,error:"Alias command is required"}:{isValid:!0}}var i=require("react/jsx-runtime");function _({onRefresh:r}){let{pop:a}=(0,e.useNavigation)(),[n,o]=(0,g.useState)(),[s,l]=(0,g.useState)(),t=D();function d(c){let p=!0,m=P(c.aliasName);m.isValid?R(c.aliasName)?(o(`Alias '${c.aliasName}' already exists`),p=!1):o(void 0):(o(m.error),p=!1);let b=T(c.aliasCommand);return b.isValid?l(void 0):(l(b.error),p=!1),p}async function h(c){if(d(c))try{F(c.aliasName,c.aliasCommand,c.configFile),await(0,e.showToast)({style:e.Toast.Style.Success,title:"Alias added successfully",message:`'${c.aliasName}' added to ${c.configFile}`}),r(),a()}catch(p){await x(p instanceof Error?p.message:"Unknown error",{title:"Failed to add alias"})}}return(0,i.jsxs)(e.Form,{actions:(0,i.jsx)(e.ActionPanel,{children:(0,i.jsx)(e.Action.SubmitForm,{title:"Add Alias",onSubmit:h})}),children:[(0,i.jsx)(e.Form.TextField,{id:"aliasName",title:"Alias Name",placeholder:"e.g., ll",error:n,onChange:()=>o(void 0)}),(0,i.jsx)(e.Form.TextField,{id:"aliasCommand",title:"Alias Command",placeholder:"e.g., ls -la",error:s,onChange:()=>l(void 0)}),(0,i.jsx)(e.Form.Dropdown,{id:"configFile",title:"Configuration File",defaultValue:t[0]||"",children:t.map(c=>(0,i.jsx)(e.Form.Dropdown.Item,{value:c,title:c},c))}),(0,i.jsx)(e.Form.Description,{text:"The alias will be added to the selected configuration file. You may need to restart your terminal or run 'source ~/<config-file>' for the changes to take effect."})]})}function q({aliasName:r,aliasCommand:a,configFile:n,onRefresh:o}){let{pop:s}=(0,e.useNavigation)(),[l,t]=(0,g.useState)(),[d,h]=(0,g.useState)(),c=r;async function p(m){let b=!1,v=P(m.aliasName);v.isValid?m.aliasName!==c&&R(m.aliasName,n,c)?(t(`Alias '${m.aliasName}' already exists`),b=!0):t(void 0):(t(v.error),b=!0);let U=T(m.aliasCommand);if(U.isValid?h(void 0):(h(U.error),b=!0),!b)try{z(c,m.aliasName,m.aliasCommand,n),await(0,e.showToast)({style:e.Toast.Style.Success,title:"Alias updated successfully",message:m.aliasName!==c?`'${c}' renamed to '${m.aliasName}' in ${n}`:`'${m.aliasName}' updated in ${n}`}),o(),s()}catch(I){await x(I instanceof Error?I.message:"Unknown error",{title:"Failed to update alias"})}}return(0,i.jsxs)(e.Form,{actions:(0,i.jsx)(e.ActionPanel,{children:(0,i.jsx)(e.Action.SubmitForm,{title:"Update Alias",onSubmit:p})}),children:[(0,i.jsx)(e.Form.TextField,{id:"aliasName",title:"Alias Name",placeholder:"e.g., ll",defaultValue:r,error:l,onChange:()=>t(void 0)}),(0,i.jsx)(e.Form.TextField,{id:"aliasCommand",title:"Alias Command",placeholder:"e.g., ls -la",defaultValue:a,error:d,onChange:()=>h(void 0)}),(0,i.jsx)(e.Form.Description,{title:"Configuration File",text:n}),(0,i.jsx)(e.Form.Description,{text:"Note: You may need to restart your terminal or run 'source ~/<config-file>' for the changes to take effect."})]})}function W(){let[r,a]=(0,g.useState)([]),[n,o]=(0,g.useState)(!0);function s(){try{let t=L();a(t)}catch(t){x(t instanceof Error?t.message:"Unknown error",{title:"Failed to load aliases"})}finally{o(!1)}}(0,g.useEffect)(()=>{s()},[]);async function l(t){if(await(0,e.confirmAlert)({title:"Remove Alias",message:`Are you sure you want to remove the alias '${t.name}'?`,primaryAction:{title:"Remove",style:e.Alert.ActionStyle.Destructive}}))try{M(t.name,t.file)?(await(0,e.showToast)({style:e.Toast.Style.Success,title:"Alias removed successfully",message:`'${t.name}' removed from ${t.file}`}),s()):await x(`Alias '${t.name}' not found in ${t.file}`,{title:"Failed to remove alias"})}catch(h){await x(h instanceof Error?h.message:"Unknown error",{title:"Failed to remove alias"})}}return n?(0,i.jsx)(e.List,{isLoading:!0}):(0,i.jsx)(e.List,{searchBarPlaceholder:"Search aliases...",actions:(0,i.jsx)(e.ActionPanel,{children:(0,i.jsx)(e.Action.Push,{title:"Add New Alias",icon:e.Icon.Plus,target:(0,i.jsx)(_,{onRefresh:s})})}),children:r.length===0?(0,i.jsx)(e.List.EmptyView,{title:"No aliases found",description:"No zsh aliases found in your configuration files",actions:(0,i.jsx)(e.ActionPanel,{children:(0,i.jsx)(e.Action.Push,{title:"Add New Alias",icon:e.Icon.Plus,target:(0,i.jsx)(_,{onRefresh:s})})})}):r.map(t=>(0,i.jsx)(e.List.Item,{title:t.name,subtitle:t.command,accessories:[{text:t.file,icon:e.Icon.Document}],actions:(0,i.jsxs)(e.ActionPanel,{children:[(0,i.jsx)(e.Action.Push,{title:"Edit Alias",icon:e.Icon.Pencil,target:(0,i.jsx)(q,{aliasName:t.name,aliasCommand:t.command,configFile:t.file,onRefresh:s}),shortcut:e.Keyboard.Shortcut.Common.Edit}),(0,i.jsx)(e.Action,{title:"Remove Alias",icon:e.Icon.Trash,style:e.Action.Style.Destructive,onAction:()=>l(t),shortcut:e.Keyboard.Shortcut.Common.Remove}),(0,i.jsx)(e.Action.CopyToClipboard,{title:"Copy Alias Command",content:t.command,shortcut:e.Keyboard.Shortcut.Common.Copy}),(0,i.jsx)(e.Action.CopyToClipboard,{title:"Copy Alias Name",content:t.name,shortcut:{modifiers:["cmd","shift"],key:"c"}}),(0,i.jsx)(e.Action.Paste,{title:"Paste Alias Command",content:t.command,shortcut:{modifiers:["cmd"],key:"v"}}),(0,i.jsx)(e.Action.Push,{title:"Add New Alias",icon:e.Icon.Plus,target:(0,i.jsx)(_,{onRefresh:s}),shortcut:e.Keyboard.Shortcut.Common.New})]})},t.name))})}
