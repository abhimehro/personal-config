"use strict";var he=Object.create;var N=Object.defineProperty;var pe=Object.getOwnPropertyDescriptor;var me=Object.getOwnPropertyNames;var be=Object.getPrototypeOf,ge=Object.prototype.hasOwnProperty;var $e=(e,n)=>{for(var r in n)N(e,r,{get:n[r],enumerable:!0})},Z=(e,n,r,t)=>{if(n&&typeof n=="object"||typeof n=="function")for(let s of me(n))!ge.call(e,s)&&s!==r&&N(e,s,{get:()=>n[s],enumerable:!(t=pe(n,s))||t.enumerable});return e};var V=(e,n,r)=>(r=e!=null?he(be(e)):{},Z(n||!e||!e.__esModule?N(r,"default",{value:e,enumerable:!0}):r,e)),ye=e=>Z(N({},"__esModule",{value:!0}),e);var We={};$e(We,{default:()=>ue});module.exports=ye(We);var a=V(require("react")),f=require("@raycast/api");var Y=Object.prototype.hasOwnProperty;function j(e,n){var r,t;if(e===n)return!0;if(e&&n&&(r=e.constructor)===n.constructor){if(r===Date)return e.getTime()===n.getTime();if(r===RegExp)return e.toString()===n.toString();if(r===Array){if((t=e.length)===n.length)for(;t--&&j(e[t],n[t]););return t===-1}if(!r||typeof e=="object"){t=0;for(r in e)if(Y.call(e,r)&&++t&&!Y.call(n,r)||!(r in n)||!j(e[r],n[r]))return!1;return Object.keys(n).length===t}}return e!==e&&n!==n}var U=V(require("node:fs")),B=V(require("node:path")),ee=V(require("node:crypto"));var te=require("react/jsx-runtime");function we(e){let n=(0,a.useRef)(e),r=(0,a.useRef)(0);return j(e,n.current)||(n.current=e,r.current+=1),(0,a.useMemo)(()=>n.current,[r.current])}function w(e){let n=(0,a.useRef)(e);return n.current=e,n}function ke(e,n){let r=e instanceof Error?e.message:String(e);return(0,f.showToast)({style:f.Toast.Style.Failure,title:n?.title??"Something went wrong",message:n?.message??r,primaryAction:n?.primaryAction??q(e),secondaryAction:n?.primaryAction?q(e):void 0})}var q=e=>{let n=!0,r="[Extension Name]...",t="";try{let i=JSON.parse((0,U.readFileSync)((0,B.join)(f.environment.assetsPath,"..","package.json"),"utf8"));r=`[${i.title}]...`,t=`https://raycast.com/${i.owner||i.author}/${i.name}`,(!i.owner||i.access==="public")&&(n=!1)}catch{}let s=f.environment.isDevelopment||n,c=e instanceof Error?e?.stack||e?.message||"":String(e);return{title:s?"Copy Logs":"Report Error",onAction(i){i.hide(),s?f.Clipboard.copy(c):(0,f.open)(`https://github.com/raycast/extensions/issues/new?&labels=extension%2Cbug&template=extension_bug_report.yml&title=${encodeURIComponent(r)}&extension-url=${encodeURI(t)}&description=${encodeURIComponent(`#### Error:
\`\`\`
${c}
\`\`\`
`)}`)}}};function xe(e,n,r){let t=(0,a.useRef)(0),[s,c]=(0,a.useState)({isLoading:!0}),i=w(e),l=w(r?.abortable),o=w(n||[]),m=w(r?.onError),p=w(r?.onData),b=w(r?.onWillExecute),x=w(r?.failureToastOptions),v=w(s.data),y=(0,a.useRef)(null),d=(0,a.useRef)({page:0}),g=(0,a.useRef)(!1),S=(0,a.useRef)(!0),R=(0,a.useRef)(50),$=(0,a.useCallback)(()=>(l.current&&(l.current.current?.abort(),l.current.current=new AbortController),++t.current),[l]),h=(0,a.useCallback)((..._)=>{let k=$();b.current?.(_),c(u=>({...u,isLoading:!0}));let I=ve(i.current)(..._);function O(u){return u.name=="AbortError"||k===t.current&&(m.current?m.current(u):f.environment.launchType!==f.LaunchType.Background&&ke(u,{title:"Failed to fetch latest data",primaryAction:{title:"Retry",onAction(T){T.hide(),y.current?.(...o.current||[])}},...x.current}),c({error:u,isLoading:!1})),u}return typeof I=="function"?(g.current=!0,I(d.current).then(({data:u,hasMore:T,cursor:fe})=>(k===t.current&&(d.current&&(d.current.cursor=fe,d.current.lastItem=u?.[u.length-1]),p.current&&p.current(u,d.current),T&&(R.current=u.length),S.current=T,c(de=>d.current.page===0?{data:u,isLoading:!1}:{data:(de.data||[])?.concat(u),isLoading:!1})),u),u=>(S.current=!1,O(u)))):(g.current=!1,I.then(u=>(k===t.current&&(p.current&&p.current(u),c({data:u,isLoading:!1})),u),O))},[p,m,o,i,c,y,b,d,x,$]);y.current=h;let E=(0,a.useCallback)(()=>{d.current={page:0};let _=o.current||[];return h(..._)},[h,o]),A=(0,a.useCallback)(async(_,k)=>{let I;try{if(k?.optimisticUpdate){$(),typeof k?.rollbackOnError!="function"&&k?.rollbackOnError!==!1&&(I=structuredClone(v.current?.value));let O=k.optimisticUpdate;c(u=>({...u,data:O(u.data)}))}return await _}catch(O){if(typeof k?.rollbackOnError=="function"){let u=k.rollbackOnError;c(T=>({...T,data:u(T.data)}))}else k?.optimisticUpdate&&k?.rollbackOnError!==!1&&c(u=>({...u,data:I}));throw O}finally{k?.shouldRevalidateAfter!==!1&&(f.environment.launchType===f.LaunchType.Background||f.environment.commandMode==="menu-bar"?await E():E())}},[E,v,c,$]),P=(0,a.useCallback)(()=>{d.current.page+=1;let _=o.current||[];h(..._)},[d,o,h]);(0,a.useEffect)(()=>{d.current={page:0},r?.execute!==!1?h(...n||[]):$()},[we([n,r?.execute,h]),l,d]),(0,a.useEffect)(()=>()=>{$()},[$]);let L=r?.execute!==!1?s.isLoading:!1,M={...s,isLoading:L},z=g.current?{pageSize:R.current,hasMore:S.current,onLoadMore:P}:void 0;return{...M,revalidate:E,mutate:A,pagination:z}}function ve(e){return e===Promise.all||e===Promise.race||e===Promise.resolve||e===Promise.reject?e.bind(Promise):e}function X(e){return typeof e!="function"?!1:/^function\s+\w*\s*\(\s*\)\s*{\s+\[native code\]\s+}$/i.exec(Function.prototype.toString.call(e))!==null}function Se(e){return e instanceof URLSearchParams?e.toString():e}function re(e,n=[]){function r(t){return"update"in e?e.update(t,"utf8"):e.write(t)}return{dispatch:function(t){t=Se(t),t===null?this._null():this["_"+typeof t](t)},_object:function(t){let s=/\[object (.*)\]/i,c=Object.prototype.toString.call(t),i=s.exec(c)?.[1]??"unknown:["+c+"]";i=i.toLowerCase();let l=null;if((l=n.indexOf(t))>=0){this.dispatch("[CIRCULAR:"+l+"]");return}else n.push(t);if(Buffer.isBuffer(t))return r("buffer:"),r(t.toString("utf8"));if(i!=="object"&&i!=="function"&&i!=="asyncfunction")if(this["_"+i])this["_"+i](t);else throw new Error('Unknown object type "'+i+'"');else{let o=Object.keys(t);o=o.sort(),X(t)||o.splice(0,0,"prototype","__proto__","constructor"),r("object:"+o.length+":");let m=this;return o.forEach(function(p){m.dispatch(p),r(":"),m.dispatch(t[p]),r(",")})}},_array:function(t,s){s=typeof s<"u"?s:!1;let c=this;if(r("array:"+t.length+":"),!s||t.length<=1){t.forEach(function(o){c.dispatch(o)});return}let i=[],l=t.map(function(o){let m=Ee(),p=n.slice();return re(m,p).dispatch(o),i=i.concat(p.slice(n.length)),m.read().toString()});n=n.concat(i),l.sort(),this._array(l,!1)},_date:function(t){r("date:"+t.toJSON())},_symbol:function(t){r("symbol:"+t.toString())},_error:function(t){r("error:"+t.toString())},_boolean:function(t){r("bool:"+t.toString())},_string:function(t){r("string:"+t.length+":"),r(t.toString())},_function:function(t){r("fn:"),X(t)?this.dispatch("[native]"):this.dispatch(t.toString()),this.dispatch("function-name:"+String(t.name)),this._object(t)},_number:function(t){r("number:"+t.toString())},_xml:function(t){r("xml:"+t.toString())},_null:function(){r("Null")},_undefined:function(){r("Undefined")},_regexp:function(t){r("regex:"+t.toString())},_uint8array:function(t){r("uint8array:"),this.dispatch(Array.prototype.slice.call(t))},_uint8clampedarray:function(t){r("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(t))},_int8array:function(t){r("int8array:"),this.dispatch(Array.prototype.slice.call(t))},_uint16array:function(t){r("uint16array:"),this.dispatch(Array.prototype.slice.call(t))},_int16array:function(t){r("int16array:"),this.dispatch(Array.prototype.slice.call(t))},_uint32array:function(t){r("uint32array:"),this.dispatch(Array.prototype.slice.call(t))},_int32array:function(t){r("int32array:"),this.dispatch(Array.prototype.slice.call(t))},_float32array:function(t){r("float32array:"),this.dispatch(Array.prototype.slice.call(t))},_float64array:function(t){r("float64array:"),this.dispatch(Array.prototype.slice.call(t))},_arraybuffer:function(t){r("arraybuffer:"),this.dispatch(new Uint8Array(t))},_url:function(t){r("url:"+t.toString())},_map:function(t){r("map:");let s=Array.from(t);this._array(s,!0)},_set:function(t){r("set:");let s=Array.from(t);this._array(s,!0)},_file:function(t){r("file:"),this.dispatch([t.name,t.size,t.type,t.lastModified])},_blob:function(){throw Error(`Hashing Blob objects is currently not supported
(see https://github.com/puleos/object-hash/issues/26)
Use "options.replacer" or "options.ignoreUnknown"
`)},_domwindow:function(){r("domwindow")},_bigint:function(t){r("bigint:"+t.toString())},_process:function(){r("process")},_timer:function(){r("timer")},_pipe:function(){r("pipe")},_tcp:function(){r("tcp")},_udp:function(){r("udp")},_tty:function(){r("tty")},_statwatcher:function(){r("statwatcher")},_securecontext:function(){r("securecontext")},_connection:function(){r("connection")},_zlib:function(){r("zlib")},_context:function(){r("context")},_nodescript:function(){r("nodescript")},_httpparser:function(){r("httpparser")},_dataview:function(){r("dataview")},_signal:function(){r("signal")},_fsevent:function(){r("fsevent")},_tlswrap:function(){r("tlswrap")}}}function Ee(){return{buf:"",write:function(e){this.buf+=e},end:function(e){this.buf+=e},read:function(){return this.buf}}}function Ae(e,n){let r=this[e];return r instanceof Date?`__raycast_cached_date__${r.toISOString()}`:Buffer.isBuffer(r)?`__raycast_cached_buffer__${r.toString("base64")}`:n}function Re(e,n){return typeof n=="string"&&n.startsWith("__raycast_cached_date__")?new Date(n.replace("__raycast_cached_date__","")):typeof n=="string"&&n.startsWith("__raycast_cached_buffer__")?Buffer.from(n.replace("__raycast_cached_buffer__",""),"base64"):n}function F(e){let n=ee.default.createHash("sha1");return re(n).dispatch(e),n.digest("hex")}var Pe=Symbol("cache without namespace"),Q=new Map;function _e(e,n,r){let t=r?.cacheNamespace||Pe,s=Q.get(t)||Q.set(t,new f.Cache({namespace:r?.cacheNamespace})).get(t);if(!s)throw new Error("Missing cache");let c=w(e),i=w(n),l=(0,a.useSyncExternalStore)(s.subscribe,()=>{try{return s.get(c.current)}catch(b){console.error("Could not get Cache data:",b);return}}),o=(0,a.useMemo)(()=>{if(typeof l<"u"){if(l==="undefined")return;try{return JSON.parse(l,Re)}catch(b){return console.warn("The cached data is corrupted",b),i.current}}else return i.current},[l,i]),m=w(o),p=(0,a.useCallback)(b=>{let x=typeof b=="function"?b(m.current):b;if(typeof x>"u")s.set(c.current,"undefined");else{let v=JSON.stringify(x,Ae);s.set(c.current,v)}return x},[s,c,m]);return[o,p]}var D=Symbol();function Te(e,n,r){let{initialData:t,keepPreviousData:s,internal_cacheKeySuffix:c,...i}=r||{},l=(0,a.useRef)(null),[o,m]=_e(F(n||[])+c,D,{cacheNamespace:F(e)}),p=(0,a.useRef)(o!==D?o:t),b=(0,a.useRef)(void 0),{mutate:x,revalidate:v,...y}=xe(e,n||[],{...i,onData($,h){b.current=h,i.onData&&i.onData($,h),!(h&&h.page>0)&&(l.current="promise",p.current=$,m($))}}),d,g=y.pagination;b.current&&b.current.page>0&&y.data?d=y.data:l.current==="promise"?d=p.current:s&&o!==D?(d=o,g&&(g.hasMore=!0,g.pageSize=o.length)):s&&o===D?d=p.current:o!==D?(d=o,g&&(g.hasMore=!0,g.pageSize=o.length)):d=t;let S=w(d),R=(0,a.useCallback)(async($,h)=>{let E;try{if(h?.optimisticUpdate){typeof h?.rollbackOnError!="function"&&h?.rollbackOnError!==!1&&(E=structuredClone(S.current));let A=h.optimisticUpdate(S.current);l.current="cache",p.current=A,m(A)}return await x($,{shouldRevalidateAfter:h?.shouldRevalidateAfter})}catch(A){if(typeof h?.rollbackOnError=="function"){let P=h.rollbackOnError(S.current);l.current="cache",p.current=P,m(P)}else h?.optimisticUpdate&&h?.rollbackOnError!==!1&&(l.current="cache",p.current=E,m(E));throw A}},[m,x,S,p,l]);return(0,a.useEffect)(()=>{o!==D&&(l.current="cache",p.current=o)},[o]),{data:d,isLoading:y.isLoading,error:y.error,mutate:b.current&&b.current.page>0?x:R,pagination:g,revalidate:v}}function Ue(e){if(e){let n=Ie(e);if(!n)return!1;if(n.subtype==="json"||n.suffix==="json"||n.suffix&&/\bjson\b/i.test(n.suffix)||n.subtype&&/\bjson\b/i.test(n.subtype))return!0}return!1}var Ce=/^([A-Za-z0-9][A-Za-z0-9!#$&^_-]{0,126})\/([A-Za-z0-9][A-Za-z0-9!#$&^_.+-]{0,126});?$/;function Ie(e){let n=e.indexOf(";"),r=n!==-1?e.slice(0,n).trim():e.trim(),t=Ce.exec(r.toLowerCase().toLowerCase());if(!t)return;let s=t[1],c=t[2],i,l=c.lastIndexOf("+");return l!==-1&&(i=c.substring(l+1),c=c.substring(0,l)),{type:s,subtype:c,suffix:i}}async function Oe(e){if(!e.ok)throw new Error(e.statusText);let n=e.headers.get("content-type");return n&&Ue(n)?await e.json():await e.text()}function De(e){return{data:e,hasMore:!1}}function ne(e,n){let{parseResponse:r,mapResult:t,initialData:s,execute:c,keepPreviousData:i,onError:l,onData:o,onWillExecute:m,failureToastOptions:p,...b}=n||{},x={initialData:s,execute:c,keepPreviousData:i,onError:l,onData:o,onWillExecute:m,failureToastOptions:p},v=w(r||Oe),y=w(t||De),d=(0,a.useRef)(null),g=(0,a.useRef)(null),S=typeof e=="function"?e({page:0}):void 0;(!d.current||typeof g.current>"u"||g.current!==S)&&(d.current=e),g.current=S;let R=(0,a.useRef)(null),$=(0,a.useCallback)((A,P)=>async L=>{let M=await fetch(A(L),{signal:R.current?.signal,...P}),z=await v.current(M);return y.current?.(z)},[v,y]),h=(0,a.useCallback)(async(A,P)=>{let L=await fetch(A,{signal:R.current?.signal,...P}),M=await v.current(L);return y.current(M)?.data},[v,y]),E=(0,a.useMemo)(()=>g.current?$:h,[g,h,$]);return Te(E,[d.current,b],{...x,internal_cacheKeySuffix:g.current+F(y.current)+F(v.current),abortable:R})}var ae=require("@raycast/api"),Le=(0,ae.getPreferenceValues)(),se=Le.apiKey,Me="https://api.nasa.gov",G="https://ll.thespacedevs.com/2.2.0",ie={APOD:`${Me}/planetary/apod?api_key=APIKEY`,RSS:"https://www.nasa.gov/news-release/feed/",ASTRONAUTS:`${G}/astronaut/?in_space=true&limit=100`,SPACECRAFTS:`${G}/spacecraft/?in_space=true&limit=100`,LAUNCHES:`${G}/launch/upcoming/?limit=100`},oe={accept:"application/json"};var C=require("@raycast/api"),W=require("react/jsx-runtime");function K({apod:e,isLoading:n}){for(;n;)return(0,W.jsx)(C.Detail,{isLoading:n,markdown:"Loading Astronomy Picture of the Day \u{1F52D}"});let r=`
  # ${e.title}


  Date: ${e.date}


  ![${e.title}](${e.hdurl.toString()})


  ${e.explanation}


  Copyright: ${e.copyright}
  `;return(0,W.jsx)(C.Detail,{isLoading:n,markdown:r,actions:(0,W.jsx)(C.ActionPanel,{children:(0,W.jsx)(C.Action.OpenInBrowser,{url:"https://apod.nasa.gov/apod/astropix.html",title:"Read More"})})})}var ce=require("@raycast/api"),le=require("react/jsx-runtime");function H({error:e}){let n=`  
  # An error occurred
  ${e.message}
  `;return(0,le.jsx)(ce.Detail,{markdown:n})}var J=require("react/jsx-runtime");function ue(){let{isLoading:e,data:n,error:r}=ne(`${ie.APOD.replace("APIKEY",se)}`,{headers:oe,mapResult(t){return{data:t}},initialData:[]});return r?(0,J.jsx)(H,{error:r}):(0,J.jsx)(K,{isLoading:e,apod:n})}
