"use strict";var it=Object.create;var J=Object.defineProperty;var ot=Object.getOwnPropertyDescriptor;var ct=Object.getOwnPropertyNames;var lt=Object.getPrototypeOf,ut=Object.prototype.hasOwnProperty;var ft=(t,r)=>{for(var e in r)J(t,e,{get:r[e],enumerable:!0})},we=(t,r,e,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let a of ct(r))!ut.call(t,a)&&a!==e&&J(t,a,{get:()=>r[a],enumerable:!(n=ot(r,a))||n.enumerable});return t};var F=(t,r,e)=>(e=t!=null?it(lt(t)):{},we(r||!t||!t.__esModule?J(e,"default",{value:t,enumerable:!0}):e,t)),dt=t=>we(J({},"__esModule",{value:!0}),t);var It={};ft(It,{default:()=>at});module.exports=dt(It);var ie=require("react"),P=require("@raycast/api");var l=F(require("react")),b=require("@raycast/api");var ke=Object.prototype.hasOwnProperty;function Z(t,r){var e,n;if(t===r)return!0;if(t&&r&&(e=t.constructor)===r.constructor){if(e===Date)return t.getTime()===r.getTime();if(e===RegExp)return t.toString()===r.toString();if(e===Array){if((n=t.length)===r.length)for(;n--&&Z(t[n],r[n]););return n===-1}if(!e||typeof t=="object"){n=0;for(e in t)if(ke.call(t,e)&&++n&&!ke.call(r,e)||!(e in r)||!Z(t[e],r[e]))return!1;return Object.keys(r).length===n}}return t!==t&&r!==r}var V=F(require("node:fs")),Y=F(require("node:path")),Te=F(require("node:crypto")),_e=F(require("node:child_process")),Ue=require("node:buffer"),j=F(require("node:stream")),Ie=require("node:util");var Oe=require("react/jsx-runtime");var ue=globalThis;function ht(t){let r=(0,l.useRef)(t),e=(0,l.useRef)(0);return Z(t,r.current)||(r.current=t,e.current+=1),(0,l.useMemo)(()=>r.current,[e.current])}function S(t){let r=(0,l.useRef)(t);return r.current=t,r}function U(t,r){let e=t instanceof Error?t.message:String(t);return(0,b.showToast)({style:b.Toast.Style.Failure,title:r?.title??"Something went wrong",message:r?.message??e,primaryAction:r?.primaryAction??xe(t),secondaryAction:r?.primaryAction?xe(t):void 0})}var xe=t=>{let r=!0,e="[Extension Name]...",n="";try{let i=JSON.parse((0,V.readFileSync)((0,Y.join)(b.environment.assetsPath,"..","package.json"),"utf8"));e=`[${i.title}]...`,n=`https://raycast.com/${i.owner||i.author}/${i.name}`,(!i.owner||i.access==="public")&&(r=!1)}catch{}let a=b.environment.isDevelopment||r,o=t instanceof Error?t?.stack||t?.message||"":String(t);return{title:a?"Copy Logs":"Report Error",onAction(i){i.hide(),a?b.Clipboard.copy(o):(0,b.open)(`https://github.com/raycast/extensions/issues/new?&labels=extension%2Cbug&template=extension_bug_report.yml&title=${encodeURIComponent(e)}&extension-url=${encodeURI(n)}&description=${encodeURIComponent(`#### Error:
\`\`\`
${o}
\`\`\`
`)}`)}}};function De(t,r,e){let n=(0,l.useRef)(0),[a,o]=(0,l.useState)({isLoading:!0}),i=S(t),c=S(e?.abortable),s=S(r||[]),f=S(e?.onError),u=S(e?.onData),d=S(e?.onWillExecute),$=S(e?.failureToastOptions),x=S(a.data),v=(0,l.useRef)(null),y=(0,l.useRef)({page:0}),A=(0,l.useRef)(!1),w=(0,l.useRef)(!0),g=(0,l.useRef)(50),h=(0,l.useCallback)(()=>(c.current&&(c.current.current?.abort(),c.current.current=new AbortController),++n.current),[c]),p=(0,l.useCallback)((...T)=>{let C=h();d.current?.(T),o(m=>({...m,isLoading:!0}));let D=pt(i.current)(...T);function L(m){return m.name=="AbortError"||C===n.current&&(f.current?f.current(m):b.environment.launchType!==b.LaunchType.Background&&U(m,{title:"Failed to fetch latest data",primaryAction:{title:"Retry",onAction(_){_.hide(),v.current?.(...s.current||[])}},...$.current}),o({error:m,isLoading:!1})),m}return typeof D=="function"?(A.current=!0,D(y.current).then(({data:m,hasMore:_,cursor:ce})=>(C===n.current&&(y.current&&(y.current.cursor=ce,y.current.lastItem=m?.[m.length-1]),u.current&&u.current(m,y.current),_&&(g.current=m.length),w.current=_,o(le=>y.current.page===0?{data:m,isLoading:!1}:{data:(le.data||[])?.concat(m),isLoading:!1})),m),m=>(w.current=!1,L(m)))):(A.current=!1,D.then(m=>(C===n.current&&(u.current&&u.current(m),o({data:m,isLoading:!1})),m),L))},[u,f,s,i,o,v,d,y,$,h]);v.current=p;let k=(0,l.useCallback)(()=>{y.current={page:0};let T=s.current||[];return p(...T)},[p,s]),R=(0,l.useCallback)(async(T,C)=>{let D;try{if(C?.optimisticUpdate){h(),typeof C?.rollbackOnError!="function"&&C?.rollbackOnError!==!1&&(D=structuredClone(x.current?.value));let L=C.optimisticUpdate;o(m=>({...m,data:L(m.data)}))}return await T}catch(L){if(typeof C?.rollbackOnError=="function"){let m=C.rollbackOnError;o(_=>({..._,data:m(_.data)}))}else C?.optimisticUpdate&&C?.rollbackOnError!==!1&&o(m=>({...m,data:D}));throw L}finally{C?.shouldRevalidateAfter!==!1&&(b.environment.launchType===b.LaunchType.Background||b.environment.commandMode==="menu-bar"?await k():k())}},[k,x,o,h]),z=(0,l.useCallback)(()=>{y.current.page+=1;let T=s.current||[];p(...T)},[y,s,p]);(0,l.useEffect)(()=>{y.current={page:0},e?.execute!==!1?p(...r||[]):h()},[ht([r,e?.execute,p]),c,y]),(0,l.useEffect)(()=>()=>{h()},[h]);let O=e?.execute!==!1?a.isLoading:!1,K={...a,isLoading:O},oe=A.current?{pageSize:g.current,hasMore:w.current,onLoadMore:z}:void 0;return{...K,revalidate:k,mutate:R,pagination:oe}}function pt(t){return t===Promise.all||t===Promise.race||t===Promise.resolve||t===Promise.reject?t.bind(Promise):t}function ve(t){return typeof t!="function"?!1:/^function\s+\w*\s*\(\s*\)\s*{\s+\[native code\]\s+}$/i.exec(Function.prototype.toString.call(t))!==null}function mt(t){return t instanceof URLSearchParams?t.toString():t}function Le(t,r=[]){function e(n){return"update"in t?t.update(n,"utf8"):t.write(n)}return{dispatch:function(n){n=mt(n),n===null?this._null():this["_"+typeof n](n)},_object:function(n){let a=/\[object (.*)\]/i,o=Object.prototype.toString.call(n),i=a.exec(o)?.[1]??"unknown:["+o+"]";i=i.toLowerCase();let c=null;if((c=r.indexOf(n))>=0){this.dispatch("[CIRCULAR:"+c+"]");return}else r.push(n);if(Buffer.isBuffer(n))return e("buffer:"),e(n.toString("utf8"));if(i!=="object"&&i!=="function"&&i!=="asyncfunction")if(this["_"+i])this["_"+i](n);else throw new Error('Unknown object type "'+i+'"');else{let s=Object.keys(n);s=s.sort(),ve(n)||s.splice(0,0,"prototype","__proto__","constructor"),e("object:"+s.length+":");let f=this;return s.forEach(function(u){f.dispatch(u),e(":"),f.dispatch(n[u]),e(",")})}},_array:function(n,a){a=typeof a<"u"?a:!1;let o=this;if(e("array:"+n.length+":"),!a||n.length<=1){n.forEach(function(s){o.dispatch(s)});return}let i=[],c=n.map(function(s){let f=bt(),u=r.slice();return Le(f,u).dispatch(s),i=i.concat(u.slice(r.length)),f.read().toString()});r=r.concat(i),c.sort(),this._array(c,!1)},_date:function(n){e("date:"+n.toJSON())},_symbol:function(n){e("symbol:"+n.toString())},_error:function(n){e("error:"+n.toString())},_boolean:function(n){e("bool:"+n.toString())},_string:function(n){e("string:"+n.length+":"),e(n.toString())},_function:function(n){e("fn:"),ve(n)?this.dispatch("[native]"):this.dispatch(n.toString()),this.dispatch("function-name:"+String(n.name)),this._object(n)},_number:function(n){e("number:"+n.toString())},_xml:function(n){e("xml:"+n.toString())},_null:function(){e("Null")},_undefined:function(){e("Undefined")},_regexp:function(n){e("regex:"+n.toString())},_uint8array:function(n){e("uint8array:"),this.dispatch(Array.prototype.slice.call(n))},_uint8clampedarray:function(n){e("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(n))},_int8array:function(n){e("int8array:"),this.dispatch(Array.prototype.slice.call(n))},_uint16array:function(n){e("uint16array:"),this.dispatch(Array.prototype.slice.call(n))},_int16array:function(n){e("int16array:"),this.dispatch(Array.prototype.slice.call(n))},_uint32array:function(n){e("uint32array:"),this.dispatch(Array.prototype.slice.call(n))},_int32array:function(n){e("int32array:"),this.dispatch(Array.prototype.slice.call(n))},_float32array:function(n){e("float32array:"),this.dispatch(Array.prototype.slice.call(n))},_float64array:function(n){e("float64array:"),this.dispatch(Array.prototype.slice.call(n))},_arraybuffer:function(n){e("arraybuffer:"),this.dispatch(new Uint8Array(n))},_url:function(n){e("url:"+n.toString())},_map:function(n){e("map:");let a=Array.from(n);this._array(a,!0)},_set:function(n){e("set:");let a=Array.from(n);this._array(a,!0)},_file:function(n){e("file:"),this.dispatch([n.name,n.size,n.type,n.lastModified])},_blob:function(){throw Error(`Hashing Blob objects is currently not supported
(see https://github.com/puleos/object-hash/issues/26)
Use "options.replacer" or "options.ignoreUnknown"
`)},_domwindow:function(){e("domwindow")},_bigint:function(n){e("bigint:"+n.toString())},_process:function(){e("process")},_timer:function(){e("timer")},_pipe:function(){e("pipe")},_tcp:function(){e("tcp")},_udp:function(){e("udp")},_tty:function(){e("tty")},_statwatcher:function(){e("statwatcher")},_securecontext:function(){e("securecontext")},_connection:function(){e("connection")},_zlib:function(){e("zlib")},_context:function(){e("context")},_nodescript:function(){e("nodescript")},_httpparser:function(){e("httpparser")},_dataview:function(){e("dataview")},_signal:function(){e("signal")},_fsevent:function(){e("fsevent")},_tlswrap:function(){e("tlswrap")}}}function bt(){return{buf:"",write:function(t){this.buf+=t},end:function(t){this.buf+=t},read:function(){return this.buf}}}function Me(t,r){let e=this[t];return e instanceof Date?`__raycast_cached_date__${e.toString()}`:Buffer.isBuffer(e)?`__raycast_cached_buffer__${e.toString("base64")}`:r}function Ve(t,r){return typeof r=="string"&&r.startsWith("__raycast_cached_date__")?new Date(r.replace("__raycast_cached_date__","")):typeof r=="string"&&r.startsWith("__raycast_cached_buffer__")?Buffer.from(r.replace("__raycast_cached_buffer__",""),"base64"):r}function Se(t){let r=Te.default.createHash("sha1");return Le(r).dispatch(t),r.digest("hex")}var gt=Symbol("cache without namespace"),Re=new Map;function We(t,r,e){let n=e?.cacheNamespace||gt,a=Re.get(n)||Re.set(n,new b.Cache({namespace:e?.cacheNamespace})).get(n);if(!a)throw new Error("Missing cache");let o=S(t),i=S(r),c=(0,l.useSyncExternalStore)(a.subscribe,()=>{try{return a.get(o.current)}catch(d){console.error("Could not get Cache data:",d);return}}),s=(0,l.useMemo)(()=>{if(typeof c<"u"){if(c==="undefined")return;try{return JSON.parse(c,Ve)}catch(d){return console.warn("The cached data is corrupted",d),i.current}}else return i.current},[c,i]),f=S(s),u=(0,l.useCallback)(d=>{let $=typeof d=="function"?d(f.current):d;if(typeof $>"u")a.set(o.current,"undefined");else{let x=JSON.stringify($,Me);a.set(o.current,x)}return $},[a,o,f]);return[s,u]}var N=Symbol();function $t(t,r,e){let{initialData:n,keepPreviousData:a,internal_cacheKeySuffix:o,...i}=e||{},c=(0,l.useRef)(null),[s,f]=We(Se(r||[])+o,N,{cacheNamespace:Se(t)}),u=(0,l.useRef)(s!==N?s:n),d=(0,l.useRef)(void 0),{mutate:$,revalidate:x,...v}=De(t,r||[],{...i,onData(h,p){d.current=p,i.onData&&i.onData(h,p),!(p&&p.page>0)&&(c.current="promise",u.current=h,f(h))}}),y,A=v.pagination;d.current&&d.current.page>0&&v.data?y=v.data:c.current==="promise"?y=u.current:a&&s!==N?(y=s,A&&(A.hasMore=!0,A.pageSize=s.length)):a&&s===N?y=u.current:s!==N?(y=s,A&&(A.hasMore=!0,A.pageSize=s.length)):y=n;let w=S(y),g=(0,l.useCallback)(async(h,p)=>{let k;try{if(p?.optimisticUpdate){typeof p?.rollbackOnError!="function"&&p?.rollbackOnError!==!1&&(k=structuredClone(w.current));let R=p.optimisticUpdate(w.current);c.current="cache",u.current=R,f(R)}return await $(h,{shouldRevalidateAfter:p?.shouldRevalidateAfter})}catch(R){if(typeof p?.rollbackOnError=="function"){let z=p.rollbackOnError(w.current);c.current="cache",u.current=z,f(z)}else p?.optimisticUpdate&&p?.rollbackOnError!==!1&&(c.current="cache",u.current=k,f(k));throw R}},[f,$,w,u,c]);return(0,l.useEffect)(()=>{s!==N&&(c.current="cache",u.current=s)},[s]),{data:y,isLoading:v.isLoading,error:v.error,mutate:d.current&&d.current.page>0?$:g,pagination:A,revalidate:x}}var q=t=>!!t&&typeof t=="object"&&typeof t.removeListener=="function"&&typeof t.emit=="function"&&typeof t.reallyExit=="function"&&typeof t.listeners=="function"&&typeof t.kill=="function"&&typeof t.pid=="number"&&typeof t.on=="function",fe=Symbol.for("signal-exit emitter"),pe=class{constructor(){if(this.emitted={afterExit:!1,exit:!1},this.listeners={afterExit:[],exit:[]},this.count=0,this.id=Math.random(),ue[fe])return ue[fe];Object.defineProperty(ue,fe,{value:this,writable:!1,enumerable:!1,configurable:!1})}on(r,e){this.listeners[r].push(e)}removeListener(r,e){let n=this.listeners[r],a=n.indexOf(e);a!==-1&&(a===0&&n.length===1?n.length=0:n.splice(a,1))}emit(r,e,n){if(this.emitted[r])return!1;this.emitted[r]=!0;let a=!1;for(let o of this.listeners[r])a=o(e,n)===!0||a;return r==="exit"&&(a=this.emit("afterExit",e,n)||a),a}},me=class{onExit(){return()=>{}}load(){}unload(){}},be=class{#o;#t;#e;#s;#i;#a;#n;#r;constructor(r){this.#o=process.platform==="win32"?"SIGINT":"SIGHUP",this.#t=new pe,this.#a={},this.#n=!1,this.#r=[],this.#r.push("SIGHUP","SIGINT","SIGTERM"),globalThis.process.platform!=="win32"&&this.#r.push("SIGALRM","SIGABRT","SIGVTALRM","SIGXCPU","SIGXFSZ","SIGUSR2","SIGTRAP","SIGSYS","SIGQUIT","SIGIOT"),globalThis.process.platform==="linux"&&this.#r.push("SIGIO","SIGPOLL","SIGPWR","SIGSTKFLT"),this.#e=r,this.#a={};for(let e of this.#r)this.#a[e]=()=>{let n=this.#e.listeners(e),{count:a}=this.#t,o=r;if(typeof o.__signal_exit_emitter__=="object"&&typeof o.__signal_exit_emitter__.count=="number"&&(a+=o.__signal_exit_emitter__.count),n.length===a){this.unload();let i=this.#t.emit("exit",null,e),c=e==="SIGHUP"?this.#o:e;i||r.kill(r.pid,c)}};this.#i=r.reallyExit,this.#s=r.emit}onExit(r,e){if(!q(this.#e))return()=>{};this.#n===!1&&this.load();let n=e?.alwaysLast?"afterExit":"exit";return this.#t.on(n,r),()=>{this.#t.removeListener(n,r),this.#t.listeners.exit.length===0&&this.#t.listeners.afterExit.length===0&&this.unload()}}load(){if(!this.#n){this.#n=!0,this.#t.count+=1;for(let r of this.#r)try{let e=this.#a[r];e&&this.#e.on(r,e)}catch{}this.#e.emit=(r,...e)=>this.#l(r,...e),this.#e.reallyExit=r=>this.#c(r)}}unload(){this.#n&&(this.#n=!1,this.#r.forEach(r=>{let e=this.#a[r];if(!e)throw new Error("Listener not defined for signal: "+r);try{this.#e.removeListener(r,e)}catch{}}),this.#e.emit=this.#s,this.#e.reallyExit=this.#i,this.#t.count-=1)}#c(r){return q(this.#e)?(this.#e.exitCode=r||0,this.#t.emit("exit",this.#e.exitCode,null),this.#i.call(this.#e,this.#e.exitCode)):0}#l(r,...e){let n=this.#s;if(r==="exit"&&q(this.#e)){typeof e[0]=="number"&&(this.#e.exitCode=e[0]);let a=n.call(this.#e,r,...e);return this.#t.emit("exit",this.#e.exitCode,null),a}else return n.call(this.#e,r,...e)}},de=null,yt=(t,r)=>(de||(de=q(process)?new be(process):new me),de.onExit(t,r));function wt(t,{timeout:r}={}){let e=new Promise((c,s)=>{t.on("exit",(f,u)=>{c({exitCode:f,signal:u,timedOut:!1})}),t.on("error",f=>{s(f)}),t.stdin&&t.stdin.on("error",f=>{s(f)})}),n=yt(()=>{t.kill()});if(r===0||r===void 0)return e.finally(()=>n());let a,o=new Promise((c,s)=>{a=setTimeout(()=>{t.kill("SIGTERM"),s(Object.assign(new Error("Timed out"),{timedOut:!0,signal:"SIGTERM"}))},r)}),i=e.finally(()=>{clearTimeout(a)});return Promise.race([o,i]).finally(()=>n())}var ge=class extends Error{constructor(){super("The output is too big"),this.name="MaxBufferError"}};function kt(t){let{encoding:r}=t,e=r==="buffer",n=new j.default.PassThrough({objectMode:!1});r&&r!=="buffer"&&n.setEncoding(r);let a=0,o=[];return n.on("data",i=>{o.push(i),a+=i.length}),n.getBufferedValue=()=>e?Buffer.concat(o,a):o.join(""),n.getBufferedLength=()=>a,n}async function Ee(t,r){let e=kt(r);return await new Promise((n,a)=>{let o=i=>{i&&e.getBufferedLength()<=Ue.constants.MAX_LENGTH&&(i.bufferedData=e.getBufferedValue()),a(i)};(async()=>{try{await(0,Ie.promisify)(j.default.pipeline)(t,e),n()}catch(i){o(i)}})(),e.on("data",()=>{e.getBufferedLength()>8e7&&o(new ge)})}),e.getBufferedValue()}async function Ae(t,r){t.destroy();try{return await r}catch(e){return e.bufferedData}}async function xt({stdout:t,stderr:r},{encoding:e},n){let a=Ee(t,{encoding:e}),o=Ee(r,{encoding:e});try{return await Promise.all([n,a,o])}catch(i){return Promise.all([{error:i,exitCode:null,signal:i.signal,timedOut:i.timedOut||!1},Ae(t,a),Ae(r,o)])}}function vt(t){let r=typeof t=="string"?`
`:10,e=typeof t=="string"?"\r":13;return t[t.length-1]===r&&(t=t.slice(0,-1)),t[t.length-1]===e&&(t=t.slice(0,-1)),t}function Ce(t,r){return t.stripFinalNewline?vt(r):r}function St({timedOut:t,timeout:r,signal:e,exitCode:n}){return t?`timed out after ${r} milliseconds`:e!=null?`was killed with ${e}`:n!=null?`failed with exit code ${n}`:"failed"}function Rt({stdout:t,stderr:r,error:e,signal:n,exitCode:a,command:o,timedOut:i,options:c,parentError:s}){let u=`Command ${St({timedOut:i,timeout:c?.timeout,signal:n,exitCode:a})}: ${o}`,d=e?`${u}
${e.message}`:u,$=[d,r,t].filter(Boolean).join(`
`);return e?e.originalMessage=e.message:e=s,e.message=$,e.shortMessage=d,e.command=o,e.exitCode=a,e.signal=n,e.stdout=t,e.stderr=r,"bufferedData"in e&&delete e.bufferedData,e}function Et({stdout:t,stderr:r,error:e,exitCode:n,signal:a,timedOut:o,command:i,options:c,parentError:s}){if(e||n!==0||a!==null)throw Rt({error:e,exitCode:n,signal:a,stdout:t,stderr:r,command:i,timedOut:o,options:c,parentError:s});return t}var At=/ +/g;function Ct(t,r){if(r)return[t,...r];let e=[];for(let n of t.trim().split(At)){let a=e[e.length-1];a&&a.endsWith("\\")?e[e.length-1]=`${a.slice(0,-1)} ${n}`:e.push(n)}return e}function ze(t,r,e){let{parseOutput:n,input:a,onData:o,onWillExecute:i,initialData:c,execute:s,keepPreviousData:f,onError:u,failureToastOptions:d,...$}=Array.isArray(r)?e||{}:r||{},x={initialData:c,execute:s,keepPreviousData:f,onError:u,onData:o,onWillExecute:i,failureToastOptions:d},v=(0,l.useRef)(null),y=S(n||Et),A=(0,l.useCallback)(async(w,g,h,p)=>{let[k,...R]=Ct(w,g),z=[k,...R].join(" "),O={stripFinalNewline:!0,...h,timeout:h?.timeout||1e4,signal:v.current?.signal,encoding:h?.encoding===null?"buffer":h?.encoding||"utf8",env:{PATH:"/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin",...process.env,...h?.env}},K=_e.default.spawn(k,R,O),oe=wt(K,O);p&&K.stdin.end(p);let[{error:T,exitCode:C,signal:D,timedOut:L},m,_]=await xt(K,O,oe),ce=Ce(O,m),le=Ce(O,_);return y.current({stdout:ce,stderr:le,error:T,exitCode:C,signal:D,timedOut:L,command:z,options:O,parentError:new Error})},[y]);return $t(A,[t,Array.isArray(r)?r:[],$,a],{...x,abortable:v})}var Fe=(function(t){return t.Required="required",t})({});function he(t,r){if(t){if(typeof t=="function")return t(r);if(t==="required"){let e=typeof r<"u"&&r!==null;if(e)switch(typeof r){case"string":e=r.length>0;break;case"object":Array.isArray(r)?e=r.length>0:r instanceof Date&&(e=r.getTime()>0);break;default:break}if(!e)return"The item is required"}}}function Ne(t){let{onSubmit:r,validation:e,initialValues:n={}}=t,[a,o]=(0,l.useState)(n),[i,c]=(0,l.useState)({}),s=(0,l.useRef)({}),f=S(e||{}),u=S(r),d=(0,l.useCallback)(w=>{s.current[w]?.focus()},[s]),$=(0,l.useCallback)(async w=>{let g=!1;for(let[p,k]of Object.entries(f.current)){let R=he(k,w[p]);R&&(g||(g={},d(p)),g[p]=R)}if(g)return c(g),!1;let h=await u.current(w);return typeof h=="boolean"?h:!0},[f,u,d]),x=(0,l.useCallback)((w,g)=>{c(h=>({...h,[w]:g}))},[c]),v=(0,l.useCallback)(function(w,g){o(h=>({...h,[w]:typeof g=="function"?g(h[w]):g}))},[o]),y=(0,l.useMemo)(()=>new Proxy({},{get(w,g){let h=f.current[g],p=a[g];return{onChange(k){i[g]&&(he(h,k)||x(g,void 0)),v(g,k)},onBlur(k){let R=he(h,k.target.value);R&&x(g,R)},error:i[g],id:g,value:typeof p>"u"?null:p,ref:k=>{s.current[g]=k}}}}),[i,f,x,a,s,v]),A=(0,l.useCallback)(w=>{c({}),Object.entries(s.current).forEach(([g,h])=>{w?.[g]||h?.reset()}),w&&o(w)},[o,c,s]);return{handleSubmit:$,setValidationError:x,setValue:v,values:a,itemProps:y,focus:d,reset:A}}var Pt=10,Pe=864e5,Tt={Default:100,Embed:0,Bookmark:140};function _t(t){let r=Date.now(),e=t?t.lastVisited:0,n=t?t.frecency:0,a=(r-e)/Pe,o=Math.log(2)/(Pt*Pe),i=Tt.Default*Math.exp(-o*a),c=n+i;return{lastVisited:r,frecency:c}}var Ut=t=>{if(process.env.NODE_ENV!=="production"&&(typeof t!="object"||!t||!("id"in t)||typeof t.id!="string"))throw new Error("Specify a key function or make sure your items have an 'id' property");return t.id};function je(t,r){let e=S(r?.key||Ut),n=S(r?.sortUnvisited),[a,o]=We(`raycast_frecency_${r?.namespace}`,{}),i=(0,l.useCallback)(async function(u){let d=e.current(u);o($=>{let x=$[d],v=_t(x);return{...$,[d]:v}})},[e,o]),c=(0,l.useCallback)(async function(u){let d=e.current(u);o($=>{let x={...$};return delete x[d],x})},[e,o]);return{data:(0,l.useMemo)(()=>t?t.sort((f,u)=>{let d=a[e.current(f)],$=a[e.current(u)];return d&&!$?-1:!d&&$?1:d&&$?$.frecency-d.frecency:n.current?n.current(f,u):0}):[],[a,t,e,n]),visitItem:i,resetRanking:c}}function Be(t,r){let{data:e,isLoading:n,mutate:a}=De(async c=>{let s=await b.LocalStorage.getItem(c);return typeof s<"u"?JSON.parse(s,Ve):r},[t]);async function o(c){try{await a(b.LocalStorage.setItem(t,JSON.stringify(c,Me)),{optimisticUpdate(s){return s}})}catch(s){await U(s,{title:"Failed to set value in local storage"})}}async function i(){try{await a(b.LocalStorage.removeItem(t),{optimisticUpdate(){}})}catch(c){await U(c,{title:"Failed to remove value from local storage"})}}return{value:e,setValue:o,removeValue:i,isLoading:n}}function Ge(t,r){return t?t.split(`
`).reduce((e,n)=>{if(!n||n.endsWith("Operation not permitted"))return e;let a={id:n,label:n.replace(r+"/","")};return e.push(a),e},[]):[]}var $e=require("react"),Ke=(0,$e.createContext)("");function Q(){return Be("selectedRepo")}var se=require("@raycast/api"),H=require("react");var X=require("@raycast/api"),Je=require("react/jsx-runtime");function He({selectRepo:t}){return(0,Je.jsx)(X.Action,{title:"Update Repo",icon:X.Icon.Switch,onAction:t})}var re=require("@raycast/api");var E=require("@raycast/api");var ee=require("@raycast/api"),qe=require("react/jsx-runtime"),Ze=()=>(0,qe.jsx)(ee.Action,{title:"Open Preferences",onAction:ee.openExtensionPreferences});var te=require("@raycast/api");function B(){(0,te.launchCommand)({name:"quick-git",type:te.LaunchType.UserInitiated}).catch(t=>{U(t,{title:"Could not launch the Quick Git command"})})}var I=require("react/jsx-runtime");function Ye(){let t=Q(),{handleSubmit:r,itemProps:e}=Ne({onSubmit({newRepo:n}){t.setValue(n[0]).then(()=>{(0,E.showToast)({style:E.Toast.Style.Success,title:"Repo set",message:`${n[0]}`}),B()}).catch(a=>{U(a,{title:"Could not set this as your selected repo"})})},validation:{newRepo:Fe.Required}});return(0,I.jsxs)(E.Form,{navigationTitle:"Select Specific Git Repo",isLoading:t.isLoading,actions:(0,I.jsxs)(E.ActionPanel,{children:[(0,I.jsx)(E.Action.SubmitForm,{title:"Set Repo",onSubmit:r,icon:E.Icon.Checkmark}),(0,I.jsx)(E.Action.SubmitForm,{title:"Unset Repo",onSubmit:t.removeValue,icon:E.Icon.Xmark}),(0,I.jsx)(Ze,{})]}),children:[(0,I.jsx)(E.Form.Description,{text:"Manually select a repo from your computer, it can be outside of the 'Location of git projects' preference."}),(0,I.jsx)(E.Form.FilePicker,{id:"newRepo",title:"Repo Directory",canChooseDirectories:!0,storeValue:!0,allowMultipleSelection:!1,canChooseFiles:!1,defaultValue:t.value?[t.value]:void 0,autoFocus:!0,error:e.newRepo.error})]})}var ye=require("react/jsx-runtime");function ne(){return(0,ye.jsx)(re.Action.Push,{title:"Choose Specific Repo",icon:re.Icon.Folder,target:(0,ye.jsx)(Ye,{})})}var G=require("@raycast/api"),Xe=require("react/jsx-runtime");function Qe({path:t}){return(0,Xe.jsx)(G.Action.OpenWith,{icon:G.Icon.Finder,path:t,shortcut:G.Keyboard.Shortcut.Common.OpenWith})}var ae=require("@raycast/api");var tt=require("react/jsx-runtime");function et(){return(0,tt.jsx)(ae.Action,{title:"Check Status",icon:ae.Icon.CheckList,onAction:B})}var M=require("react/jsx-runtime");function rt({repoDir:t,isSelected:r,changeRepo:e}){let n=(0,H.useMemo)(()=>{if(r)return[{text:"Current Repo"}]},[r]),a=(0,H.useCallback)(()=>{e(t)},[e,t]),o=(0,H.useMemo)(()=>r?(0,M.jsx)(et,{}):(0,M.jsx)(He,{selectRepo:a}),[r,a]);return(0,M.jsx)(se.List.Item,{title:t.label,accessories:n,actions:(0,M.jsxs)(se.ActionPanel,{children:[o,(0,M.jsx)(Qe,{path:t.id}),(0,M.jsx)(ne,{})]})})}var W=require("react/jsx-runtime");function nt(){let t=Q(),r=(0,P.getPreferenceValues)()["repo-locations"],{data:e,isLoading:n}=ze("find",[r,"-name .git","-type d","-prune","-exec","dirname","{}","\\;"],{shell:!0,parseOutput:({stdout:s})=>Ge(s,r),onError:s=>{U(s,{title:"Could not get git repos"})},stripFinalNewline:!0}),{data:a,visitItem:o}=je(e),i=(0,ie.useCallback)(s=>{o(s),t.setValue(s.id).then(()=>{(0,P.showToast)({style:P.Toast.Style.Success,title:"Repo set",message:s.label}),B()})},[t,o]),c=(0,ie.useMemo)(()=>a?.length?a.map(s=>(0,W.jsx)(rt,{repoDir:s,isSelected:s.id===t.value,changeRepo:i},s.id)):(0,W.jsx)(P.List.EmptyView,{title:"There are no git repositories"}),[i,t.value,a]);return(0,W.jsx)(Ke,{value:t.value??"",children:(0,W.jsx)(P.List,{searchBarPlaceholder:"Search git repos\u2026",navigationTitle:"Change Git Repo",isLoading:n,actions:(0,W.jsx)(P.ActionPanel,{children:(0,W.jsx)(ne,{})}),children:c})})}var st=require("react/jsx-runtime");function at(){return(0,st.jsx)(nt,{})}
