"use strict";var S=Object.defineProperty;var A=Object.getOwnPropertyDescriptor;var x=Object.getOwnPropertyNames;var C=Object.prototype.hasOwnProperty;var $=(s,i)=>{for(var o in i)S(s,o,{get:i[o],enumerable:!0})},z=(s,i,o,r)=>{if(i&&typeof i=="object"||typeof i=="function")for(let c of x(i))!C.call(s,c)&&c!==o&&S(s,c,{get:()=>i[c],enumerable:!(r=A(i,c))||r.enumerable});return s};var N=s=>z(S({},"__esModule",{value:!0}),s);var P={};$(P,{default:()=>I});module.exports=N(P);var e=require("@raycast/api"),u=require("react"),t=require("react/jsx-runtime"),m=new e.Cache;function I(s){let i=parseFloat(s.arguments.price),o=parseFloat(s.arguments.quantity),r=s.arguments.unitSize?parseFloat(s.arguments.unitSize):void 0;if(isNaN(i)||isNaN(o)||i<=0||o<=0||r!==void 0&&(isNaN(r)||r<=0))return(0,e.showToast)({style:e.Toast.Style.Failure,title:"Invalid Input",message:"Please enter valid positive numbers for all fields."}),(0,t.jsx)(e.List,{});let c=i/o,p=r?i/o/r:void 0,[f,d]=(0,u.useState)([]);(0,u.useEffect)(()=>{let n=m.get("items"),a=n?JSON.parse(n):[];d(a)},[]);let y=n=>{d(a=>{let l=[n,...a].slice(0,5);return m.set("items",JSON.stringify(l)),l})},h=n=>{d(a=>{let l=a.filter((b,g)=>g!==n);return m.set("items",JSON.stringify(l)),l}),(0,e.showToast)({style:e.Toast.Style.Success,title:"Record Deleted",message:"The selected record has been removed."})};return(0,u.useEffect)(()=>{let n={price:i,quantity:o,unitSize:r,unitCost:c,perUnitSize:p,updateTime:new Date().toISOString()};y(n)},[]),(0,t.jsxs)(e.List,{navigationTitle:"Better Deal Calculator",searchBarPlaceholder:"Search Information...",children:[(0,t.jsxs)(e.List.Section,{title:"Current Input",children:[(0,t.jsx)(e.List.Item,{title:"Price",icon:e.Icon.BankNote,accessories:[{text:`$${i.toFixed(2)} x ${o}`}]}),(0,t.jsx)(e.List.Item,{title:"Unit Cost",icon:e.Icon.Receipt,accessories:[{text:`${c.toFixed(2)} per item`}]}),r!==void 0&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.List.Item,{title:"Unit Size",icon:e.Icon.Ruler,accessories:[{text:`${r}`}]}),(0,t.jsx)(e.List.Item,{title:"Cost per Unit Size",icon:e.Icon.Calculator,accessories:[{text:`${p?.toFixed(2)} per unit size`}]})]})]}),(0,t.jsx)(e.List.Section,{title:"Previous Records",children:f.map((n,a)=>(0,t.jsx)(e.List.Item,{title:`$${n.price.toFixed(2)} for ${n.quantity}`,subtitle:`${new Date(n.updateTime).toLocaleString()}`,accessories:[{text:`$${n.unitCost.toFixed(2)}/item`},...n.unitSize!==void 0?[{text:`${n.perUnitSize?.toFixed(2)}/unit size`}]:[]],actions:(0,t.jsxs)(e.ActionPanel,{children:[(0,t.jsx)(e.Action,{title:"Delete This Record",icon:e.Icon.Trash,onAction:()=>h(a),style:e.Action.Style.Destructive}),(0,t.jsx)(e.Action,{title:"Clear All Records",icon:e.Icon.Trash,onAction:async()=>{await(0,e.confirmAlert)({title:"Are you sure?",rememberUserChoice:!0})?(d([]),m.set("items",JSON.stringify([])),(0,e.showToast)({style:e.Toast.Style.Success,title:"All Records Cleared",message:"All records have been removed."})):console.log("canceled")}})]})},a))})]})}
