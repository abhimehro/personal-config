{
  "version": 3,
  "sources": ["../src/index.tsx"],
  "sourcesContent": ["import { LaunchProps, Cache, showToast, Toast, List, Icon, Action, ActionPanel, confirmAlert } from \"@raycast/api\";\nimport { useState, useEffect } from \"react\";\n\nconst cache = new Cache();\n\nexport type Item = {\n  price: number;\n  quantity: number;\n  unitSize?: number;\n  unitCost: number;\n  perUnitSize?: number;\n  updateTime: string;\n};\n\nexport default function Command(props: LaunchProps) {\n  const price = parseFloat(props.arguments.price);\n  const quantity = parseFloat(props.arguments.quantity);\n  const unitSize = props.arguments.unitSize ? parseFloat(props.arguments.unitSize) : undefined;\n\n  // Input validation\n  if (\n    isNaN(price) ||\n    isNaN(quantity) ||\n    price <= 0 ||\n    quantity <= 0 ||\n    (unitSize !== undefined && (isNaN(unitSize) || unitSize <= 0))\n  ) {\n    showToast({\n      style: Toast.Style.Failure,\n      title: \"Invalid Input\",\n      message: \"Please enter valid positive numbers for all fields.\",\n    });\n    return <List />;\n  }\n\n  const unitCost = price / quantity;\n  const perUnitSize = unitSize ? price / quantity / unitSize : undefined;\n\n  const [items, setItems] = useState<Item[]>([]);\n\n  useEffect(() => {\n    const cached = cache.get(\"items\");\n    const parsedItems: Item[] = cached ? JSON.parse(cached) : [];\n    setItems(parsedItems);\n  }, []);\n\n  const addNewItem = (newItem: Item) => {\n    setItems((prevItems) => {\n      const updatedItems = [newItem, ...prevItems].slice(0, 5); // Keep only the 5 most recent items\n      cache.set(\"items\", JSON.stringify(updatedItems));\n      return updatedItems;\n    });\n  };\n\n  const deleteItem = (index: number) => {\n    setItems((prevItems) => {\n      const updatedItems = prevItems.filter((_, i) => i !== index);\n      cache.set(\"items\", JSON.stringify(updatedItems));\n      return updatedItems;\n    });\n    showToast({\n      style: Toast.Style.Success,\n      title: \"Record Deleted\",\n      message: \"The selected record has been removed.\",\n    });\n  };\n\n  // Add the new item only once when the component mounts\n  useEffect(() => {\n    const newItem = { price, quantity, unitSize, unitCost, perUnitSize, updateTime: new Date().toISOString() };\n    addNewItem(newItem);\n  }, []); // Empty dependency array ensures this runs only once\n\n  return (\n    <List navigationTitle=\"Better Deal Calculator\" searchBarPlaceholder=\"Search Information...\">\n      <List.Section title=\"Current Input\">\n        <List.Item\n          title=\"Price\"\n          icon={Icon.BankNote}\n          accessories={[{ text: `$${price.toFixed(2)} x ${quantity}` }]}\n          // actions={\n          //   <ActionPanel>\n          //     <Action.Push title=\"Add Another Record\" icon={Icon.Plus} target={<List />} />\n          //   </ActionPanel>\n          // }\n        />\n        <List.Item title=\"Unit Cost\" icon={Icon.Receipt} accessories={[{ text: `${unitCost.toFixed(2)} per item` }]} />\n        {unitSize !== undefined && (\n          <>\n            <List.Item title=\"Unit Size\" icon={Icon.Ruler} accessories={[{ text: `${unitSize}` }]} />\n            <List.Item\n              title=\"Cost per Unit Size\"\n              icon={Icon.Calculator}\n              accessories={[{ text: `${perUnitSize?.toFixed(2)} per unit size` }]}\n            />\n          </>\n        )}\n      </List.Section>\n      <List.Section title=\"Previous Records\">\n        {items.map((item, index) => (\n          <List.Item\n            key={index}\n            title={`$${item.price.toFixed(2)} for ${item.quantity}`}\n            subtitle={`${new Date(item.updateTime).toLocaleString()}`}\n            accessories={[\n              { text: `$${item.unitCost.toFixed(2)}/item` },\n              ...(item.unitSize !== undefined ? [{ text: `${item.perUnitSize?.toFixed(2)}/unit size` }] : []),\n            ]}\n            actions={\n              <ActionPanel>\n                <Action\n                  title=\"Delete This Record\"\n                  icon={Icon.Trash}\n                  onAction={() => deleteItem(index)}\n                  style={Action.Style.Destructive}\n                />\n                <Action\n                  title=\"Clear All Records\"\n                  icon={Icon.Trash}\n                  onAction={async () => {\n                    if (await confirmAlert({ title: \"Are you sure?\", rememberUserChoice: true })) {\n                      setItems([]); // Clear the items state\n                      cache.set(\"items\", JSON.stringify([])); // Clear the cache\n                      showToast({\n                        style: Toast.Style.Success,\n                        title: \"All Records Cleared\",\n                        message: \"All records have been removed.\",\n                      });\n                    } else {\n                      console.log(\"canceled\"); // Log cancellation\n                    }\n                  }}\n                />\n              </ActionPanel>\n            }\n          />\n        ))}\n      </List.Section>\n    </List>\n  );\n}\n"],
  "mappings": "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",
  "names": ["src_exports", "__export", "Command", "__toCommonJS", "import_api", "import_react", "import_jsx_runtime", "cache", "props", "price", "quantity", "unitSize", "unitCost", "perUnitSize", "items", "setItems", "cached", "parsedItems", "addNewItem", "newItem", "prevItems", "updatedItems", "deleteItem", "index", "_", "i", "item"]
}
